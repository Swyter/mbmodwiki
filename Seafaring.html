<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
<meta charset="utf-8" />
<title>Seafaring - Mount&amp;Blade Modding Wiki</title>
<meta name="generator" content="MediaWiki 1.17.0" />
<link rel="alternate" type="application/x-wiki" title="Edit" href="index.php@title=Seafaring&amp;action=edit" />
<link rel="edit" title="Edit" href="index.php@title=Seafaring&amp;action=edit" />
<link rel="shortcut icon" href="favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="Mount&amp;Blade Modding Wiki (en)" />
<link rel="EditURI" type="application/rsd+xml" href="api.php@action=rsd" />
<link title="Creative Commons" type="application/rdf+xml" href="index.php@title=Seafaring&amp;action=creativecommons" rel="meta" />
<link rel="copyright" href="http://creativecommons.org/licenses/publicdomain/" />
<link rel="alternate" type="application/atom+xml" title="Mount&amp;Blade Modding Wiki Atom feed" href="index.php@title=Special%3ARecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="load.php@debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint,shared%257Cskins.vector&amp;only=styles&amp;skin=vector&amp;%252A.css" />
<meta name="ResourceLoaderDynamicStyles" content="" /><link rel="stylesheet" href="load.php@debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=vector&amp;%252A.css" />
<link rel="stylesheet" href="load.php@debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=vector&amp;%252A.css" />
<link rel="stylesheet" href="load.php@debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=vector&amp;%252A.css" />

<style type="text/css">/*<![CDATA[*/
.source-python {line-height: normal;}
.source-python li, .source-python pre {
	line-height: normal; border: 1px dashed #2f6fab;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for python
 * CSS class: source-python, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.python.source-python .de1, .python.source-python .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;}
.python.source-python  {font-family:monospace;}
.python.source-python .imp {font-weight: bold; color: red;}
.python.source-python li, .python.source-python .li1 {font-weight: normal; vertical-align:top;}
.python.source-python .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.python.source-python .li2 {font-weight: bold; vertical-align:top;}
.python.source-python .kw1 {color: #ff7700;font-weight:bold;}
.python.source-python .kw2 {color: #008000;}
.python.source-python .kw3 {color: #dc143c;}
.python.source-python .kw4 {color: #0000cd;}
.python.source-python .co1 {color: #808080; font-style: italic;}
.python.source-python .coMULTI {color: #808080; font-style: italic;}
.python.source-python .es0 {color: #000099; font-weight: bold;}
.python.source-python .br0 {color: black;}
.python.source-python .sy0 {color: #66cc66;}
.python.source-python .st0 {color: #483d8b;}
.python.source-python .nu0 {color: #ff4500;}
.python.source-python .me1 {color: black;}
.python.source-python .ln-xtra, .python.source-python li.ln-xtra, .python.source-python div.ln-xtra {background-color: #ffc;}
.python.source-python span.xtra { display:block; }

/*]]>*/
</style>
<style type="text/css">/*<![CDATA[*/
@import "index.php@title=MediaWiki%3AGeshi.css&usemsgcache=yes&action=raw&ctype=text%252Fcss&smaxage=18000.css";
/*]]>*/
</style><!--[if lt IE 7]><style type="text/css">body{behavior:url("/skins/vector/csshover.min.htc")}</style><![endif]--></head>
<body class="mediawiki ltr ns-0 ns-subject page-Seafaring skin-vector">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<!-- content -->
		<div id="content">
			<a id="top"></a>
			<div id="mw-js-message" style="display:none;"></div>
						<!-- firstHeading -->
			<h1 id="firstHeading" class="firstHeading">Seafaring</h1>
			<!-- /firstHeading -->
			<!-- bodyContent -->
			<div id="bodyContent">
				<!-- tagline -->
				<div id="siteSub">From Mount&amp;Blade Modding Wiki</div>
				<!-- /tagline -->
				<!-- subtitle -->
				<div id="contentSub"></div>
				<!-- /subtitle -->
																<!-- jumpto -->
				<div id="jump-to-nav">
					Jump to: <a href="Seafaring.html#mw-head">navigation</a>,
					<a href="Seafaring.html#p-search">search</a>
				</div>
				<!-- /jumpto -->
								<!-- bodytext -->
				<p><br />
<big><big>Disclaimer:</big></big>
Due to the amount of the code i cant be entirely sure whether everything needed was included, if you should have trouble implementing the entire package (i cant help with parts of it alone), please send me a pm or use the discussion feature in here. I might add a topic into the Forge as well, but for now this shall do. Thank you for understanding and possibly helping&#160;;)
</p>
<h2><span class="editsection">[<a href="index.php@title=Seafaring&amp;action=edit&amp;section=1" title="Edit section: Seafaring V.0.9">edit</a>]</span> <span class="mw-headline" id="Seafaring_V.0.9"> Seafaring V.0.9 </span></h2>
<p>The seafaring kit consists of 3 parts:<br />
</p>
<ul><li> Seatrade<br />
</li></ul>
<ul><li> Ruthvens Scenes and Battles<br />
</li></ul>
<ul><li> Seafaring (for the player)
</li></ul>
<p>This kit is meant to be used together. While Seatrade works as a standalone the other 2 will need quite a bit of tweaking by whoever wants to use them, if they are used outside of this kit. I developed this with the Floris Expanded Mod Pack, which is why certain troops may not appear in your game, if you arent using FEMP - you can easily tweak this yourself though. Another snippet of code will fuse PBOD and CC with this code (mainly by disabling them at sea), if you arent using PBOD or CC, you can ignore that part. Using this kit in your mod requires you to give credit where its due.<br />
</p><p><b>Features</b><br />
</p>
<ul><li> AI Sea Trade, slightly balanced
</li><li> Ruthvens Seabattle Scenes
</li><li> Spawning of Sea Raider ship parties
</li><li> Ability to buy, name, sail, land, fight on, dock and send a ship to town
</li><li> Ability to assign a crew on ship (requirement for sending a ship)
</li><li> Crew Wages integrated into the diplomacy report
</li><li> Hostile towns can not be chosen as a destination for your ships and troops
</li><li> New Port Submenu with several Submenus and a detailed Presentation
</li><li> Chance that a ship left at shore without guards is stolen
</li><li> Loot for Seabattles
</li><li> Consequences for a Defeat at sea (being dragged around and fleeing when close to land)
</li><li> Mini-Feature - Fishing based on Foraging Skill
</li><li> Pre-Battle Screens fused with PBOD and Custom Commander
</li><li> Update of the Camp Menu to assign the correct icons and exclude options like inspect your camp
</li><li> Height Check at Cliffs to exclude the landing and sending away option, cant be entirely excluded though (some Cliffs arent steep enough)
</li></ul>
<p><br />
<br />
</p><p><b><big>Seatrade</big></b><br />
</p><p>The original topic about Seatrade can be found in the forge (link: <a href="http://forums.taleworlds.com/index.php/topic,163671.0" class="external free" rel="nofollow">http://forums.taleworlds.com/index.php/topic,163671.0.html</a>). This version has a slightly updated spawn rate to improve the overall balance. In the Seafaring section, we also added these parties into the loot block of caravans as well as included them in the caravan dialogs. The Seatrade code spawns Royal Traders next to coastal towns, uses the Merchant AI and pathfinding for them and adds a bonus to city prosperity for trade conducted.
</p><p><br />
<b>Module party_templates:</b>
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1"><span class="co1">##Floris addon seatrade</span>
  <span class="br0">&#40;</span><span class="st0">&quot;sea_traders&quot;</span>,<span class="st0">&quot;Royal Traders&quot;</span>,icon_ship|pf_is_ship|carries_goods<span class="br0">&#40;</span><span class="nu0">50</span><span class="br0">&#41;</span>|pf_show_faction,<span class="nu0">0</span>,fac_commoners,merchant_personality,<span class="br0">&#91;</span><span class="br0">&#40;</span>trp_caravan_master,<span class="nu0">1</span>,<span class="nu0">1</span><span class="br0">&#41;</span>,<span class="br0">&#40;</span>trp_mercenary_enforcer,<span class="nu0">20</span>,<span class="nu0">30</span><span class="br0">&#41;</span>,<span class="br0">&#40;</span>trp_mercenary_crossbowman,<span class="nu0">5</span>,<span class="nu0">20</span><span class="br0">&#41;</span>,<span class="br0">&#40;</span>trp_mercenary_gendarme,<span class="nu0">5</span>,<span class="nu0">10</span><span class="br0">&#41;</span>,<span class="br0">&#40;</span>trp_mercenary_axeman,<span class="nu0">5</span>,<span class="nu0">10</span><span class="br0">&#41;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>,
<span class="co1">##Floris addon seatrade end</span></pre></div></div>
<p><b>Module Constants:</b>
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1"><span class="co1">#slot_party_type values</span>
<span class="co1">##spt_caravan            = 1</span>
spt_castle             = <span class="nu0">2</span>
spt_town               = <span class="nu0">3</span>
spt_village            = <span class="nu0">4</span>
<span class="co1">##spt_forager            = 5</span>
<span class="co1">##spt_war_party          = 6</span>
<span class="co1">##spt_patrol             = 7 #Activated in Diplomacy</span>
<span class="co1">##spt_messenger          = 8 #Activated in Diplomacy</span>
<span class="co1">##spt_raider             = 9</span>
<span class="co1">##spt_scout              = 10 #Activated in Diplomacy</span>
spt_kingdom_caravan    = <span class="nu0">11</span>
<span class="co1">##spt_prisoner_train     = 12 #Activated in Diplomacy  as dplmc_spt_recruiter</span>
spt_kingdom_hero_party = <span class="nu0">13</span>
spt_merchant_caravan     = <span class="nu0">14</span>     <span class="co1">#Seatrader</span>
spt_village_farmer     = <span class="nu0">15</span>
spt_ship               = <span class="nu0">16</span>
spt_cattle_herd        = <span class="nu0">17</span>
spt_bandit_lair       = <span class="nu0">18</span>
<span class="co1">#spt_deserter           = 20    #19 is dplmc_spouse</span>
spt_entrenchment      = <span class="nu0">22</span>      <span class="co1">#TEMPERED ADDED FOR ENTRENCHMENT PARTIES  #21 USED IN DIPLOMACY FOR &quot;Gift Caravan&quot;[/code]</span></pre></div></div>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1"><span class="co1">## Seatrade</span>
slot_town_is_coastal = slot_party_follow_me <span class="co1">#63  (any other new or unused slot can ofc be used as well)</span>
<span class="co1">##</span></pre></div></div>
<p><b>Module Triggers:</b>
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1"><span class="co1">#Kingdom Parties</span>
  <span class="br0">&#40;</span><span class="nu0">1.0</span>, <span class="nu0">0</span>, <span class="nu0">0.0</span>, <span class="br0">&#91;</span><span class="br0">&#93;</span>,
   <span class="br0">&#91;</span><span class="br0">&#40;</span>try_for_range, <span class="st0">&quot;:cur_kingdom&quot;</span>, kingdoms_begin, kingdoms_end<span class="br0">&#41;</span>,
      <span class="br0">&#40;</span>faction_slot_eq, <span class="st0">&quot;:cur_kingdom&quot;</span>, slot_faction_state, sfs_active<span class="br0">&#41;</span>,
<span class="co1">##      (neq, &quot;:cur_kingdom&quot;, &quot;fac_player_supporters_faction&quot;),</span>
<span class="co1">##      (try_begin),</span>
<span class="co1">##        (store_random_in_range, &quot;:random_no&quot;, 0, 100),</span>
<span class="co1">##        (lt, &quot;:random_no&quot;, 10),</span>
<span class="co1">##        (call_script, &quot;script_create_kingdom_party_if_below_limit&quot;, &quot;:cur_kingdom&quot;, spt_forager),</span>
<span class="co1">##      (try_end),</span>
<span class="co1">##      (try_begin),</span>
<span class="co1">##        (store_random_in_range, &quot;:random_no&quot;, 0, 100),</span>
<span class="co1">##        (lt, &quot;:random_no&quot;, 10),</span>
<span class="co1">##        (call_script, &quot;script_create_kingdom_party_if_below_limit&quot;, &quot;:cur_kingdom&quot;, spt_scout),</span>
<span class="co1">##      (try_end),</span>
<span class="co1">##      (try_begin),</span>
<span class="co1">##        (store_random_in_range, &quot;:random_no&quot;, 0, 100),</span>
<span class="co1">##        (lt, &quot;:random_no&quot;, 10),</span>
<span class="co1">##        (call_script, &quot;script_create_kingdom_party_if_below_limit&quot;, &quot;:cur_kingdom&quot;, spt_patrol),</span>
<span class="co1">##      (try_end),</span>
<span class="co1">##      (try_begin),</span>
<span class="co1">##        (store_random_in_range, &quot;:random_no&quot;, 0, 100),</span>
<span class="co1">##        (lt, &quot;:random_no&quot;, 10),</span>
<span class="co1">##        (call_script, &quot;script_create_kingdom_party_if_below_limit&quot;, &quot;:cur_kingdom&quot;, spt_messenger),</span>
<span class="co1">##      (try_end),</span>
      <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>store_random_in_range, <span class="st0">&quot;:random_no&quot;</span>, <span class="nu0">0</span>, <span class="nu0">100</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>lt, <span class="st0">&quot;:random_no&quot;</span>, <span class="nu0">10</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_create_kingdom_party_if_below_limit&quot;</span>, <span class="st0">&quot;:cur_kingdom&quot;</span>, spt_kingdom_caravan<span class="br0">&#41;</span>,
      <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
     <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,                        <span class="co1">#SEATRADE</span>
        <span class="br0">&#40;</span>store_random_in_range, <span class="st0">&quot;:random_no&quot;</span>, <span class="nu0">0</span>, <span class="nu0">100</span><span class="br0">&#41;</span>,       <span class="co1">#Disable these for faster testing</span>
        <span class="br0">&#40;</span>lt, <span class="st0">&quot;:random_no&quot;</span>, <span class="nu0">10</span><span class="br0">&#41;</span>,                              <span class="co1">#Disable these for faster testing </span>
        <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_create_kingdom_party_if_below_limit&quot;</span>, <span class="st0">&quot;:cur_kingdom&quot;</span>, spt_merchant_caravan<span class="br0">&#41;</span>,
      <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
<span class="co1">##      (try_begin),</span>
<span class="co1">##        (store_random_in_range, &quot;:random_no&quot;, 0, 100),</span>
<span class="co1">##        (lt, &quot;:random_no&quot;, 10),</span>
<span class="co1">##        (call_script, &quot;script_create_kingdom_party_if_below_limit&quot;, &quot;:cur_kingdom&quot;, spt_prisoner_train),</span>
<span class="co1">##      (try_end),</span>
    <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
    <span class="br0">&#93;</span><span class="br0">&#41;</span>,</pre></div></div>
<p><b>Module Scripts:</b>
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1">    <span class="co1"># script_create_kingdom_party_if_below_limit</span>
    <span class="co1"># Input: arg1 = faction_no, arg2 = party_type (variables beginning with spt_)</span>
    <span class="co1"># Output: reg0 = party_no</span>
    <span class="br0">&#40;</span><span class="st0">&quot;create_kingdom_party_if_below_limit&quot;</span>,
      <span class="br0">&#91;</span>
        <span class="br0">&#40;</span>store_script_param_1, <span class="st0">&quot;:faction_no&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>store_script_param_2, <span class="st0">&quot;:party_type&quot;</span><span class="br0">&#41;</span>,
&#160;
        <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_count_parties_of_faction_and_party_type&quot;</span>, <span class="st0">&quot;:faction_no&quot;</span>, <span class="st0">&quot;:party_type&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>assign, <span class="st0">&quot;:party_count&quot;</span>, reg0<span class="br0">&#41;</span>,
&#160;
        <span class="br0">&#40;</span>assign, <span class="st0">&quot;:party_count_limit&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
&#160;
        <span class="br0">&#40;</span>faction_get_slot, <span class="st0">&quot;:num_towns&quot;</span>, <span class="st0">&quot;:faction_no&quot;</span>, slot_faction_num_towns<span class="br0">&#41;</span>,
&#160;
        <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
          <span class="co1">##        (eq, &quot;:party_type&quot;, spt_forager),</span>
          <span class="co1">##        (assign, &quot;:party_count_limit&quot;, 1),</span>
          <span class="co1">##      (else_try),</span>
          <span class="co1">##        (eq, &quot;:party_type&quot;, spt_scout),</span>
          <span class="co1">##        (assign, &quot;:party_count_limit&quot;, 1),</span>
          <span class="co1">##      (else_try),</span>
          <span class="co1">##        (eq, &quot;:party_type&quot;, spt_patrol),</span>
          <span class="co1">##        (assign, &quot;:party_count_limit&quot;, 1),</span>
          <span class="co1">##      (else_try),</span>
          <span class="co1">##        (eq, &quot;:party_type&quot;, spt_messenger),</span>
          <span class="co1">##        (assign, &quot;:party_count_limit&quot;, 1),</span>
          <span class="co1">##      (else_try),</span>
          <span class="br0">&#40;</span>this_or_next|eq, <span class="st0">&quot;:party_type&quot;</span>, spt_merchant_caravan<span class="br0">&#41;</span>,    <span class="co1">#### This is our sea trader  ##THIS INSTEAD</span>
          <span class="br0">&#40;</span>eq, <span class="st0">&quot;:party_type&quot;</span>, spt_kingdom_caravan<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>eq, <span class="st0">&quot;:num_towns&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>assign, <span class="st0">&quot;:party_count_limit&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>eq, <span class="st0">&quot;:num_towns&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>assign, <span class="st0">&quot;:party_count_limit&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>eq, <span class="st0">&quot;:num_towns&quot;</span>, <span class="nu0">2</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>assign, <span class="st0">&quot;:party_count_limit&quot;</span>, <span class="nu0">3</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>assign, <span class="st0">&quot;:party_count_limit&quot;</span>, <span class="nu0">5</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
          <span class="co1">##      (else_try),</span>
          <span class="co1">##        (eq, &quot;:party_type&quot;, spt_prisoner_train),</span>
          <span class="co1">##        (assign, &quot;:party_count_limit&quot;, 1),</span>
        <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
&#160;
	<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>eq, <span class="st0">&quot;:party_type&quot;</span>, spt_merchant_caravan<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>eq, <span class="st0">&quot;:num_towns&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;:party_count_limit&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,	
			<span class="br0">&#40;</span>eq, <span class="st0">&quot;:num_towns&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>assign, <span class="st0">&quot;:party_count_limit&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>eq, <span class="st0">&quot;:num_towns&quot;</span>, <span class="nu0">2</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>assign, <span class="st0">&quot;:party_count_limit&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,	
            <span class="br0">&#40;</span>assign, <span class="st0">&quot;:party_count_limit&quot;</span>, <span class="nu0">2</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
&#160;
        <span class="br0">&#40;</span>assign, reg0, -<span class="nu0">1</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>lt, <span class="st0">&quot;:party_count&quot;</span>, <span class="st0">&quot;:party_count_limit&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>call_script,<span class="st0">&quot;script_cf_create_kingdom_party&quot;</span>, <span class="st0">&quot;:faction_no&quot;</span>, <span class="st0">&quot;:party_type&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
    <span class="br0">&#93;</span><span class="br0">&#41;</span>,</pre></div></div>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1">    <span class="co1"># script_cf_create_kingdom_party</span>
    <span class="co1"># Input: arg1 = faction_no, arg2 = party_type (variables beginning with spt_)</span>
    <span class="co1"># Output: reg0 = party_no</span>
    <span class="br0">&#40;</span><span class="st0">&quot;cf_create_kingdom_party&quot;</span>,
      <span class="br0">&#91;</span>
        <span class="br0">&#40;</span>store_script_param_1, <span class="st0">&quot;:faction_no&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>store_script_param_2, <span class="st0">&quot;:party_type&quot;</span><span class="br0">&#41;</span>,
&#160;
        <span class="br0">&#40;</span>str_store_faction_name, s7, <span class="st0">&quot;:faction_no&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>assign, <span class="st0">&quot;:party_name_str&quot;</span>, <span class="st0">&quot;str_no_string&quot;</span><span class="br0">&#41;</span>,
&#160;
        <span class="co1">##      (faction_get_slot, &quot;:reinforcements_a&quot;, &quot;:faction_no&quot;, slot_faction_reinforcements_a),</span>
        <span class="br0">&#40;</span>faction_get_slot, <span class="st0">&quot;:reinforcements_b&quot;</span>, <span class="st0">&quot;:faction_no&quot;</span>, slot_faction_reinforcements_b<span class="br0">&#41;</span>,
        <span class="co1">##      (faction_get_slot, &quot;:reinforcements_c&quot;, &quot;:faction_no&quot;, slot_faction_reinforcements_c),</span>
&#160;
        <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
          <span class="co1">##        (eq, &quot;:party_type&quot;, spt_forager),</span>
          <span class="co1">##        (assign, &quot;:party_template&quot;, &quot;pt_forager_party&quot;),</span>
          <span class="co1">#        (assign, &quot;:party_name_str&quot;, &quot;str_s7_foragers&quot;),</span>
          <span class="co1">##      (else_try),</span>
          <span class="co1">##        (eq, &quot;:party_type&quot;, spt_scout),</span>
          <span class="co1">##        (assign, &quot;:party_template&quot;, &quot;pt_scout_party&quot;),</span>
          <span class="co1">#        (assign, &quot;:party_name_str&quot;, &quot;str_s7_scouts&quot;),</span>
          <span class="co1">##      (else_try),</span>
          <span class="co1">##        (eq, &quot;:party_type&quot;, spt_patrol),</span>
          <span class="co1">##        (assign, &quot;:party_template&quot;, &quot;pt_patrol_party&quot;),</span>
          <span class="co1">#        (assign, &quot;:party_name_str&quot;, &quot;str_s7_patrol&quot;),</span>
          <span class="co1">##      (else_try),</span>
          <span class="br0">&#40;</span>eq, <span class="st0">&quot;:party_type&quot;</span>, spt_kingdom_caravan<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>assign, <span class="st0">&quot;:party_template&quot;</span>, <span class="st0">&quot;pt_kingdom_caravan_party&quot;</span><span class="br0">&#41;</span>,
          <span class="co1">#        (assign, &quot;:party_name_str&quot;, &quot;str_s7_caravan&quot;),</span>
        <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>eq, <span class="st0">&quot;:party_type&quot;</span>, spt_merchant_caravan<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>assign, <span class="st0">&quot;:party_template&quot;</span>, <span class="st0">&quot;pt_sea_traders&quot;</span><span class="br0">&#41;</span>,            <span class="co1">#####SEATRADE Marker#####</span>
          <span class="co1">##      (else_try),</span>
          <span class="co1">##        (eq, &quot;:party_type&quot;, spt_messenger),</span>
          <span class="co1">##        (assign, &quot;:party_template&quot;, &quot;pt_messenger_party&quot;),</span>
          <span class="co1">#        (assign, &quot;:party_name_str&quot;, &quot;str_s7_messenger&quot;),</span>
          <span class="co1">##      (else_try),</span>
          <span class="co1">##        (eq, &quot;:party_type&quot;, spt_raider),</span>
          <span class="co1">##        (assign, &quot;:party_template&quot;, &quot;pt_raider_party&quot;),</span>
          <span class="co1">##        (assign, &quot;:party_name_str&quot;, &quot;str_s7_raiders&quot;),</span>
          <span class="co1">##      (else_try),</span>
          <span class="co1">##        (eq, &quot;:party_type&quot;, spt_prisoner_train),</span>
          <span class="co1">##        (assign, &quot;:party_template&quot;, &quot;pt_prisoner_train_party&quot;),</span>
          <span class="co1">#        (assign, &quot;:party_name_str&quot;, &quot;str_s7_prisoner_train&quot;),</span>
        <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
&#160;
        <span class="br0">&#40;</span>assign, <span class="st0">&quot;:result&quot;</span>, -<span class="nu0">1</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>this_or_next|eq, <span class="st0">&quot;:party_type&quot;</span>, spt_merchant_caravan<span class="br0">&#41;</span>,   <span class="co1">##SEA TRADE</span>
            <span class="br0">&#40;</span>eq, <span class="st0">&quot;:party_type&quot;</span>, spt_kingdom_caravan<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>call_script,<span class="st0">&quot;script_cf_select_random_town_with_faction&quot;</span>, <span class="st0">&quot;:faction_no&quot;</span>, -<span class="nu0">1</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>set_spawn_radius, <span class="nu0">0</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>, <span class="co1">#not used at the moment</span>
            <span class="br0">&#40;</span>call_script,<span class="st0">&quot;script_cf_select_random_walled_center_with_faction&quot;</span>, <span class="st0">&quot;:faction_no&quot;</span>, -<span class="nu0">1</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>set_spawn_radius, <span class="nu0">1</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>assign, <span class="st0">&quot;:spawn_center&quot;</span>, reg0<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>is_between, <span class="st0">&quot;:spawn_center&quot;</span>, centers_begin, centers_end<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>assign, <span class="st0">&quot;:continue&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>, <span class="co1">## SEA TRADE</span>
        <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>eq, <span class="st0">&quot;:party_type&quot;</span>, spt_kingdom_caravan<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>spawn_around_party,<span class="st0">&quot;:spawn_center&quot;</span>,<span class="st0">&quot;:party_template&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>assign, <span class="st0">&quot;:result&quot;</span>, reg0<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>assign, <span class="st0">&quot;:continue&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,        
            <span class="br0">&#40;</span>eq, <span class="st0">&quot;:party_type&quot;</span>, spt_merchant_caravan<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>party_slot_ge, <span class="st0">&quot;:spawn_center&quot;</span>, slot_town_is_coastal, <span class="nu0">1</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:radius&quot;</span>, <span class="st0">&quot;:spawn_center&quot;</span>, slot_town_is_coastal<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>party_get_position, pos0 , <span class="st0">&quot;:spawn_center&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>map_get_water_position_around_position, pos1, pos0, <span class="st0">&quot;:radius&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>spawn_around_party,<span class="st0">&quot;:spawn_center&quot;</span>,<span class="st0">&quot;:party_template&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>assign, <span class="st0">&quot;:result&quot;</span>, reg0<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>party_set_position, <span class="st0">&quot;:result&quot;</span>, pos1<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>assign, <span class="st0">&quot;:continue&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,    
        <span class="br0">&#40;</span>eq, <span class="st0">&quot;:continue&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>, <span class="co1">## SEA TRADE END</span>
&#160;
          <span class="br0">&#40;</span>party_set_faction, <span class="st0">&quot;:result&quot;</span>, <span class="st0">&quot;:faction_no&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>this_or_next|eq, <span class="st0">&quot;:party_type&quot;</span>, spt_merchant_caravan<span class="br0">&#41;</span>, <span class="co1">##SEA TRADE</span>
            <span class="br0">&#40;</span>eq, <span class="st0">&quot;:party_type&quot;</span>, spt_kingdom_caravan<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:result&quot;</span>, slot_party_home_center, <span class="st0">&quot;:spawn_center&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:result&quot;</span>, slot_party_last_traded_center, <span class="st0">&quot;:spawn_center&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:result&quot;</span>, slot_party_type, <span class="st0">&quot;:party_type&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:result&quot;</span>, slot_party_ai_state, spai_undefined<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>neq, <span class="st0">&quot;:party_name_str&quot;</span>, <span class="st0">&quot;str_no_string&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>party_set_name, <span class="st0">&quot;:result&quot;</span>, <span class="st0">&quot;:party_name_str&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
&#160;
          <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
            <span class="co1">##          (eq, &quot;:party_type&quot;, spt_forager),</span>
            <span class="co1">##          (party_add_template, &quot;:result&quot;, &quot;:reinforcements_a&quot;),</span>
            <span class="co1">##        (else_try),</span>
            <span class="co1">##          (eq, &quot;:party_type&quot;, spt_scout),</span>
            <span class="co1">##          (party_add_template, &quot;:result&quot;, &quot;:reinforcements_c&quot;),</span>
            <span class="co1">##        (else_try),</span>
            <span class="co1">##          (eq, &quot;:party_type&quot;, spt_patrol),</span>
            <span class="co1">##          (party_add_template, &quot;:result&quot;, &quot;:reinforcements_a&quot;),</span>
            <span class="co1">##          (party_add_template, &quot;:result&quot;, &quot;:reinforcements_b&quot;),</span>
            <span class="co1">##        (else_try),</span>
            <span class="br0">&#40;</span>this_or_next|eq, <span class="st0">&quot;:party_type&quot;</span>, spt_merchant_caravan<span class="br0">&#41;</span>,   <span class="co1">##SEA TRADE</span>
            <span class="br0">&#40;</span>eq, <span class="st0">&quot;:party_type&quot;</span>, spt_kingdom_caravan<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
              <span class="br0">&#40;</span>eq, <span class="st0">&quot;:faction_no&quot;</span>, <span class="st0">&quot;fac_player_supporters_faction&quot;</span><span class="br0">&#41;</span>,
              <span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:reinforcement_faction&quot;</span>, <span class="st0">&quot;:spawn_center&quot;</span>, slot_center_original_faction<span class="br0">&#41;</span>,
              <span class="br0">&#40;</span>faction_get_slot, <span class="st0">&quot;:reinforcements_b&quot;</span>, <span class="st0">&quot;:reinforcement_faction&quot;</span>, slot_faction_reinforcements_b<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>party_add_template, <span class="st0">&quot;:result&quot;</span>, <span class="st0">&quot;:reinforcements_b&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>party_add_template, <span class="st0">&quot;:result&quot;</span>, <span class="st0">&quot;:reinforcements_b&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>party_set_ai_behavior,<span class="st0">&quot;:result&quot;</span>,ai_bhvr_travel_to_party<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>party_set_ai_object,<span class="st0">&quot;:result&quot;</span>,<span class="st0">&quot;:spawn_center&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>party_set_flags, <span class="st0">&quot;:result&quot;</span>, pf_default_behavior, <span class="nu0">1</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>store_sub, <span class="st0">&quot;:item_to_price_slot&quot;</span>, slot_town_trade_good_prices_begin, trade_goods_begin<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>try_for_range, <span class="st0">&quot;:cur_goods&quot;</span>, trade_goods_begin, trade_goods_end<span class="br0">&#41;</span>,
              <span class="br0">&#40;</span>store_add, <span class="st0">&quot;:cur_goods_price_slot&quot;</span>, <span class="st0">&quot;:cur_goods&quot;</span>, <span class="st0">&quot;:item_to_price_slot&quot;</span><span class="br0">&#41;</span>,
              <span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:result&quot;</span>, <span class="st0">&quot;:cur_goods_price_slot&quot;</span>, average_price_factor<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
	  <span class="br0">&#40;</span>party_set_bandit_attraction, <span class="st0">&quot;:result&quot;</span>, <span class="nu0">75</span><span class="br0">&#41;</span>, <span class="co1">##ADDED THIS LINE</span>
            <span class="co1">##        (else_try),</span>
            <span class="co1">##          (eq, &quot;:party_type&quot;, spt_messenger),</span>
            <span class="co1">##          (faction_get_slot, &quot;:messenger_troop&quot;, &quot;:faction_no&quot;, slot_faction_messenger_troop),</span>
            <span class="co1">##          (party_add_leader, &quot;:result&quot;, &quot;:messenger_troop&quot;),</span>
            <span class="co1">##          (party_set_ai_behavior,&quot;:result&quot;,ai_bhvr_travel_to_party),</span>
            <span class="co1">##          (party_set_ai_object,&quot;:result&quot;,&quot;:spawn_center&quot;),</span>
            <span class="co1">##          (party_set_flags, &quot;:result&quot;, pf_default_behavior, 0),</span>
            <span class="co1">##        (else_try),</span>
            <span class="co1">##          (eq, &quot;:party_type&quot;, spt_raider),</span>
            <span class="co1">##          (party_add_template, &quot;:result&quot;, &quot;:reinforcements_c&quot;),</span>
            <span class="co1">##          (party_add_template, &quot;:result&quot;, &quot;:reinforcements_b&quot;),</span>
            <span class="co1">##          (party_add_template, &quot;:result&quot;, &quot;pt_raider_captives&quot;),</span>
            <span class="co1">##        (else_try),</span>
            <span class="co1">##          (eq, &quot;:party_type&quot;, spt_prisoner_train),</span>
            <span class="co1">##          (party_add_template, &quot;:result&quot;, &quot;:reinforcements_b&quot;),</span>
            <span class="co1">##          (party_add_template, &quot;:result&quot;, &quot;:reinforcements_a&quot;),</span>
            <span class="co1">##          (try_begin),</span>
            <span class="co1">##            (call_script,&quot;script_cf_faction_get_random_enemy_faction&quot;,&quot;:faction_no&quot;),</span>
            <span class="co1">##            (store_random_in_range,&quot;:r&quot;,0,3),</span>
            <span class="co1">##            (try_begin),</span>
            <span class="co1">##              (lt, &quot;:r&quot;, 1),</span>
            <span class="co1">##              (faction_get_slot, &quot;:captive_reinforcements&quot;, reg0, slot_faction_reinforcements_b),</span>
            <span class="co1">##            (else_try),</span>
            <span class="co1">##              (faction_get_slot, &quot;:captive_reinforcements&quot;, reg0, slot_faction_reinforcements_a),</span>
            <span class="co1">##            (try_end),</span>
            <span class="co1">##            (party_add_template, &quot;:result&quot;, &quot;:captive_reinforcements&quot;,1),</span>
            <span class="co1">##          (else_try),</span>
            <span class="co1">##            (party_add_template, &quot;:result&quot;, &quot;pt_default_prisoners&quot;),</span>
            <span class="co1">##          (try_end),</span>
          <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>ge, <span class="st0">&quot;:result&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>assign, reg0, <span class="st0">&quot;:result&quot;</span><span class="br0">&#41;</span>,
    <span class="br0">&#93;</span><span class="br0">&#41;</span>,</pre></div></div>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1">      <span class="co1"># Towns:</span>
      <span class="br0">&#40;</span>try_for_range, <span class="st0">&quot;:item_no&quot;</span>, trade_goods_begin, trade_goods_end<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>store_sub, <span class="st0">&quot;:offset&quot;</span>, <span class="st0">&quot;:item_no&quot;</span>, trade_goods_begin<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>val_add, <span class="st0">&quot;:offset&quot;</span>, slot_town_trade_good_prices_begin<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>try_for_range, <span class="st0">&quot;:center_no&quot;</span>, centers_begin, centers_end<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:center_no&quot;</span>, <span class="st0">&quot;:offset&quot;</span>, average_price_factor<span class="br0">&#41;</span>, <span class="co1">#1000</span>
        <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
        <span class="co1">##        (party_set_slot, &quot;p_zendar&quot;, &quot;:offset&quot;, average_price_factor),</span>
        <span class="co1">##        (party_set_slot, &quot;p_salt_mine&quot;, &quot;:offset&quot;, average_price_factor),</span>
        <span class="co1">##        (party_set_slot, &quot;p_four_ways_inn&quot;, &quot;:offset&quot;, average_price_factor),</span>
      <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
&#160;
      <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_initialize_trade_routes&quot;</span><span class="br0">&#41;</span>,
      <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_initialize_sea_trade_routes&quot;</span><span class="br0">&#41;</span>, <span class="co1">###Seatrade Marker</span>
      <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_initialize_town_arena_info&quot;</span><span class="br0">&#41;</span>,
      <span class="co1">#start some tournaments</span>
      <span class="br0">&#40;</span>try_for_range, <span class="st0">&quot;:town_no&quot;</span>, towns_begin, towns_end<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>store_random_in_range, <span class="st0">&quot;:rand&quot;</span>, <span class="nu0">0</span>, <span class="nu0">100</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>lt, <span class="st0">&quot;:rand&quot;</span>, <span class="nu0">20</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>store_random_in_range, <span class="st0">&quot;:random_days&quot;</span>, <span class="nu0">12</span>, <span class="nu0">15</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:town_no&quot;</span>, slot_town_has_tournament, <span class="st0">&quot;:random_days&quot;</span><span class="br0">&#41;</span>,
      <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,</pre></div></div>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1">  <span class="br0">&#40;</span><span class="st0">&quot;initialize_sea_trade_routes&quot;</span>,
    <span class="br0">&#91;</span>
     <span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_town_1&quot;</span>, slot_town_is_coastal, <span class="nu0">4</span><span class="br0">&#41;</span>, <span class="co1">#Sargoth</span>
     <span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_town_2&quot;</span>, slot_town_is_coastal, <span class="nu0">2</span><span class="br0">&#41;</span>, <span class="co1">#Thir</span>
     <span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_town_6&quot;</span>, slot_town_is_coastal, <span class="nu0">3</span><span class="br0">&#41;</span>, <span class="co1">#Praven</span>
     <span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_town_12&quot;</span>, slot_town_is_coastal, <span class="nu0">3</span><span class="br0">&#41;</span>, <span class="co1">#Wercheg</span>
     <span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_town_13&quot;</span>, slot_town_is_coastal, <span class="nu0">5</span><span class="br0">&#41;</span>, <span class="co1">#Rivacheg</span>
     <span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_town_15&quot;</span>, slot_town_is_coastal, <span class="nu0">4</span><span class="br0">&#41;</span>, <span class="co1">#Yalen</span>
     <span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_town_19&quot;</span>, slot_town_is_coastal, <span class="nu0">8</span><span class="br0">&#41;</span>, <span class="co1">#Shariz</span>
      <span class="co1">#RIVACHEG - 2 Routes</span>
      <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_set_trade_route_between_centers&quot;</span>, <span class="st0">&quot;p_town_13&quot;</span>, <span class="st0">&quot;p_town_2&quot;</span><span class="br0">&#41;</span>, <span class="co1">#Rivacheg - Thir</span>
      <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_set_trade_route_between_centers&quot;</span>, <span class="st0">&quot;p_town_13&quot;</span>, <span class="st0">&quot;p_town_6&quot;</span><span class="br0">&#41;</span>, <span class="co1">#Rivacheg - Praven</span>
&#160;
      <span class="co1">#WERCHEG - 2 Routes</span>
      <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_set_trade_route_between_centers&quot;</span>, <span class="st0">&quot;p_town_12&quot;</span>, <span class="st0">&quot;p_town_2&quot;</span><span class="br0">&#41;</span>, <span class="co1">#Wercheg - Thir</span>
      <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_set_trade_route_between_centers&quot;</span>, <span class="st0">&quot;p_town_12&quot;</span>, <span class="st0">&quot;p_town_1&quot;</span><span class="br0">&#41;</span>, <span class="co1">#Wercheg - Sargoth</span>
&#160;
      <span class="co1">#SARGOTH - 2 routes</span>
      <span class="co1">#Wercheg</span>
      <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_set_trade_route_between_centers&quot;</span>, <span class="st0">&quot;p_town_1&quot;</span>, <span class="st0">&quot;p_town_2&quot;</span><span class="br0">&#41;</span>, <span class="co1">#Sargoth - Tihr</span>
&#160;
      <span class="co1">#TIHR - 4 Routes</span>
      <span class="co1">#Rivacheg, Wercheg, Sargoth</span>
      <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_set_trade_route_between_centers&quot;</span>, <span class="st0">&quot;p_town_2&quot;</span>, <span class="st0">&quot;p_town_6&quot;</span><span class="br0">&#41;</span>, <span class="co1">#Tihr - Praven</span>
&#160;
      <span class="co1">#Praven - 3 Routes</span>
      <span class="co1">#Rivacheg, Thir</span>
      <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_set_trade_route_between_centers&quot;</span>, <span class="st0">&quot;p_town_6&quot;</span>, <span class="st0">&quot;p_town_15&quot;</span><span class="br0">&#41;</span>, <span class="co1">#Praven - Yalen</span>
&#160;
      <span class="co1">#Yalen - 2 Routes</span>
      <span class="co1">#Praven</span>
      <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_set_trade_route_between_centers&quot;</span>, <span class="st0">&quot;p_town_15&quot;</span>, <span class="st0">&quot;p_town_19&quot;</span><span class="br0">&#41;</span>, <span class="co1">#Yalen - Shariz</span>
&#160;
      <span class="co1">#Shariz - 1 Route</span>
      <span class="co1">#Yalen</span>
  <span class="br0">&#93;</span><span class="br0">&#41;</span>,</pre></div></div>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1">    <span class="br0">&#40;</span><span class="st0">&quot;cf_select_most_profitable_coastal_town_at_peace_with_faction_in_trade_route&quot;</span>,
      <span class="br0">&#91;</span>
        <span class="br0">&#40;</span>store_script_param, <span class="st0">&quot;:town_no&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>store_script_param, <span class="st0">&quot;:faction_no&quot;</span>, <span class="nu0">2</span><span class="br0">&#41;</span>,
&#160;
        <span class="br0">&#40;</span>assign, <span class="st0">&quot;:result&quot;</span>, -<span class="nu0">1</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>assign, <span class="st0">&quot;:best_town_score&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>store_sub, <span class="st0">&quot;:item_to_price_slot&quot;</span>, slot_town_trade_good_prices_begin, trade_goods_begin<span class="br0">&#41;</span>,
&#160;
        <span class="br0">&#40;</span>try_for_range, <span class="st0">&quot;:cur_slot&quot;</span>, slot_town_trade_routes_begin, slot_town_trade_routes_end<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:cur_town&quot;</span>, <span class="st0">&quot;:town_no&quot;</span>, <span class="st0">&quot;:cur_slot&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>gt, <span class="st0">&quot;:cur_town&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>party_slot_ge, <span class="st0">&quot;:cur_town&quot;</span>, slot_town_is_coastal, <span class="nu0">1</span><span class="br0">&#41;</span>, <span class="co1">#Seatrade</span>
&#160;
          <span class="br0">&#40;</span>store_faction_of_party, <span class="st0">&quot;:cur_faction&quot;</span>, <span class="st0">&quot;:cur_town&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>store_relation, <span class="st0">&quot;:reln&quot;</span>, <span class="st0">&quot;:cur_faction&quot;</span>, <span class="st0">&quot;:faction_no&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>ge, <span class="st0">&quot;:reln&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
&#160;
          <span class="br0">&#40;</span>assign, <span class="st0">&quot;:cur_town_score&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_for_range, <span class="st0">&quot;:cur_goods&quot;</span>, trade_goods_begin, trade_goods_end<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>neq, <span class="st0">&quot;:cur_goods&quot;</span>, <span class="st0">&quot;itm_butter&quot;</span><span class="br0">&#41;</span>, <span class="co1">#Don't count perishables</span>
            <span class="br0">&#40;</span>neq, <span class="st0">&quot;:cur_goods&quot;</span>, <span class="st0">&quot;itm_cattle_meat&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>neq, <span class="st0">&quot;:cur_goods&quot;</span>, <span class="st0">&quot;itm_chicken&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>neq, <span class="st0">&quot;:cur_goods&quot;</span>, <span class="st0">&quot;itm_pork&quot;</span><span class="br0">&#41;</span>,
&#160;
            <span class="br0">&#40;</span>store_add, <span class="st0">&quot;:cur_goods_price_slot&quot;</span>, <span class="st0">&quot;:cur_goods&quot;</span>, <span class="st0">&quot;:item_to_price_slot&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:origin_price&quot;</span>, <span class="st0">&quot;:town_no&quot;</span>, <span class="st0">&quot;:cur_goods_price_slot&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:destination_price&quot;</span>, <span class="st0">&quot;:cur_town&quot;</span>, <span class="st0">&quot;:cur_goods_price_slot&quot;</span><span class="br0">&#41;</span>,
&#160;
            <span class="br0">&#40;</span>gt, <span class="st0">&quot;:destination_price&quot;</span>, <span class="st0">&quot;:origin_price&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>store_sub, <span class="st0">&quot;:price_dif&quot;</span>, <span class="st0">&quot;:destination_price&quot;</span>, <span class="st0">&quot;:origin_price&quot;</span><span class="br0">&#41;</span>,
&#160;
            <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>, <span class="co1">#weight luxury goods double</span>
              <span class="br0">&#40;</span>this_or_next|eq, <span class="st0">&quot;:cur_goods&quot;</span>, <span class="st0">&quot;itm_spice&quot;</span><span class="br0">&#41;</span>,
              <span class="br0">&#40;</span>eq, <span class="st0">&quot;:cur_goods&quot;</span>, <span class="st0">&quot;itm_velvet&quot;</span><span class="br0">&#41;</span>,
              <span class="br0">&#40;</span>val_mul, <span class="st0">&quot;:price_dif&quot;</span>, <span class="nu0">2</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>val_add, <span class="st0">&quot;:cur_town_score&quot;</span>, <span class="st0">&quot;:price_dif&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
&#160;
          <span class="co1">##        (try_begin),</span>
          <span class="co1">##            (eq, &quot;$cheat_mode&quot;, 1),</span>
          <span class="co1">##            (str_store_party_name, s10, &quot;:town_no&quot;),</span>
          <span class="co1">##            (str_store_party_name, s11, &quot;:cur_town&quot;),</span>
          <span class="co1">##            (assign, reg3, &quot;:cur_town_score&quot;),</span>
          <span class="co1">##            (display_message, &quot;str_caravan_in_s10_considers_s11_total_price_dif_=_reg3&quot;),</span>
          <span class="co1">##        (try_end),</span>
&#160;
          <span class="br0">&#40;</span>gt, <span class="st0">&quot;:cur_town_score&quot;</span>, <span class="st0">&quot;:best_town_score&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>assign, <span class="st0">&quot;:best_town_score&quot;</span>, <span class="st0">&quot;:cur_town_score&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>assign, <span class="st0">&quot;:result&quot;</span>, <span class="st0">&quot;:cur_town&quot;</span><span class="br0">&#41;</span>,
&#160;
        <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
&#160;
        <span class="br0">&#40;</span>gt, <span class="st0">&quot;:result&quot;</span>, -<span class="nu0">1</span><span class="br0">&#41;</span>, <span class="co1">#Fail if there are no towns</span>
&#160;
        <span class="br0">&#40;</span>assign, reg0, <span class="st0">&quot;:result&quot;</span><span class="br0">&#41;</span>,
&#160;
        <span class="co1">#      (store_current_hours, &quot;:hour&quot;),</span>
        <span class="co1">#      (party_set_slot, &quot;:result&quot;, slot_town_caravan_last_visit, &quot;:hour&quot;),</span>
&#160;
        <span class="co1"># (try_begin),</span>
        <span class="co1">###(eq, &quot;$cheat_mode&quot;, 1),</span>
        <span class="co1"># (assign, reg3, &quot;:best_town_score&quot;),</span>
        <span class="co1"># (str_store_party_name, s3, &quot;:town_no&quot;),</span>
        <span class="co1"># (str_store_party_name, s4, &quot;:result&quot;),</span>
        <span class="co1"># (display_message, &quot;str_test__caravan_in_s3_selects_for_s4_trade_score_reg3&quot;),</span>
        <span class="co1"># (try_end),</span>
&#160;
    <span class="br0">&#93;</span><span class="br0">&#41;</span>,</pre></div></div>
<p><b>Module simple_triggers:</b>
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1">  <span class="co1">#Troop AI: Merchants thinking</span>
  <span class="br0">&#40;</span><span class="nu0">8</span>,
   <span class="br0">&#91;</span>
       <span class="br0">&#40;</span>try_for_parties, <span class="st0">&quot;:party_no&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>party_slot_eq, <span class="st0">&quot;:party_no&quot;</span>, slot_party_type, spt_kingdom_caravan<span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>party_is_in_any_town, <span class="st0">&quot;:party_no&quot;</span><span class="br0">&#41;</span>,
&#160;
         <span class="br0">&#40;</span>store_faction_of_party, <span class="st0">&quot;:merchant_faction&quot;</span>, <span class="st0">&quot;:party_no&quot;</span><span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>faction_get_slot, <span class="st0">&quot;:num_towns&quot;</span>, <span class="st0">&quot;:merchant_faction&quot;</span>, slot_faction_num_towns<span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>le, <span class="st0">&quot;:num_towns&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>remove_party, <span class="st0">&quot;:party_no&quot;</span><span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>party_get_cur_town, <span class="st0">&quot;:cur_center&quot;</span>, <span class="st0">&quot;:party_no&quot;</span><span class="br0">&#41;</span>,
&#160;
           <span class="br0">&#40;</span>store_random_in_range, <span class="st0">&quot;:random_no&quot;</span>, <span class="nu0">0</span>, <span class="nu0">100</span><span class="br0">&#41;</span>,                               
&#160;
           <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>party_slot_eq, <span class="st0">&quot;:cur_center&quot;</span>, slot_town_lord, <span class="st0">&quot;trp_player&quot;</span><span class="br0">&#41;</span>,
&#160;
             <span class="br0">&#40;</span>game_get_reduce_campaign_ai, <span class="st0">&quot;:reduce_campaign_ai&quot;</span><span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
               <span class="br0">&#40;</span>eq, <span class="st0">&quot;:reduce_campaign_ai&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>, <span class="co1">#hard (less money from tariffs)</span>
               <span class="br0">&#40;</span>assign, <span class="st0">&quot;:tariff_succeed_limit&quot;</span>, <span class="nu0">35</span><span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
               <span class="br0">&#40;</span>eq, <span class="st0">&quot;:reduce_campaign_ai&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>, <span class="co1">#medium (normal money from tariffs)</span>
               <span class="br0">&#40;</span>assign, <span class="st0">&quot;:tariff_succeed_limit&quot;</span>, <span class="nu0">45</span><span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
               <span class="br0">&#40;</span>eq, <span class="st0">&quot;:reduce_campaign_ai&quot;</span>, <span class="nu0">2</span><span class="br0">&#41;</span>, <span class="co1">#easy (more money from tariffs)</span>
               <span class="br0">&#40;</span>assign, <span class="st0">&quot;:tariff_succeed_limit&quot;</span>, <span class="nu0">60</span><span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,               
           <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>assign, <span class="st0">&quot;:tariff_succeed_limit&quot;</span>, <span class="nu0">45</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
&#160;
           <span class="br0">&#40;</span>lt, <span class="st0">&quot;:random_no&quot;</span>, <span class="st0">&quot;:tariff_succeed_limit&quot;</span><span class="br0">&#41;</span>,                 
&#160;
           <span class="br0">&#40;</span>assign, <span class="st0">&quot;:can_leave&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>is_between, <span class="st0">&quot;:cur_center&quot;</span>, walled_centers_begin, walled_centers_end<span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>neg|party_slot_eq, <span class="st0">&quot;:cur_center&quot;</span>, slot_center_is_besieged_by, -<span class="nu0">1</span><span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>assign, <span class="st0">&quot;:can_leave&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>eq, <span class="st0">&quot;:can_leave&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
&#160;
           <span class="br0">&#40;</span>assign, <span class="st0">&quot;:do_trade&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:cur_ai_state&quot;</span>, <span class="st0">&quot;:party_no&quot;</span>, slot_party_ai_state<span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>eq, <span class="st0">&quot;:cur_ai_state&quot;</span>, spai_trading_with_town<span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:cur_ai_object&quot;</span>, <span class="st0">&quot;:party_no&quot;</span>, slot_party_ai_object<span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>eq, <span class="st0">&quot;:cur_center&quot;</span>, <span class="st0">&quot;:cur_ai_object&quot;</span><span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>assign, <span class="st0">&quot;:do_trade&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
&#160;
           <span class="br0">&#40;</span>assign, <span class="st0">&quot;:target_center&quot;</span>, -<span class="nu0">1</span><span class="br0">&#41;</span>,
&#160;
           <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>, <span class="co1">#Make sure escorted caravan continues to its original destination.</span>
             <span class="br0">&#40;</span>eq, <span class="st0">&quot;$caravan_escort_party_id&quot;</span>, <span class="st0">&quot;:party_no&quot;</span><span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>neg|party_is_in_town, <span class="st0">&quot;:party_no&quot;</span>, <span class="st0">&quot;$caravan_escort_destination_town&quot;</span><span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>assign, <span class="st0">&quot;:target_center&quot;</span>, <span class="st0">&quot;$caravan_escort_destination_town&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,         
             <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_cf_select_most_profitable_town_at_peace_with_faction_in_trade_route&quot;</span>, <span class="st0">&quot;:cur_center&quot;</span>, <span class="st0">&quot;:merchant_faction&quot;</span><span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>assign, <span class="st0">&quot;:target_center&quot;</span>, reg0<span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>is_between, <span class="st0">&quot;:target_center&quot;</span>, towns_begin, towns_end<span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>neg|party_is_in_town, <span class="st0">&quot;:party_no&quot;</span>, <span class="st0">&quot;:target_center&quot;</span><span class="br0">&#41;</span>,
&#160;
           <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>eq, <span class="st0">&quot;:do_trade&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>str_store_party_name, s7, <span class="st0">&quot;:cur_center&quot;</span><span class="br0">&#41;</span>,             
             <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_do_merchant_town_trade&quot;</span>, <span class="st0">&quot;:party_no&quot;</span>, <span class="st0">&quot;:cur_center&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>party_set_ai_behavior, <span class="st0">&quot;:party_no&quot;</span>, ai_bhvr_travel_to_party<span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>party_set_ai_object, <span class="st0">&quot;:party_no&quot;</span>, <span class="st0">&quot;:target_center&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>party_set_flags, <span class="st0">&quot;:party_no&quot;</span>, pf_default_behavior, <span class="nu0">0</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:party_no&quot;</span>, slot_party_ai_state, spai_trading_with_town<span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:party_no&quot;</span>, slot_party_ai_object, <span class="st0">&quot;:target_center&quot;</span><span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>, <span class="co1">## SEA TRADE</span>
         <span class="br0">&#40;</span>party_slot_eq, <span class="st0">&quot;:party_no&quot;</span>, slot_party_type, spt_merchant_caravan<span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>get_party_ai_object, <span class="st0">&quot;:object_town&quot;</span>, <span class="st0">&quot;:party_no&quot;</span><span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>party_slot_ge, <span class="st0">&quot;:object_town&quot;</span>, slot_town_is_coastal, <span class="nu0">1</span><span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>store_distance_to_party_from_party, <span class="st0">&quot;:dist&quot;</span>, <span class="st0">&quot;:party_no&quot;</span>, <span class="st0">&quot;:object_town&quot;</span><span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>party_get_position, pos0, <span class="st0">&quot;:object_town&quot;</span><span class="br0">&#41;</span>,     
         <span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:radius&quot;</span>, <span class="st0">&quot;:object_town&quot;</span>, slot_town_is_coastal<span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>val_add, <span class="st0">&quot;:radius&quot;</span>, <span class="nu0">3</span><span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>lt, <span class="st0">&quot;:dist&quot;</span>, <span class="st0">&quot;:radius&quot;</span><span class="br0">&#41;</span>,               
         <span class="br0">&#40;</span>assign, <span class="st0">&quot;:cur_center&quot;</span>, <span class="st0">&quot;:object_town&quot;</span><span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>store_faction_of_party, <span class="st0">&quot;:merchant_faction&quot;</span>, <span class="st0">&quot;:party_no&quot;</span><span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>faction_get_slot, <span class="st0">&quot;:num_towns&quot;</span>, <span class="st0">&quot;:merchant_faction&quot;</span>, slot_faction_num_towns<span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>le, <span class="st0">&quot;:num_towns&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>remove_party, <span class="st0">&quot;:party_no&quot;</span><span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,         
           <span class="br0">&#40;</span>store_random_in_range, <span class="st0">&quot;:random_no&quot;</span>, <span class="nu0">0</span>, <span class="nu0">100</span><span class="br0">&#41;</span>,                             
&#160;
           <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>party_slot_eq, <span class="st0">&quot;:cur_center&quot;</span>, slot_town_lord, <span class="st0">&quot;trp_player&quot;</span><span class="br0">&#41;</span>,
&#160;
             <span class="br0">&#40;</span>game_get_reduce_campaign_ai, <span class="st0">&quot;:reduce_campaign_ai&quot;</span><span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
               <span class="br0">&#40;</span>eq, <span class="st0">&quot;:reduce_campaign_ai&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>, <span class="co1">#hard (less money from tariffs)</span>
               <span class="br0">&#40;</span>assign, <span class="st0">&quot;:tariff_succeed_limit&quot;</span>, <span class="nu0">35</span><span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
               <span class="br0">&#40;</span>eq, <span class="st0">&quot;:reduce_campaign_ai&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>, <span class="co1">#medium (normal money from tariffs)</span>
               <span class="br0">&#40;</span>assign, <span class="st0">&quot;:tariff_succeed_limit&quot;</span>, <span class="nu0">45</span><span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
               <span class="br0">&#40;</span>eq, <span class="st0">&quot;:reduce_campaign_ai&quot;</span>, <span class="nu0">2</span><span class="br0">&#41;</span>, <span class="co1">#easy (more money from tariffs)</span>
               <span class="br0">&#40;</span>assign, <span class="st0">&quot;:tariff_succeed_limit&quot;</span>, <span class="nu0">60</span><span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,               
           <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>assign, <span class="st0">&quot;:tariff_succeed_limit&quot;</span>, <span class="nu0">45</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
&#160;
           <span class="br0">&#40;</span>lt, <span class="st0">&quot;:random_no&quot;</span>, <span class="st0">&quot;:tariff_succeed_limit&quot;</span><span class="br0">&#41;</span>,                 
&#160;
           <span class="br0">&#40;</span>assign, <span class="st0">&quot;:can_leave&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>is_between, <span class="st0">&quot;:cur_center&quot;</span>, walled_centers_begin, walled_centers_end<span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>neg|party_slot_eq, <span class="st0">&quot;:cur_center&quot;</span>, slot_center_is_besieged_by, -<span class="nu0">1</span><span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>assign, <span class="st0">&quot;:can_leave&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>eq, <span class="st0">&quot;:can_leave&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
&#160;
           <span class="br0">&#40;</span>assign, <span class="st0">&quot;:do_trade&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:cur_ai_state&quot;</span>, <span class="st0">&quot;:party_no&quot;</span>, slot_party_ai_state<span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>eq, <span class="st0">&quot;:cur_ai_state&quot;</span>, spai_trading_with_town<span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:cur_ai_object&quot;</span>, <span class="st0">&quot;:party_no&quot;</span>, slot_party_ai_object<span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>eq, <span class="st0">&quot;:cur_center&quot;</span>, <span class="st0">&quot;:cur_ai_object&quot;</span><span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>assign, <span class="st0">&quot;:do_trade&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
&#160;
           <span class="br0">&#40;</span>assign, <span class="st0">&quot;:target_center&quot;</span>, -<span class="nu0">1</span><span class="br0">&#41;</span>,
&#160;
           <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>, <span class="co1">#Make sure escorted caravan continues to its original destination.</span>
             <span class="co1">#(eq, &quot;$caravan_escort_party_id&quot;, &quot;:party_no&quot;),</span>
             <span class="co1">#(neg|party_is_in_town, &quot;:party_no&quot;, &quot;$caravan_escort_destination_town&quot;),</span>
             <span class="co1">#(assign, &quot;:target_center&quot;, &quot;$caravan_escort_destination_town&quot;),</span>
           <span class="co1">#(else_try),                                 #Calling altered script for seatrade</span>
             <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_cf_select_most_profitable_coastal_town_at_peace_with_faction_in_trade_route&quot;</span>, <span class="st0">&quot;:cur_center&quot;</span>, <span class="st0">&quot;:merchant_faction&quot;</span><span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>assign, <span class="st0">&quot;:target_center&quot;</span>, reg0<span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>is_between, <span class="st0">&quot;:target_center&quot;</span>, towns_begin, towns_end<span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>store_distance_to_party_from_party, <span class="st0">&quot;:target_dist&quot;</span>, <span class="st0">&quot;:party_no&quot;</span>, <span class="st0">&quot;:target_center&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>party_get_position, pos0, <span class="st0">&quot;:target_center&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:radius&quot;</span>, <span class="st0">&quot;:target_center&quot;</span>, slot_town_is_coastal<span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>map_get_water_position_around_position, pos1, pos0, <span class="st0">&quot;:radius&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>val_add, <span class="st0">&quot;:radius&quot;</span>, <span class="nu0">2</span><span class="br0">&#41;</span>,           
           <span class="br0">&#40;</span>gt, <span class="st0">&quot;:target_dist&quot;</span>, <span class="st0">&quot;:radius&quot;</span><span class="br0">&#41;</span>, <span class="co1">#was 5 #Ensures that they aren't already at the target party...just a redundancy check, as there is with caravans</span>
&#160;
           <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>eq, <span class="st0">&quot;:do_trade&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>str_store_party_name, s7, <span class="st0">&quot;:cur_center&quot;</span><span class="br0">&#41;</span>,           
             <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_do_merchant_town_trade&quot;</span>, <span class="st0">&quot;:party_no&quot;</span>, <span class="st0">&quot;:cur_center&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
&#160;
           <span class="br0">&#40;</span>party_set_ai_behavior, <span class="st0">&quot;:party_no&quot;</span>, ai_bhvr_travel_to_point<span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>party_set_ai_target_position, <span class="st0">&quot;:party_no&quot;</span>, pos1<span class="br0">&#41;</span>,
           <span class="co1"># (party_set_ai_behavior, &quot;:party_no&quot;, ai_bhvr_travel_to_party),</span>
           <span class="br0">&#40;</span>party_set_ai_object, <span class="st0">&quot;:party_no&quot;</span>, <span class="st0">&quot;:target_center&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>party_set_flags, <span class="st0">&quot;:party_no&quot;</span>, pf_default_behavior, <span class="nu0">0</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:party_no&quot;</span>, slot_party_ai_state, spai_trading_with_town<span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:party_no&quot;</span>, slot_party_ai_object, <span class="st0">&quot;:target_center&quot;</span><span class="br0">&#41;</span>, 
         <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,           
        <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>, <span class="co1">## Caravan vs Sea Trade</span>
       <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>, <span class="co1">#Party Loop</span>
    <span class="br0">&#93;</span><span class="br0">&#41;</span>,</pre></div></div>
<p><b>Credits go to</b><br />
</p>
<ul><li> Caba'drin - for lots of the code, fine tuning and bug fixing<br />
</li></ul>
<ul><li> Ruthven - for the sea battle code, that gave me the nudge to look into this<br />
</li></ul>
<ul><li> Duh - for digging through/researching all the caravan code, writing some code and the general concept<br />
</li></ul>
<p><br />
<br />
<b><big>Ruthvens Scenes and Battles</big></b><br />
The original topic can be found in the forge (link: <a href="http://forums.taleworlds.com/index.php/topic,136095.msg3275277.html#msg3275277" class="external free" rel="nofollow">http://forums.taleworlds.com/index.php/topic,136095.msg3275277.html#msg3275277</a>). In this kit however we only use parts of what is being listed in the topic and a few things have been updated to further integrate fighting into the game - therefore i will first copy-paste the necessary lines here and then display the updated code.<br />
</p><p>
Quote:<b><br /></b>
__________________________________________<br />
First of all, let's add the new scenes. Download this:
<a href="http://www.mbrepository.com/file.php?id=2258" class="external free" rel="nofollow">http://www.mbrepository.com/file.php?id=2258</a>
It includes the ship scenes, and the scenes for the island, the mountain pass, and Sarranid city. Right now, you only need to pay attention to the scenes named "sea_scene_X". Extract those three scenes (ignoring that they go 1, 2, then 4, as sea scene 3 was too lolzy to include) to your mod's SceneObj folder, and we'll just let those sit there for now.
</p><p>With that done, you can actually add those scenes into the game. So open up module_scenes, and at the bottom add:
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1"><span class="co1">#Wulf begin</span>
  <span class="br0">&#40;</span><span class="st0">&quot;sea_1&quot;</span>,sf_generate,<span class="st0">&quot;none&quot;</span>, <span class="st0">&quot;none&quot;</span>, <span class="br0">&#40;</span><span class="nu0">0</span>,<span class="nu0">0</span><span class="br0">&#41;</span>,<span class="br0">&#40;</span><span class="nu0">240</span>,<span class="nu0">240</span><span class="br0">&#41;</span>,-<span class="nu0">0.5</span>,<span class="st0">&quot;0x0000000030000000c00d2348000000008000000000000000&quot;</span>,
   <span class="br0">&#91;</span><span class="br0">&#93;</span>,<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>,
  <span class="br0">&#40;</span><span class="st0">&quot;sea_4&quot;</span>,sf_generate,<span class="st0">&quot;none&quot;</span>, <span class="st0">&quot;none&quot;</span>, <span class="br0">&#40;</span><span class="nu0">0</span>,<span class="nu0">0</span><span class="br0">&#41;</span>,<span class="br0">&#40;</span><span class="nu0">240</span>,<span class="nu0">240</span><span class="br0">&#41;</span>,-<span class="nu0">0.5</span>,<span class="st0">&quot;0x0000000030000000c00d2348000000008000000000000000&quot;</span>,
   <span class="br0">&#91;</span><span class="br0">&#93;</span>,<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>,
  <span class="br0">&#40;</span><span class="st0">&quot;sea_2&quot;</span>,sf_generate,<span class="st0">&quot;none&quot;</span>, <span class="st0">&quot;none&quot;</span>, <span class="br0">&#40;</span><span class="nu0">0</span>,<span class="nu0">0</span><span class="br0">&#41;</span>,<span class="br0">&#40;</span><span class="nu0">240</span>,<span class="nu0">240</span><span class="br0">&#41;</span>,-<span class="nu0">0.5</span>,<span class="st0">&quot;0x0000000030000000c00d2348000000008000000000000000&quot;</span>,
   <span class="br0">&#91;</span><span class="br0">&#93;</span>,<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>,
<span class="co1">#Wulf end</span></pre></div></div>
<p>[...] then open module_party_templates. Look for a small code called "sea_raider", and underneath it, put:
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1"><span class="co1">#wulf</span>
  <span class="br0">&#40;</span><span class="st0">&quot;sea_raiders_ships&quot;</span>,<span class="st0">&quot;Sea Raiders&quot;</span>,icon_ship|pf_is_ship|carries_goods<span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span>,<span class="nu0">0</span>,fac_outlaws,bandit_personality,<span class="br0">&#91;</span><span class="br0">&#40;</span>trp_sea_raider,<span class="nu0">50</span>,<span class="nu0">100</span><span class="br0">&#41;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>,
<span class="co1">#wulf end</span></pre></div></div>
<p>What this is is a party of Sea Raiders, but on a ship. You can change the number of troops and the type of troop by editing the last box in the tuple, the "trp_sea_raider,5,50". trp_sea_raider (obviously) means Sea Raider troops. The 5 is the minimum number of Sea Raiders in a party, and 50 is the maximum. Now we need somewhere for them to spawn from, so open up module_parties and look for "Bridge 14". Underneath it, paste this code:
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1"><span class="co1">#Wulf</span>
 <span class="br0">&#40;</span><span class="st0">&quot;ship_raider_spawn_point_1&quot;</span>   ,<span class="st0">&quot;the_ocean&quot;</span>,pf_disabled|pf_is_static, no_menu, pt_none, fac_outlaws,<span class="nu0">0</span>,ai_bhvr_hold,<span class="nu0">0</span>,<span class="br0">&#40;</span>-<span class="nu0">106.4</span>,<span class="nu0">126.4</span><span class="br0">&#41;</span>,<span class="br0">&#91;</span><span class="br0">&#40;</span>trp_looter,<span class="nu0">15</span>,<span class="nu0">0</span><span class="br0">&#41;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>,
<span class="co1">#Wulf</span></pre></div></div>
<p>Now [...] open module_scripts.
Search for "spawn_bandits", and scroll down just a bit and look for a code that looks like this:
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1">         <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>store_num_parties_of_template, <span class="st0">&quot;:num_parties&quot;</span>, <span class="st0">&quot;pt_mountain_bandits&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>lt,<span class="st0">&quot;:num_parties&quot;</span>,<span class="nu0">18</span><span class="br0">&#41;</span>, <span class="co1">#was 14 at mount&amp;blade, 18 in warband</span>
           <span class="br0">&#40;</span>store_random,<span class="st0">&quot;:spawn_point&quot;</span>,num_mountain_bandit_spawn_points<span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>val_add,<span class="st0">&quot;:spawn_point&quot;</span>,<span class="st0">&quot;p_mountain_bandit_spawn_point&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>set_spawn_radius, <span class="nu0">25</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>spawn_around_party,<span class="st0">&quot;:spawn_point&quot;</span>,<span class="st0">&quot;pt_mountain_bandits&quot;</span><span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,</pre></div></div>
<p>Now, just leave that one alone, but right underneath the (try_end), add this:
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1">     <span class="co1">#Wulf</span>
     <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
       <span class="br0">&#40;</span>store_num_parties_of_template, <span class="st0">&quot;:num_parties&quot;</span>, <span class="st0">&quot;pt_sea_raiders_ships&quot;</span><span class="br0">&#41;</span>,
       <span class="br0">&#40;</span>lt,<span class="st0">&quot;:num_parties&quot;</span>,<span class="nu0">25</span><span class="br0">&#41;</span>,
       <span class="br0">&#40;</span>store_random,<span class="st0">&quot;:spawn_point&quot;</span>,num_mountain_bandit_spawn_points<span class="br0">&#41;</span>,
       <span class="br0">&#40;</span>val_add,<span class="st0">&quot;:spawn_point&quot;</span>,<span class="st0">&quot;p_ship_raider_spawn_point_1&quot;</span><span class="br0">&#41;</span>,
       <span class="br0">&#40;</span>spawn_around_party,<span class="st0">&quot;:spawn_point&quot;</span>,<span class="st0">&quot;pt_sea_raiders_ships&quot;</span><span class="br0">&#41;</span>,
     <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
     <span class="co1">#Wulf end</span></pre></div></div>
<p>__________________________________________<br />
</p><p>This is largely it for Ruthvens Scenes and Seabattles (Credits obviously go to Ruthven), but the following code is useful and necessary for them as well. You can view it as both - <b><big>a part of Seafaring as well as an addition to Ruthvens Scenes.</big></b><br />
We will start with the <b>simple_encounter game menu.</b><br />
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1">  <span class="br0">&#40;</span>
    <span class="st0">&quot;simple_encounter&quot;</span>,mnf_enable_hot_keys|mnf_scale_picture,
    <span class="st0">&quot;{s2} You have {reg10} troops fit for battle against their {reg11}. {s4}^{s15}&quot;</span>, <span class="co1">## Floris adds {s4}.</span>
    <span class="st0">&quot;none&quot;</span>,
    <span class="br0">&#91;</span>
<span class="co1">#TEMPERED CHANGES BEGIN</span>
		<span class="br0">&#40;</span>str_clear,s15<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>str_store_string,s15,<span class="st0">&quot;@_&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_slot,<span class="st0">&quot;:party_entrenched&quot;</span>,<span class="st0">&quot;p_main_party&quot;</span>,slot_party_entrenched<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>this_or_next|ge,<span class="st0">&quot;:party_entrenched&quot;</span>,<span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_slot_eq,<span class="st0">&quot;p_main_party&quot;</span>,slot_party_siege_camp,<span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>str_store_string,s15,<span class="st0">&quot;str_entrench&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;$cant_leave_encounter&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
<span class="co1">#TEMPERED CHANGES END</span>
		<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_enemy_party&quot;</span>, <span class="st0">&quot;$g_encountered_party&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_ally_party&quot;</span>, -<span class="nu0">1</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_encounter_calculate_fit&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>eq, <span class="st0">&quot;$new_encounter&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>assign, <span class="st0">&quot;$new_encounter&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_encounter_is_in_village&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_encounter_type&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>party_slot_eq, <span class="st0">&quot;$g_enemy_party&quot;</span>, slot_party_ai_state, spai_raiding_around_center<span class="br0">&#41;</span>,        
            <span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:village_no&quot;</span>, <span class="st0">&quot;$g_enemy_party&quot;</span>, slot_party_ai_object<span class="br0">&#41;</span>,
&#160;
            <span class="br0">&#40;</span>store_distance_to_party_from_party, <span class="st0">&quot;:dist&quot;</span>, <span class="st0">&quot;:village_no&quot;</span>, <span class="st0">&quot;$g_enemy_party&quot;</span><span class="br0">&#41;</span>,
&#160;
            <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
              <span class="br0">&#40;</span>lt, <span class="st0">&quot;:dist&quot;</span>, raid_distance<span class="br0">&#41;</span>,
              <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_encounter_is_in_village&quot;</span>, <span class="st0">&quot;:village_no&quot;</span><span class="br0">&#41;</span>,
              <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_encounter_type&quot;</span>, enctype_fighting_against_village_raid<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>gt, <span class="st0">&quot;$g_player_raiding_village&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_encounter_is_in_village&quot;</span>, <span class="st0">&quot;$g_player_raiding_village&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_encounter_type&quot;</span>, enctype_catched_during_village_raid<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>party_quick_attach_to_current_battle, <span class="st0">&quot;$g_encounter_is_in_village&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>, <span class="co1">#attach as enemy</span>
            <span class="br0">&#40;</span>str_store_string, s1, <span class="st0">&quot;@Villagers&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>display_message, <span class="st0">&quot;str_s1_joined_battle_enemy&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>eq, <span class="st0">&quot;$g_encounter_type&quot;</span>, enctype_fighting_against_village_raid<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>party_quick_attach_to_current_battle, <span class="st0">&quot;$g_encounter_is_in_village&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>, <span class="co1">#attach as friend</span>
            <span class="br0">&#40;</span>str_store_string, s1, <span class="st0">&quot;@Villagers&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>display_message, <span class="st0">&quot;str_s1_joined_battle_friend&quot;</span><span class="br0">&#41;</span>,
            <span class="co1"># Let village party join battle at your side</span>
          <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
&#160;
          <span class="co1">## CC</span>
          <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>party_get_template_id, <span class="st0">&quot;:template_id&quot;</span>, <span class="st0">&quot;$g_enemy_party&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>neq, <span class="st0">&quot;:template_id&quot;</span>, <span class="st0">&quot;pt_routed_warriors&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_let_nearby_parties_join_current_battle&quot;</span>, <span class="nu0">0</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
          <span class="co1">## CC</span>
          <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_encounter_init_variables&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>assign, <span class="st0">&quot;$encountered_party_hostile&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>assign, <span class="st0">&quot;$encountered_party_friendly&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>gt, <span class="st0">&quot;$g_encountered_party_relation&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>assign, <span class="st0">&quot;$encountered_party_friendly&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
          <span class="co1">## CC</span>
          <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>party_get_template_id, <span class="st0">&quot;:template_id&quot;</span>, <span class="st0">&quot;$g_enemy_party&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>eq, <span class="st0">&quot;:template_id&quot;</span>, <span class="st0">&quot;pt_routed_warriors&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>assign, <span class="st0">&quot;$encountered_party_friendly&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
          <span class="co1">## CC</span>
          <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>lt, <span class="st0">&quot;$g_encountered_party_relation&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>assign, <span class="st0">&quot;$encountered_party_hostile&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
              <span class="br0">&#40;</span>encountered_party_is_attacker<span class="br0">&#41;</span>,
              <span class="br0">&#40;</span>assign, <span class="st0">&quot;$cant_leave_encounter&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>assign, <span class="st0">&quot;$talk_context&quot;</span>, tc_party_encounter<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_setup_party_meeting&quot;</span>, <span class="st0">&quot;$g_encountered_party&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>, <span class="co1">#second or more turn</span>
<span class="co1">#          (try_begin),</span>
<span class="co1">#            (call_script, &quot;script_encounter_calculate_morale_change&quot;),</span>
<span class="co1">#          (try_end),</span>
          <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
            <span class="co1"># We can leave battle only after some troops have been killed. </span>
            <span class="br0">&#40;</span>eq, <span class="st0">&quot;$cant_leave_encounter&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_current_terrain, <span class="st0">&quot;:terrain&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>, <span class="co1">#No fleeing at sea / Seafaring</span>
			<span class="br0">&#40;</span>neq, <span class="st0">&quot;:terrain&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>, 
            <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_party_count_members_with_full_health&quot;</span>, <span class="st0">&quot;p_main_party_backup&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>assign, <span class="st0">&quot;:org_total_party_counts&quot;</span>, reg0<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_party_count_members_with_full_health&quot;</span>, <span class="st0">&quot;p_encountered_party_backup&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>val_add, <span class="st0">&quot;:org_total_party_counts&quot;</span>, reg0<span class="br0">&#41;</span>,
&#160;
            <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_party_count_members_with_full_health&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>assign, <span class="st0">&quot;:cur_total_party_counts&quot;</span>, reg0<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_party_count_members_with_full_health&quot;</span>, <span class="st0">&quot;p_collective_enemy&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>val_add, <span class="st0">&quot;:cur_total_party_counts&quot;</span>, reg0<span class="br0">&#41;</span>,
&#160;
            <span class="br0">&#40;</span>store_sub, <span class="st0">&quot;:leave_encounter_limit&quot;</span>, <span class="st0">&quot;:org_total_party_counts&quot;</span>, <span class="nu0">10</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>lt, <span class="st0">&quot;:cur_total_party_counts&quot;</span>, <span class="st0">&quot;:leave_encounter_limit&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>assign, <span class="st0">&quot;$cant_leave_encounter&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>eq, <span class="st0">&quot;$g_leave_encounter&quot;</span>,<span class="nu0">1</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>change_screen_return<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
&#160;
        <span class="co1">#setup s2</span>
        <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>party_is_active, <span class="st0">&quot;$g_encountered_party&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>str_store_party_name, s1,<span class="st0">&quot;$g_encountered_party&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>eq, <span class="st0">&quot;$g_encounter_type&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>str_store_string, s2,<span class="st0">&quot;@You have encountered {s1}.&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>eq, <span class="st0">&quot;$g_encounter_type&quot;</span>, enctype_fighting_against_village_raid<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>str_store_party_name, s3, <span class="st0">&quot;$g_encounter_is_in_village&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>str_store_string, s2,<span class="st0">&quot;@You have engaged {s1} while they were raiding {s3}.&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>eq, <span class="st0">&quot;$g_encounter_type&quot;</span>, enctype_catched_during_village_raid<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>str_store_party_name, s3, <span class="st0">&quot;$g_encounter_is_in_village&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>str_store_string, s2,<span class="st0">&quot;@You were caught by {s1} while your forces were raiding {s3}.&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_party_count_members_with_full_health&quot;</span>, <span class="st0">&quot;p_collective_enemy&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>assign, <span class="st0">&quot;:num_enemy_regulars_remaining&quot;</span>, reg0<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>assign, <span class="st0">&quot;:enemy_finished&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>eq, <span class="st0">&quot;$g_battle_result&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>, <span class="co1">#battle won</span>
&#160;
            <span class="br0">&#40;</span>this_or_next|le, <span class="st0">&quot;:num_enemy_regulars_remaining&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>, <span class="co1">#battle won ##1.132, new line</span>
            <span class="br0">&#40;</span>le, <span class="st0">&quot;:num_enemy_regulars_remaining&quot;</span>,  <span class="st0">&quot;$num_routed_enemies&quot;</span><span class="br0">&#41;</span>, <span class="co1">#replaced for above line because we do not want routed agents to spawn again in next turn of battle.</span>
&#160;
            <span class="br0">&#40;</span>assign, <span class="st0">&quot;:enemy_finished&quot;</span>,<span class="nu0">1</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>eq, <span class="st0">&quot;$g_engaged_enemy&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>, 
&#160;
            <span class="br0">&#40;</span>this_or_next|le, <span class="st0">&quot;:num_enemy_regulars_remaining&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>, <span class="co1">##1.132, new line</span>
            <span class="br0">&#40;</span>le, <span class="st0">&quot;$g_enemy_fit_for_battle&quot;</span>, <span class="st0">&quot;$num_routed_enemies&quot;</span><span class="br0">&#41;</span>,  <span class="co1">#replaced for above line because we do not want routed agents to spawn again in next turn of battle.</span>
&#160;
            <span class="br0">&#40;</span>ge, <span class="st0">&quot;$g_friend_fit_for_battle&quot;</span>,<span class="nu0">1</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>assign, <span class="st0">&quot;:enemy_finished&quot;</span>,<span class="nu0">1</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
&#160;
          <span class="br0">&#40;</span>this_or_next|eq, <span class="st0">&quot;:enemy_finished&quot;</span>,<span class="nu0">1</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>eq,<span class="st0">&quot;$g_enemy_surrenders&quot;</span>,<span class="nu0">1</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_next_menu&quot;</span>, -<span class="nu0">1</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>jump_to_menu, <span class="st0">&quot;mnu_total_victory&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,       
          <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_party_count_members_with_full_health&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,        
          <span class="br0">&#40;</span>assign, <span class="st0">&quot;:num_our_regulars_remaining&quot;</span>, reg0<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>assign, <span class="st0">&quot;:friends_finished&quot;</span>,<span class="nu0">0</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>eq, <span class="st0">&quot;$g_battle_result&quot;</span>, -<span class="nu0">1</span><span class="br0">&#41;</span>,
&#160;
            <span class="co1">#(eq, &quot;:num_our_regulars_remaining&quot;, 0), #battle lost</span>
            <span class="br0">&#40;</span>le, <span class="st0">&quot;:num_our_regulars_remaining&quot;</span>,  <span class="st0">&quot;$num_routed_us&quot;</span><span class="br0">&#41;</span>, <span class="co1">#replaced for above line because we do not want routed agents to spawn again in next turn of battle.</span>
&#160;
            <span class="br0">&#40;</span>assign,  <span class="st0">&quot;:friends_finished&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>eq, <span class="st0">&quot;$g_engaged_enemy&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>ge, <span class="st0">&quot;$g_enemy_fit_for_battle&quot;</span>,<span class="nu0">1</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>le, <span class="st0">&quot;$g_friend_fit_for_battle&quot;</span>,<span class="nu0">0</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>assign,  <span class="st0">&quot;:friends_finished&quot;</span>,<span class="nu0">1</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
&#160;
          <span class="br0">&#40;</span>this_or_next|eq,  <span class="st0">&quot;:friends_finished&quot;</span>,<span class="nu0">1</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>eq,<span class="st0">&quot;$g_player_surrenders&quot;</span>,<span class="nu0">1</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_next_menu&quot;</span>, <span class="st0">&quot;mnu_captivity_start_wilderness&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>jump_to_menu, <span class="st0">&quot;mnu_total_defeat&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
&#160;
&#160;
        <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>eq, <span class="st0">&quot;$g_encountered_party_template&quot;</span>, <span class="st0">&quot;pt_looters&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>set_background_mesh, <span class="st0">&quot;mesh_pic_bandits&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>eq, <span class="st0">&quot;$g_encountered_party_template&quot;</span>, <span class="st0">&quot;pt_mountain_bandits&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>set_background_mesh, <span class="st0">&quot;mesh_pic_mountain_bandits&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>eq, <span class="st0">&quot;$g_encountered_party_template&quot;</span>, <span class="st0">&quot;pt_steppe_bandits&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>set_background_mesh, <span class="st0">&quot;mesh_pic_steppe_bandits&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>eq, <span class="st0">&quot;$g_encountered_party_template&quot;</span>, <span class="st0">&quot;pt_taiga_bandits&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>set_background_mesh, <span class="st0">&quot;mesh_pic_steppe_bandits&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>eq, <span class="st0">&quot;$g_encountered_party_template&quot;</span>, <span class="st0">&quot;pt_sea_raiders&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>set_background_mesh, <span class="st0">&quot;mesh_pic_sea_raiders&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>eq, <span class="st0">&quot;$g_encountered_party_template&quot;</span>, <span class="st0">&quot;pt_forest_bandits&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>set_background_mesh, <span class="st0">&quot;mesh_pic_forest_bandits&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>eq, <span class="st0">&quot;$g_encountered_party_template&quot;</span>, <span class="st0">&quot;pt_deserters&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>set_background_mesh, <span class="st0">&quot;mesh_pic_deserters&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>eq, <span class="st0">&quot;$g_encountered_party_template&quot;</span>, <span class="st0">&quot;pt_kingdom_hero_party&quot;</span><span class="br0">&#41;</span>,
		  <span class="br0">&#40;</span>party_stack_get_troop_id, <span class="st0">&quot;:leader_troop&quot;</span>, <span class="st0">&quot;$g_encountered_party&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
		  <span class="br0">&#40;</span>ge, <span class="st0">&quot;:leader_troop&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
		  <span class="br0">&#40;</span>troop_get_slot, <span class="st0">&quot;:leader_troop_faction&quot;</span>, <span class="st0">&quot;:leader_troop&quot;</span>, slot_troop_original_faction<span class="br0">&#41;</span>,
		  <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>eq, <span class="st0">&quot;:leader_troop_faction&quot;</span>, fac_kingdom_1<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>set_background_mesh, <span class="st0">&quot;mesh_pic_swad&quot;</span><span class="br0">&#41;</span>,
		  <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>eq, <span class="st0">&quot;:leader_troop_faction&quot;</span>, fac_kingdom_2<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>set_background_mesh, <span class="st0">&quot;mesh_pic_vaegir&quot;</span><span class="br0">&#41;</span>,
		  <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>eq, <span class="st0">&quot;:leader_troop_faction&quot;</span>, fac_kingdom_3<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>set_background_mesh, <span class="st0">&quot;mesh_pic_khergit&quot;</span><span class="br0">&#41;</span>,
		  <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>eq, <span class="st0">&quot;:leader_troop_faction&quot;</span>, fac_kingdom_4<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>set_background_mesh, <span class="st0">&quot;mesh_pic_nord&quot;</span><span class="br0">&#41;</span>,
		  <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>eq, <span class="st0">&quot;:leader_troop_faction&quot;</span>, fac_kingdom_5<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>set_background_mesh, <span class="st0">&quot;mesh_pic_rhodock&quot;</span><span class="br0">&#41;</span>,
		  <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>eq, <span class="st0">&quot;:leader_troop_faction&quot;</span>, fac_kingdom_6<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>set_background_mesh, <span class="st0">&quot;mesh_pic_sarranid_encounter&quot;</span><span class="br0">&#41;</span>,
		  <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
		<span class="co1">## CC for Floris</span>
		<span class="br0">&#40;</span>str_store_troop_name,s7,<span class="st0">&quot;$g_player_troop&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>set_player_troop, <span class="st0">&quot;$g_player_troop&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>str_store_string, s4, <span class="st0">&quot;@^^Current Commander: {s7}&quot;</span><span class="br0">&#41;</span>,
		<span class="co1">## CC for Floris</span>
		<span class="co1">## Pre-Battle Orders &amp; Deployment Begin</span>
		<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
		    <span class="br0">&#40;</span>party_slot_eq, <span class="st0">&quot;p_main_party&quot;</span>, slot_party_prebattle_customized_deployment, <span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>str_store_string, s4, <span class="st0">&quot;@{s4}^^The troops you selected are ready to join you in battle.&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,			
			<span class="br0">&#40;</span>str_store_string, s4, <span class="st0">&quot;@{s4}^^Your captains will deal with troop assignments.&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>party_slot_eq, <span class="st0">&quot;p_main_party&quot;</span>, slot_party_prebattle_plan, <span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>str_store_string, s4, <span class="st0">&quot;@{s4}^^Your orders have been sent to your captains.&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
		<span class="co1">#Wulf / not available for sea battles</span>
        <span class="br0">&#40;</span>party_get_current_terrain,<span class="st0">&quot;:terrain&quot;</span>,<span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>neq,<span class="st0">&quot;:terrain&quot;</span>,<span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="co1">#Wulf end      </span>
			<span class="br0">&#40;</span>str_store_string, s4, <span class="st0">&quot;@{s4}^^There is no tactical plan in place.&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
		<span class="co1">## Pre-Battle Orders &amp; Deployment End	</span>
    <span class="br0">&#93;</span>,
    <span class="br0">&#91;</span>
	<span class="co1">## CC</span>
      <span class="br0">&#40;</span><span class="st0">&quot;change_commander_simple_encounter&quot;</span>,
        <span class="br0">&#91;</span>
          <span class="br0">&#40;</span>set_player_troop, <span class="st0">&quot;$g_player_troop&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#93;</span>,
        <span class="st0">&quot;Change commander.&quot;</span>,
        <span class="br0">&#91;</span>
          <span class="br0">&#40;</span>start_presentation, <span class="st0">&quot;prsnt_change_commander&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#93;</span><span class="br0">&#41;</span>,
   <span class="co1">## CC	  </span>
	 	 <span class="br0">&#40;</span><span class="st0">&quot;access_crew&quot;</span>, 			<span class="co1">#Seafaring reassign crew before battle	#Floris</span>
		<span class="br0">&#91;</span>	<span class="br0">&#40;</span>party_get_current_terrain, <span class="st0">&quot;:terrain&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>eq, <span class="st0">&quot;:terrain&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
		<span class="br0">&#93;</span>,
      <span class="st0">&quot;Reassign your crew for battle.&quot;</span>,
      <span class="br0">&#91;</span>
	<span class="co1">#	 (try_for_parties, &quot;:ship_no&quot;),</span>
	<span class="co1">#		(try_begin),</span>
	<span class="co1">#			(party_slot_eq, &quot;:ship_no&quot;, slot_ship_center, 250),</span>
	<span class="co1">#			(party_get_num_companions, reg1, &quot;:ship_no&quot;),</span>
	<span class="co1">#			(gt, reg1, 1),</span>
	<span class="co1">#				(try_begin),</span>
	<span class="co1">#					(set_encountered_party, &quot;:ship_no&quot;),</span>
	<span class="co1">#					(change_screen_exchange_members, 0),</span>
	<span class="co1">#				(try_end),</span>
	<span class="co1">#			(assign, &quot;$g_next_menu&quot;, &quot;mnu_simple_encounter&quot;),</span>
	<span class="co1">#		(else_try),</span>
	<span class="co1">#			(display_message, &quot;@All your troops are already assigned to fight in the battle.&quot;),</span>
	<span class="co1">#		(try_end),</span>
	<span class="co1">#	 (try_end),</span>
&#160;
		<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:ship_no&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_get_num_companions, reg1, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>gt, reg1, <span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>change_screen_exchange_members, <span class="nu0">0</span>, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_next_menu&quot;</span>, <span class="st0">&quot;mnu_simple_encounter&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>display_message, <span class="st0">&quot;@All your troops are already assigned to fight in the battle.&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
     <span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
<span class="co1">## Prebattle Orders &amp; Deployment v0.751 by Caba'drin Begin</span>
	  <span class="br0">&#40;</span><span class="st0">&quot;encounter_attack_deployment&quot;</span>,
      <span class="br0">&#91;</span>
        <span class="br0">&#40;</span>eq, <span class="st0">&quot;$encountered_party_friendly&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>neg|troop_is_wounded, <span class="st0">&quot;$g_player_troop&quot;</span><span class="br0">&#41;</span>, <span class="co1">## CC</span>
		<span class="br0">&#40;</span>party_get_skill_level, <span class="st0">&quot;:tactics&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span>, skl_tactics<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>ge, <span class="st0">&quot;:tactics&quot;</span>, <span class="nu0">2</span><span class="br0">&#41;</span>,
&#160;
		<span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_prebattle_calculate_battle_advantage_and_size&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>assign, <span class="st0">&quot;:friend_count&quot;</span>, reg1<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>assign, <span class="st0">&quot;:enemy_count&quot;</span>, reg2<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>store_add, <span class="st0">&quot;:total_combatants&quot;</span>, <span class="st0">&quot;:friend_count&quot;</span>, <span class="st0">&quot;:enemy_count&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:battle_size&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span>, slot_party_prebattle_battle_size<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>gt, <span class="st0">&quot;:total_combatants&quot;</span>, <span class="st0">&quot;:battle_size&quot;</span><span class="br0">&#41;</span>,
      <span class="br0">&#93;</span>,
      <span class="st0">&quot;Choose who will join you in battle.&quot;</span>,
      <span class="br0">&#91;</span>
  		<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_next_menu&quot;</span>, <span class="st0">&quot;mnu_simple_encounter&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>start_presentation, <span class="st0">&quot;prsnt_prebattle_custom_deployment&quot;</span><span class="br0">&#41;</span>,
      <span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
	  <span class="br0">&#40;</span><span class="st0">&quot;encounter_attack_plan&quot;</span>,
      <span class="br0">&#91;</span>
        <span class="br0">&#40;</span>eq, <span class="st0">&quot;$encountered_party_friendly&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>neg|troop_is_wounded, <span class="st0">&quot;$g_player_troop&quot;</span><span class="br0">&#41;</span>, <span class="co1">## CC</span>
		<span class="br0">&#40;</span>neq, <span class="st0">&quot;$g_encounter_type&quot;</span>, enctype_fighting_against_village_raid<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>neq, <span class="st0">&quot;$g_encounter_type&quot;</span>, enctype_catched_during_village_raid<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_get_skill_level, <span class="st0">&quot;:tactics&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span>, skl_tactics<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>ge, <span class="st0">&quot;:tactics&quot;</span>, <span class="nu0">2</span><span class="br0">&#41;</span>,
		<span class="co1">#Wulf / not available for sea battles</span>
        <span class="br0">&#40;</span>party_get_current_terrain,<span class="st0">&quot;:terrain&quot;</span>,<span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>neq,<span class="st0">&quot;:terrain&quot;</span>,<span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="co1">#Wulf end      </span>
      <span class="br0">&#93;</span>,
      <span class="st0">&quot;Plan your battle with the enemy.&quot;</span>,
      <span class="br0">&#91;</span>
  		<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_next_menu&quot;</span>, <span class="st0">&quot;mnu_simple_encounter&quot;</span><span class="br0">&#41;</span>,		
		<span class="br0">&#40;</span>start_presentation, <span class="st0">&quot;prsnt_prebattle_orders&quot;</span><span class="br0">&#41;</span>,
      <span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
&#160;
	  <span class="br0">&#40;</span><span class="st0">&quot;encounter_attack_do_plan&quot;</span>,
      <span class="br0">&#91;</span>
        <span class="br0">&#40;</span>party_slot_eq, <span class="st0">&quot;p_main_party&quot;</span>, slot_party_prebattle_plan, <span class="nu0">1</span><span class="br0">&#41;</span>,
      <span class="br0">&#93;</span>,
      <span class="st0">&quot;Enough planning. To battle!&quot;</span>,
      <span class="br0">&#91;</span>
	    <span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party&quot;</span>, slot_party_prebattle_plan, <span class="nu0">0</span><span class="br0">&#41;</span>,
&#160;
        <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_battle_result&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_engaged_enemy&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
&#160;
        <span class="br0">&#40;</span>party_get_template_id, <span class="st0">&quot;:encountered_party_template&quot;</span>, <span class="st0">&quot;$g_encountered_party&quot;</span><span class="br0">&#41;</span>,		
        <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
		  <span class="br0">&#40;</span>eq, <span class="st0">&quot;:encountered_party_template&quot;</span>, <span class="st0">&quot;pt_village_farmers&quot;</span><span class="br0">&#41;</span>,
		  <span class="br0">&#40;</span>unlock_achievement, ACHIEVEMENT_HELP_HELP_IM_BEING_REPRESSED<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,     
&#160;
        <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_calculate_renown_value&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_calculate_battle_advantage&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>set_battle_advantage, reg0<span class="br0">&#41;</span>,
&#160;
		<span class="br0">&#40;</span>set_party_battle_mode<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>eq, <span class="st0">&quot;$g_encounter_type&quot;</span>, enctype_fighting_against_village_raid<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_village_raid_evil&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>set_jump_mission,<span class="st0">&quot;mt_village_raid&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:scene_to_use&quot;</span>, <span class="st0">&quot;$g_encounter_is_in_village&quot;</span>, slot_castle_exterior<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>jump_to_scene, <span class="st0">&quot;:scene_to_use&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>eq, <span class="st0">&quot;$g_encounter_type&quot;</span>, enctype_catched_during_village_raid<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_village_raid_evil&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>set_jump_mission,<span class="st0">&quot;mt_village_raid&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:scene_to_use&quot;</span>, <span class="st0">&quot;$g_encounter_is_in_village&quot;</span>, slot_castle_exterior<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>jump_to_scene, <span class="st0">&quot;:scene_to_use&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>set_jump_mission,<span class="st0">&quot;mt_lead_charge&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_setup_random_scene&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_next_menu&quot;</span>, <span class="st0">&quot;mnu_simple_encounter&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>jump_to_menu, <span class="st0">&quot;mnu_battle_debrief&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>change_screen_mission<span class="br0">&#41;</span>,
      <span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
	  <span class="br0">&#40;</span><span class="st0">&quot;encounter_attack_clear_plan&quot;</span>,
      <span class="br0">&#91;</span>
         <span class="br0">&#40;</span>this_or_next|party_slot_eq, <span class="st0">&quot;p_main_party&quot;</span>, slot_party_prebattle_customized_deployment, <span class="nu0">1</span><span class="br0">&#41;</span>,
		 <span class="br0">&#40;</span>party_slot_eq, <span class="st0">&quot;p_main_party&quot;</span>, slot_party_prebattle_plan, <span class="nu0">1</span><span class="br0">&#41;</span>,
		<span class="co1">#Wulf / not available for sea battles</span>
        <span class="br0">&#40;</span>party_get_current_terrain,<span class="st0">&quot;:terrain&quot;</span>,<span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>neq,<span class="st0">&quot;:terrain&quot;</span>,<span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="co1">#Wulf end      		 </span>
      <span class="br0">&#93;</span>,
      <span class="st0">&quot;Re-assess the situation.&quot;</span>,
      <span class="br0">&#91;</span>
        <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
		    <span class="br0">&#40;</span>party_slot_eq, <span class="st0">&quot;p_main_party&quot;</span>, slot_party_prebattle_customized_deployment, <span class="nu0">1</span><span class="br0">&#41;</span>,
		    <span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party&quot;</span>, slot_party_prebattle_customized_deployment, <span class="nu0">0</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
	    <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
		    <span class="br0">&#40;</span>party_slot_eq, <span class="st0">&quot;p_main_party&quot;</span>, slot_party_prebattle_plan, <span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party&quot;</span>, slot_party_prebattle_plan, <span class="nu0">0</span><span class="br0">&#41;</span>,
		    <span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party&quot;</span>, slot_party_prebattle_num_orders, <span class="nu0">0</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
&#160;
        <span class="br0">&#40;</span>jump_to_menu, <span class="st0">&quot;mnu_simple_encounter&quot;</span><span class="br0">&#41;</span>,
      <span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
&#160;
	  <span class="br0">&#40;</span><span class="st0">&quot;encounter_attack_hold&quot;</span>,
      <span class="br0">&#91;</span>
        <span class="br0">&#40;</span>eq, <span class="st0">&quot;$encountered_party_friendly&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>neg|troop_is_wounded, <span class="st0">&quot;$g_player_troop&quot;</span><span class="br0">&#41;</span>, <span class="co1">## CC</span>
		<span class="br0">&#40;</span>neq, <span class="st0">&quot;$g_encounter_type&quot;</span>, enctype_fighting_against_village_raid<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>neq, <span class="st0">&quot;$g_encounter_type&quot;</span>, enctype_catched_during_village_raid<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_get_skill_level, <span class="st0">&quot;:tactics&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span>, skl_tactics<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>ge, <span class="st0">&quot;:tactics&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_slot_eq, <span class="st0">&quot;p_main_party&quot;</span>, slot_party_prebattle_plan, <span class="nu0">0</span><span class="br0">&#41;</span>,
		<span class="co1">#Wulf / not available for sea battles</span>
        <span class="br0">&#40;</span>party_get_current_terrain,<span class="st0">&quot;:terrain&quot;</span>,<span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>neq,<span class="st0">&quot;:terrain&quot;</span>,<span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="co1">#Wulf end      </span>
      <span class="br0">&#93;</span>,
      <span class="st0">&quot;Take the field.&quot;</span>,
      <span class="br0">&#91;</span>
        <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_battle_result&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_engaged_enemy&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
&#160;
        <span class="br0">&#40;</span>party_get_template_id, <span class="st0">&quot;:encountered_party_template&quot;</span>, <span class="st0">&quot;$g_encountered_party&quot;</span><span class="br0">&#41;</span>,		
        <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
		  <span class="br0">&#40;</span>eq, <span class="st0">&quot;:encountered_party_template&quot;</span>, <span class="st0">&quot;pt_village_farmers&quot;</span><span class="br0">&#41;</span>,
		  <span class="br0">&#40;</span>unlock_achievement, ACHIEVEMENT_HELP_HELP_IM_BEING_REPRESSED<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,     
&#160;
        <span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party&quot;</span>, slot_party_prebattle_num_orders, <span class="nu0">1</span><span class="br0">&#41;</span>,
	    <span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:first_order&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span>, slot_party_prebattle_order_array_begin<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
		    <span class="br0">&#40;</span>gt, <span class="st0">&quot;:first_order&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party_backup&quot;</span>, slot_party_prebattle_order_array_begin, <span class="st0">&quot;:first_order&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party&quot;</span>, slot_party_prebattle_order_array_begin, <span class="nu0">910</span><span class="br0">&#41;</span>,		
&#160;
        <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_calculate_renown_value&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_calculate_battle_advantage&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>set_battle_advantage, reg0<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>set_party_battle_mode<span class="br0">&#41;</span>,
&#160;
        <span class="br0">&#40;</span>set_jump_mission,<span class="st0">&quot;mt_lead_charge&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_setup_random_scene&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_next_menu&quot;</span>, <span class="st0">&quot;mnu_simple_encounter&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>jump_to_menu, <span class="st0">&quot;mnu_battle_debrief&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>change_screen_mission<span class="br0">&#41;</span>,
      <span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
	  <span class="br0">&#40;</span><span class="st0">&quot;encounter_attack_follow&quot;</span>,
      <span class="br0">&#91;</span>
        <span class="br0">&#40;</span>eq, <span class="st0">&quot;$encountered_party_friendly&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>neg|troop_is_wounded, <span class="st0">&quot;$g_player_troop&quot;</span><span class="br0">&#41;</span>, <span class="co1">## CC</span>
		<span class="br0">&#40;</span>neq, <span class="st0">&quot;$g_encounter_type&quot;</span>, enctype_fighting_against_village_raid<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>neq, <span class="st0">&quot;$g_encounter_type&quot;</span>, enctype_catched_during_village_raid<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_get_skill_level, <span class="st0">&quot;:tactics&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span>, skl_tactics<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>ge, <span class="st0">&quot;:tactics&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_slot_eq, <span class="st0">&quot;p_main_party&quot;</span>, slot_party_prebattle_plan, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="co1">#Wulf / not available for sea battles</span>
        <span class="br0">&#40;</span>party_get_current_terrain,<span class="st0">&quot;:terrain&quot;</span>,<span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>neq,<span class="st0">&quot;:terrain&quot;</span>,<span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="co1">#Wulf end      </span>
	  <span class="br0">&#93;</span>,
      <span class="st0">&quot;Lead your troops.&quot;</span>,
      <span class="br0">&#91;</span>
        <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_battle_result&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_engaged_enemy&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
&#160;
        <span class="br0">&#40;</span>party_get_template_id, <span class="st0">&quot;:encountered_party_template&quot;</span>, <span class="st0">&quot;$g_encountered_party&quot;</span><span class="br0">&#41;</span>,		
        <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
		  <span class="br0">&#40;</span>eq, <span class="st0">&quot;:encountered_party_template&quot;</span>, <span class="st0">&quot;pt_village_farmers&quot;</span><span class="br0">&#41;</span>,
		  <span class="br0">&#40;</span>unlock_achievement, ACHIEVEMENT_HELP_HELP_IM_BEING_REPRESSED<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,     
&#160;
        <span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party&quot;</span>, slot_party_prebattle_num_orders, <span class="nu0">1</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:first_order&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span>, slot_party_prebattle_order_array_begin<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
		    <span class="br0">&#40;</span>gt, <span class="st0">&quot;:first_order&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party_backup&quot;</span>, slot_party_prebattle_order_array_begin, <span class="st0">&quot;:first_order&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party&quot;</span>, slot_party_prebattle_order_array_begin, <span class="nu0">911</span><span class="br0">&#41;</span>,		
&#160;
        <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_calculate_renown_value&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_calculate_battle_advantage&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>set_battle_advantage, reg0<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>set_party_battle_mode<span class="br0">&#41;</span>,
&#160;
        <span class="br0">&#40;</span>set_jump_mission,<span class="st0">&quot;mt_lead_charge&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_setup_random_scene&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_next_menu&quot;</span>, <span class="st0">&quot;mnu_simple_encounter&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>jump_to_menu, <span class="st0">&quot;mnu_battle_debrief&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>change_screen_mission<span class="br0">&#41;</span>,
      <span class="br0">&#93;</span><span class="br0">&#41;</span>,
<span class="co1">## Prebattle Orders &amp; Deployment End</span>
&#160;
&#160;
      <span class="br0">&#40;</span><span class="st0">&quot;encounter_attack&quot;</span>,
      <span class="br0">&#91;</span>
        <span class="br0">&#40;</span>eq, <span class="st0">&quot;$encountered_party_friendly&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>neg|troop_is_wounded, <span class="st0">&quot;$g_player_troop&quot;</span><span class="br0">&#41;</span>, <span class="co1">## CC</span>
		<span class="br0">&#40;</span>party_slot_eq, <span class="st0">&quot;p_main_party&quot;</span>, slot_party_prebattle_plan, <span class="nu0">0</span><span class="br0">&#41;</span>, <span class="co1">## Prebattle Orders &amp; Deployment v0.751 by Caba'drin</span>
        <span class="co1">#Wulf</span>
        <span class="br0">&#40;</span>party_get_current_terrain,<span class="st0">&quot;:terrain&quot;</span>,<span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>neq,<span class="st0">&quot;:terrain&quot;</span>,<span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="co1">#Wulf end</span>
	  <span class="br0">&#93;</span>,
      <span class="st0">&quot;Charge the enemy.&quot;</span>,
      <span class="br0">&#91;</span>
        <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_battle_result&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_engaged_enemy&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
&#160;
        <span class="br0">&#40;</span>party_get_template_id, <span class="st0">&quot;:encountered_party_template&quot;</span>, <span class="st0">&quot;$g_encountered_party&quot;</span><span class="br0">&#41;</span>,		
        <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
		  <span class="br0">&#40;</span>eq, <span class="st0">&quot;:encountered_party_template&quot;</span>, <span class="st0">&quot;pt_village_farmers&quot;</span><span class="br0">&#41;</span>,
		  <span class="br0">&#40;</span>unlock_achievement, ACHIEVEMENT_HELP_HELP_IM_BEING_REPRESSED<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,          
&#160;
        <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_calculate_renown_value&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_calculate_battle_advantage&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>set_battle_advantage, reg0<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>set_party_battle_mode<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>eq, <span class="st0">&quot;$g_encounter_type&quot;</span>, enctype_fighting_against_village_raid<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_village_raid_evil&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>set_jump_mission,<span class="st0">&quot;mt_village_raid&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:scene_to_use&quot;</span>, <span class="st0">&quot;$g_encounter_is_in_village&quot;</span>, slot_castle_exterior<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>jump_to_scene, <span class="st0">&quot;:scene_to_use&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>eq, <span class="st0">&quot;$g_encounter_type&quot;</span>, enctype_catched_during_village_raid<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_village_raid_evil&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>set_jump_mission,<span class="st0">&quot;mt_village_raid&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:scene_to_use&quot;</span>, <span class="st0">&quot;$g_encounter_is_in_village&quot;</span>, slot_castle_exterior<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>jump_to_scene, <span class="st0">&quot;:scene_to_use&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>set_jump_mission,<span class="st0">&quot;mt_lead_charge&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_setup_random_scene&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_next_menu&quot;</span>, <span class="st0">&quot;mnu_simple_encounter&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>jump_to_menu, <span class="st0">&quot;mnu_battle_debrief&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>change_screen_mission<span class="br0">&#41;</span>,
      <span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
	<span class="br0">&#40;</span><span class="st0">&quot;encounter_attack&quot;</span>,<span class="br0">&#91;</span>
          <span class="br0">&#40;</span>eq, <span class="st0">&quot;$encountered_party_friendly&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>neg|troop_is_wounded, <span class="st0">&quot;trp_player&quot;</span><span class="br0">&#41;</span>,
          <span class="co1">#Wulf</span>
          <span class="br0">&#40;</span>party_get_current_terrain,<span class="st0">&quot;:terrain&quot;</span>,<span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>eq,<span class="st0">&quot;:terrain&quot;</span>,<span class="nu0">0</span><span class="br0">&#41;</span>, <span class="co1">#No sea batlles</span>
          <span class="co1">#Wulf end</span>
          <span class="br0">&#93;</span>,
           <span class="st0">&quot;Close in and board the enemy.&quot;</span>,<span class="br0">&#91;</span>
           <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_battle_result&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_engaged_enemy&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_calculate_renown_value&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_calculate_battle_advantage&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>set_battle_advantage, reg0<span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>set_party_battle_mode<span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>eq, <span class="st0">&quot;$g_encounter_type&quot;</span>, enctype_fighting_against_village_raid<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_village_raid_evil&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>set_jump_mission,<span class="st0">&quot;mt_village_raid&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:scene_to_use&quot;</span>, <span class="st0">&quot;$g_encounter_is_in_village&quot;</span>, slot_castle_exterior<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>jump_to_scene, <span class="st0">&quot;:scene_to_use&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>eq, <span class="st0">&quot;$g_encounter_type&quot;</span>, enctype_catched_during_village_raid<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_village_raid_evil&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>set_jump_mission,<span class="st0">&quot;mt_village_raid&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:scene_to_use&quot;</span>, <span class="st0">&quot;$g_encounter_is_in_village&quot;</span>, slot_castle_exterior<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>jump_to_scene, <span class="st0">&quot;:scene_to_use&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
			<span class="co1">#Wulf</span>
				<span class="br0">&#40;</span>set_jump_mission,<span class="st0">&quot;mt_ship_battle&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>val_add,reg10,reg11<span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>gt,reg10,<span class="nu0">60</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>jump_to_scene, <span class="st0">&quot;scn_sea_4&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>val_add,reg10,reg11<span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>gt,reg10,<span class="nu0">30</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>jump_to_scene, <span class="st0">&quot;scn_sea_2&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>jump_to_scene, <span class="st0">&quot;scn_sea_1&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>end_try<span class="br0">&#41;</span>,
			<span class="co1">#Wulf end</span>
           <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
    <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_next_menu&quot;</span>, <span class="st0">&quot;mnu_simple_encounter&quot;</span><span class="br0">&#41;</span>,
    <span class="br0">&#40;</span>jump_to_menu, <span class="st0">&quot;mnu_battle_debrief&quot;</span><span class="br0">&#41;</span>,
    <span class="br0">&#40;</span>change_screen_mission<span class="br0">&#41;</span>,
    <span class="br0">&#93;</span><span class="br0">&#41;</span>,</pre></div></div>
<p>As mentioned before - this disables parts of PBOD and CC so that i/we dont need to alter their code. You could also do the same thing as what ruthven did with encounter_attack(see below), but i felt that these options where unnecessary. You can rework it yourself though&#160;;)<br />
</p><p>Next up is <b>encounter_attack</b>, which remained the way Ruthven originally created it. (This code is right below simple_encounter.)<br />
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1">	<span class="br0">&#40;</span><span class="st0">&quot;encounter_attack&quot;</span>,<span class="br0">&#91;</span>
          <span class="br0">&#40;</span>eq, <span class="st0">&quot;$encountered_party_friendly&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>neg|troop_is_wounded, <span class="st0">&quot;trp_player&quot;</span><span class="br0">&#41;</span>,
          <span class="co1">#Wulf</span>
          <span class="br0">&#40;</span>party_get_current_terrain,<span class="st0">&quot;:terrain&quot;</span>,<span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>eq,<span class="st0">&quot;:terrain&quot;</span>,<span class="nu0">0</span><span class="br0">&#41;</span>, <span class="co1">#No sea batlles</span>
          <span class="co1">#Wulf end</span>
          <span class="br0">&#93;</span>,
           <span class="st0">&quot;Close in and board the enemy.&quot;</span>,<span class="br0">&#91;</span>
           <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_battle_result&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_engaged_enemy&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_calculate_renown_value&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_calculate_battle_advantage&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>set_battle_advantage, reg0<span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>set_party_battle_mode<span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>eq, <span class="st0">&quot;$g_encounter_type&quot;</span>, enctype_fighting_against_village_raid<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_village_raid_evil&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>set_jump_mission,<span class="st0">&quot;mt_village_raid&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:scene_to_use&quot;</span>, <span class="st0">&quot;$g_encounter_is_in_village&quot;</span>, slot_castle_exterior<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>jump_to_scene, <span class="st0">&quot;:scene_to_use&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>eq, <span class="st0">&quot;$g_encounter_type&quot;</span>, enctype_catched_during_village_raid<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_village_raid_evil&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>set_jump_mission,<span class="st0">&quot;mt_village_raid&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:scene_to_use&quot;</span>, <span class="st0">&quot;$g_encounter_is_in_village&quot;</span>, slot_castle_exterior<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>jump_to_scene, <span class="st0">&quot;:scene_to_use&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
			<span class="co1">#Wulf</span>
				<span class="br0">&#40;</span>set_jump_mission,<span class="st0">&quot;mt_ship_battle&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>val_add,reg10,reg11<span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>gt,reg10,<span class="nu0">60</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>jump_to_scene, <span class="st0">&quot;scn_sea_4&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>val_add,reg10,reg11<span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>gt,reg10,<span class="nu0">30</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>jump_to_scene, <span class="st0">&quot;scn_sea_2&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>jump_to_scene, <span class="st0">&quot;scn_sea_1&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>end_try<span class="br0">&#41;</span>,
			<span class="co1">#Wulf end</span>
           <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
    <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_next_menu&quot;</span>, <span class="st0">&quot;mnu_simple_encounter&quot;</span><span class="br0">&#41;</span>,
    <span class="br0">&#40;</span>jump_to_menu, <span class="st0">&quot;mnu_battle_debrief&quot;</span><span class="br0">&#41;</span>,
    <span class="br0">&#40;</span>change_screen_mission<span class="br0">&#41;</span>,
    <span class="br0">&#93;</span><span class="br0">&#41;</span>,</pre></div></div>
<p>This loads the correct battle scenes, while you are sailing the sea.<br />
</p><p>I then decided to also disable "Leave some men behind and flee.", because it seemed unrealistic to me.<br />
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1">      <span class="br0">&#40;</span><span class="st0">&quot;encounter_retreat&quot;</span>,<span class="br0">&#91;</span>
         <span class="br0">&#40;</span>eq,<span class="st0">&quot;$cant_leave_encounter&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
		 <span class="br0">&#40;</span>party_get_current_terrain, <span class="st0">&quot;:terrain&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>, <span class="co1">#Cant leave man behind at sea / Seafaring</span>
		 <span class="br0">&#40;</span>neq, <span class="st0">&quot;:terrain&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_get_max_skill_of_player_party&quot;</span>, <span class="st0">&quot;skl_tactics&quot;</span><span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>assign, <span class="st0">&quot;:max_skill&quot;</span>, reg0<span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>val_add, <span class="st0">&quot;:max_skill&quot;</span>, <span class="nu0">4</span><span class="br0">&#41;</span>,
&#160;
         <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_party_count_members_with_full_health&quot;</span>, <span class="st0">&quot;p_collective_enemy&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>assign, <span class="st0">&quot;:enemy_party_strength&quot;</span>, reg0<span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>val_div, <span class="st0">&quot;:enemy_party_strength&quot;</span>, <span class="nu0">2</span><span class="br0">&#41;</span>,
&#160;
         <span class="br0">&#40;</span>val_div, <span class="st0">&quot;:enemy_party_strength&quot;</span>, <span class="st0">&quot;:max_skill&quot;</span><span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>val_max, <span class="st0">&quot;:enemy_party_strength&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
&#160;
         <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_party_count_fit_regulars&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>assign, <span class="st0">&quot;:player_count&quot;</span>, reg0<span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>ge, <span class="st0">&quot;:player_count&quot;</span>, <span class="st0">&quot;:enemy_party_strength&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_slot_eq, <span class="st0">&quot;p_main_party&quot;</span>, slot_party_prebattle_plan, <span class="nu0">0</span><span class="br0">&#41;</span>, <span class="co1">## Prebattle Orders &amp; Deployment v0.751 by Caba'drin</span>
         <span class="br0">&#93;</span>,<span class="st0">&quot;Pull back, leaving some soldiers behind to cover your retreat.&quot;</span>,<span class="br0">&#91;</span><span class="br0">&#40;</span>jump_to_menu, <span class="st0">&quot;mnu_encounter_retreat_confirm&quot;</span><span class="br0">&#41;</span>,<span class="br0">&#93;</span><span class="br0">&#41;</span>,</pre></div></div>
<p>You still need the correct option to attack so here we go:<br />
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1">     <span class="br0">&#40;</span><span class="st0">&quot;join_attack&quot;</span>,
	  <span class="br0">&#91;</span><span class="br0">&#40;</span>party_get_current_terrain,<span class="st0">&quot;:terrain&quot;</span>,<span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>neq,<span class="st0">&quot;:terrain&quot;</span>,<span class="nu0">0</span><span class="br0">&#41;</span>,
<span class="co1">#          (neq, &quot;$encountered_party_hostile&quot;, 0),</span>
           <span class="br0">&#40;</span>neg|troop_is_wounded, <span class="st0">&quot;trp_player&quot;</span><span class="br0">&#41;</span>,
<span class="co1">##          (store_troop_health,reg(5),&quot;trp_player&quot;),</span>
<span class="co1">##          (ge,reg(5),20),</span>
          <span class="br0">&#93;</span>,
                            <span class="st0">&quot;Charge the enemy.&quot;</span>,<span class="br0">&#91;</span>
                                <span class="br0">&#40;</span>party_set_next_battle_simulation_time, <span class="st0">&quot;$g_encountered_party&quot;</span>, -<span class="nu0">1</span><span class="br0">&#41;</span>,
                                <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_battle_result&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
                                <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_calculate_renown_value&quot;</span><span class="br0">&#41;</span>,
                                <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_calculate_battle_advantage&quot;</span><span class="br0">&#41;</span>,
                                <span class="br0">&#40;</span>set_battle_advantage, reg0<span class="br0">&#41;</span>,
                                <span class="br0">&#40;</span>set_party_battle_mode<span class="br0">&#41;</span>,
                                <span class="br0">&#40;</span>set_jump_mission,<span class="st0">&quot;mt_lead_charge&quot;</span><span class="br0">&#41;</span>,
                                <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_setup_random_scene&quot;</span><span class="br0">&#41;</span>,
                                <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_next_menu&quot;</span>, <span class="st0">&quot;mnu_join_battle&quot;</span><span class="br0">&#41;</span>,
                                <span class="br0">&#40;</span>jump_to_menu, <span class="st0">&quot;mnu_battle_debrief&quot;</span><span class="br0">&#41;</span>,
                                <span class="br0">&#40;</span>change_screen_mission<span class="br0">&#41;</span>,
                                <span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
            <span class="br0">&#40;</span><span class="st0">&quot;join_attack&quot;</span>,<span class="br0">&#91;</span><span class="br0">&#40;</span>party_get_current_terrain,<span class="st0">&quot;:terrain&quot;</span>,<span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>eq,<span class="st0">&quot;:terrain&quot;</span>,<span class="nu0">0</span><span class="br0">&#41;</span>,
<span class="co1">#          (neq, &quot;$encountered_party_hostile&quot;, 0),</span>
           <span class="br0">&#40;</span>neg|troop_is_wounded, <span class="st0">&quot;trp_player&quot;</span><span class="br0">&#41;</span>,
<span class="co1">##          (store_troop_health,reg(5),&quot;trp_player&quot;),</span>
<span class="co1">##          (ge,reg(5),20),</span>
          <span class="br0">&#93;</span>,
                            <span class="st0">&quot;Board the enemy&quot;</span>,<span class="br0">&#91;</span>
                                <span class="br0">&#40;</span>party_set_next_battle_simulation_time, <span class="st0">&quot;$g_encountered_party&quot;</span>, -<span class="nu0">1</span><span class="br0">&#41;</span>,
                                <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_battle_result&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
                                <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_calculate_renown_value&quot;</span><span class="br0">&#41;</span>,
                                <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_calculate_battle_advantage&quot;</span><span class="br0">&#41;</span>,
                                <span class="br0">&#40;</span>set_battle_advantage, reg0<span class="br0">&#41;</span>,
                                <span class="br0">&#40;</span>set_party_battle_mode<span class="br0">&#41;</span>,
                                <span class="br0">&#40;</span>set_jump_mission,<span class="st0">&quot;mt_ship_battle&quot;</span><span class="br0">&#41;</span>,
                                <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
                                   <span class="br0">&#40;</span>val_add,reg10,reg11<span class="br0">&#41;</span>,
                                   <span class="br0">&#40;</span>gt,reg10,<span class="nu0">60</span><span class="br0">&#41;</span>,
                                   <span class="br0">&#40;</span>jump_to_scene, <span class="st0">&quot;scn_sea_4&quot;</span><span class="br0">&#41;</span>,
                                 <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
                                   <span class="br0">&#40;</span>val_add,reg10,reg11<span class="br0">&#41;</span>,
                                   <span class="br0">&#40;</span>gt,reg10,<span class="nu0">30</span><span class="br0">&#41;</span>,
                                   <span class="br0">&#40;</span>jump_to_scene, <span class="st0">&quot;scn_sea_2&quot;</span><span class="br0">&#41;</span>,
                                 <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
                                   <span class="br0">&#40;</span>jump_to_scene, <span class="st0">&quot;scn_sea_1&quot;</span><span class="br0">&#41;</span>,
                                   <span class="br0">&#40;</span>end_try<span class="br0">&#41;</span>,
                                <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_next_menu&quot;</span>, <span class="st0">&quot;mnu_join_battle&quot;</span><span class="br0">&#41;</span>,
                                <span class="br0">&#40;</span>jump_to_menu, <span class="st0">&quot;mnu_battle_debrief&quot;</span><span class="br0">&#41;</span>,
                                <span class="br0">&#40;</span>change_screen_mission<span class="br0">&#41;</span>,
        <span class="br0">&#93;</span><span class="br0">&#41;</span>,</pre></div></div>
<p><br />
<b>Quote:</b><br />
</p><p>__________________________________________<br />
Those codes make you jump to the ship scenes when you're fighting someone on the water. Which leads to the next issue; getting someone to fight. Save and exit module_game_menus and open up module_mission_templates. Go to the bottom of the page and add this code:
__________________________________________<br />
While you were technically set to go and fight with Ruthvens original code, caba and me figured out that loot is based on the amount of dead enemies. Which is why we updated the original code with a (native) trigger that counts these dead men. 
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1">        <span class="co1">#Wulf begin</span>
    <span class="br0">&#40;</span>
    <span class="st0">&quot;ship_battle&quot;</span>,mtf_battle_mode,-<span class="nu0">1</span>,
    <span class="st0">&quot;You close in and board the enemy ships&quot;</span>,
    <span class="br0">&#91;</span><span class="br0">&#40;</span><span class="nu0">0</span>,mtef_attackers|mtef_team_1,af_override_horse,aif_start_alarmed,<span class="nu0">4</span>,<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>,
    <span class="br0">&#40;</span><span class="nu0">1</span>,mtef_attackers|mtef_team_1,af_override_horse,aif_start_alarmed,<span class="nu0">4</span>,<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>,
    <span class="br0">&#40;</span><span class="nu0">2</span>,mtef_attackers|mtef_team_1,af_override_horse,aif_start_alarmed,<span class="nu0">4</span>,<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>,
    <span class="br0">&#40;</span><span class="nu0">3</span>,mtef_attackers|mtef_team_1,af_override_horse,aif_start_alarmed,<span class="nu0">4</span>,<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>,
    <span class="br0">&#40;</span><span class="nu0">4</span>,mtef_attackers|mtef_team_1,af_override_horse,aif_start_alarmed,<span class="nu0">4</span>,<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>,
    <span class="br0">&#40;</span><span class="nu0">5</span>,mtef_attackers|mtef_team_1,af_override_horse,aif_start_alarmed,<span class="nu0">4</span>,<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>,
    <span class="br0">&#40;</span><span class="nu0">6</span>,mtef_attackers|mtef_team_1,af_override_horse,aif_start_alarmed,<span class="nu0">4</span>,<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>,     
    <span class="br0">&#40;</span><span class="nu0">7</span>,mtef_attackers|mtef_team_1,af_override_horse,aif_start_alarmed,<span class="nu0">4</span>,<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>,
    <span class="br0">&#40;</span><span class="nu0">10</span>,mtef_defenders|mtef_team_0,af_override_horse,aif_start_alarmed,<span class="nu0">4</span>,<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>,
    <span class="br0">&#40;</span><span class="nu0">11</span>,mtef_defenders|mtef_team_0,af_override_horse,aif_start_alarmed,<span class="nu0">4</span>,<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>,
    <span class="br0">&#40;</span><span class="nu0">8</span>,mtef_defenders|mtef_team_0,af_override_horse,aif_start_alarmed,<span class="nu0">4</span>,<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>,
    <span class="br0">&#40;</span><span class="nu0">9</span>,mtef_defenders|mtef_team_0,af_override_horse,aif_start_alarmed,<span class="nu0">4</span>,<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>,
    <span class="br0">&#40;</span><span class="nu0">12</span>,mtef_defenders|mtef_team_0,af_override_horse,aif_start_alarmed,<span class="nu0">4</span>,<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>,
    <span class="br0">&#40;</span><span class="nu0">13</span>,mtef_defenders|mtef_team_0,af_override_horse,aif_start_alarmed,<span class="nu0">4</span>,<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>,
    <span class="br0">&#40;</span><span class="nu0">14</span>,mtef_defenders|mtef_team_0,af_override_horse,aif_start_alarmed,<span class="nu0">4</span>,<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>,
    <span class="br0">&#40;</span><span class="nu0">15</span>,mtef_defenders|mtef_team_0,af_override_horse,aif_start_alarmed,<span class="nu0">4</span>,<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>,
     <span class="br0">&#93;</span>,
    <span class="br0">&#91;</span>
      <span class="br0">&#40;</span>ti_on_agent_spawn, <span class="nu0">0</span>, <span class="nu0">0</span>, <span class="br0">&#91;</span><span class="br0">&#93;</span>,
       <span class="br0">&#91;</span>
         <span class="br0">&#40;</span>store_trigger_param_1, <span class="st0">&quot;:agent_no&quot;</span><span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_agent_reassign_team&quot;</span>, <span class="st0">&quot;:agent_no&quot;</span><span class="br0">&#41;</span>,
         <span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
     <span class="br0">&#40;</span>ti_on_agent_killed_or_wounded, <span class="nu0">0</span>, <span class="nu0">0</span>, <span class="br0">&#91;</span><span class="br0">&#93;</span>,
       <span class="br0">&#91;</span>
        <span class="br0">&#40;</span>store_trigger_param_1, <span class="st0">&quot;:dead_agent_no&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>store_trigger_param_2, <span class="st0">&quot;:killer_agent_no&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>store_trigger_param_3, <span class="st0">&quot;:is_wounded&quot;</span><span class="br0">&#41;</span>,
&#160;
        <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>ge, <span class="st0">&quot;:dead_agent_no&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>neg|agent_is_ally, <span class="st0">&quot;:dead_agent_no&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>agent_is_human, <span class="st0">&quot;:dead_agent_no&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>agent_get_troop_id, <span class="st0">&quot;:dead_agent_troop_id&quot;</span>, <span class="st0">&quot;:dead_agent_no&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>str_store_troop_name, s6, <span class="st0">&quot;:dead_agent_troop_id&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>assign, reg0, <span class="st0">&quot;:dead_agent_no&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>assign, reg1, <span class="st0">&quot;:killer_agent_no&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>assign, reg2, <span class="st0">&quot;:is_wounded&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>agent_get_team, reg3, <span class="st0">&quot;:dead_agent_no&quot;</span><span class="br0">&#41;</span>,          
          <span class="co1"># #(display_message, &quot;@{!}dead agent no&#160;: {reg0}&#160;; killer agent no&#160;: {reg1}&#160;; is_wounded&#160;: {reg2}&#160;; dead agent team&#160;: {reg3}&#160;; {s6} is added&quot;), </span>
          <span class="br0">&#40;</span>party_add_members, <span class="st0">&quot;p_total_enemy_casualties&quot;</span>, <span class="st0">&quot;:dead_agent_troop_id&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>, <span class="co1">#addition_to_p_total_enemy_casualties</span>
          <span class="br0">&#40;</span>eq, <span class="st0">&quot;:is_wounded&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>party_wound_members, <span class="st0">&quot;p_total_enemy_casualties&quot;</span>, <span class="st0">&quot;:dead_agent_troop_id&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>, 
        <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
&#160;
        <span class="co1">#(call_script, &quot;script_apply_death_effect_on_courage_scores&quot;, &quot;:dead_agent_no&quot;, &quot;:killer_agent_no&quot;),</span>
       <span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
      <span class="br0">&#40;</span><span class="nu0">0</span>, <span class="nu0">0</span>, ti_once, <span class="br0">&#91;</span><span class="br0">&#93;</span>, <span class="br0">&#91;</span><span class="br0">&#40;</span>assign,<span class="st0">&quot;$g_battle_won&quot;</span>,<span class="nu0">0</span><span class="br0">&#41;</span>,
                           <span class="br0">&#40;</span>assign,<span class="st0">&quot;$defender_reinforcement_stage&quot;</span>,<span class="nu0">0</span><span class="br0">&#41;</span>,
                           <span class="br0">&#40;</span>assign,<span class="st0">&quot;$attacker_reinforcement_stage&quot;</span>,<span class="nu0">0</span><span class="br0">&#41;</span>,
                           <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_place_player_banner_near_inventory&quot;</span><span class="br0">&#41;</span>,
                           <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_combat_music_set_situation_with_culture&quot;</span><span class="br0">&#41;</span>,
                           <span class="br0">&#93;</span><span class="br0">&#41;</span>,
      common_music_situation_update,
      common_battle_check_friendly_kills,
&#160;
      <span class="br0">&#40;</span><span class="nu0">1</span>, <span class="nu0">0</span>, <span class="nu0">5</span>, <span class="br0">&#91;</span><span class="br0">&#40;</span>lt,<span class="st0">&quot;$defender_reinforcement_stage&quot;</span>,<span class="nu0">2</span><span class="br0">&#41;</span>,
                 <span class="br0">&#40;</span>store_mission_timer_a,<span class="st0">&quot;:mission_time&quot;</span><span class="br0">&#41;</span>,
                 <span class="br0">&#40;</span>ge,<span class="st0">&quot;:mission_time&quot;</span>,<span class="nu0">10</span><span class="br0">&#41;</span>,
                 <span class="br0">&#40;</span>store_normalized_team_count,<span class="st0">&quot;:num_defenders&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
                 <span class="br0">&#40;</span>lt,<span class="st0">&quot;:num_defenders&quot;</span>,<span class="nu0">6</span><span class="br0">&#41;</span>,
<span class="co1">#                 (assign, reg2, &quot;:num_defenders&quot;),</span>
<span class="co1">#                 (display_message,&quot;@num_defenders = {reg2}&quot;)</span>
                 <span class="br0">&#93;</span>,
           <span class="br0">&#91;</span><span class="br0">&#40;</span>add_reinforcements_to_entry,<span class="nu0">0</span>,<span class="nu0">7</span><span class="br0">&#41;</span>,<span class="br0">&#40;</span>val_add,<span class="st0">&quot;$defender_reinforcement_stage&quot;</span>,<span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
      <span class="br0">&#40;</span><span class="nu0">1</span>, <span class="nu0">0</span>, <span class="nu0">5</span>, <span class="br0">&#91;</span><span class="br0">&#40;</span>lt,<span class="st0">&quot;$attacker_reinforcement_stage&quot;</span>,<span class="nu0">2</span><span class="br0">&#41;</span>,
                 <span class="br0">&#40;</span>store_mission_timer_a,<span class="st0">&quot;:mission_time&quot;</span><span class="br0">&#41;</span>,
                 <span class="br0">&#40;</span>ge,<span class="st0">&quot;:mission_time&quot;</span>,<span class="nu0">10</span><span class="br0">&#41;</span>,
                 <span class="br0">&#40;</span>store_normalized_team_count,<span class="st0">&quot;:num_attackers&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
                 <span class="br0">&#40;</span>lt,<span class="st0">&quot;:num_attackers&quot;</span>,<span class="nu0">6</span><span class="br0">&#41;</span>,
<span class="co1">#                 (assign, reg2, &quot;:num_attackers&quot;),</span>
<span class="co1">#                 (display_message,&quot;@num_attackers = {reg2}&quot;)</span>
                 <span class="br0">&#93;</span>,
           <span class="br0">&#91;</span><span class="br0">&#40;</span>add_reinforcements_to_entry,<span class="nu0">3</span>,<span class="nu0">7</span><span class="br0">&#41;</span>,<span class="br0">&#40;</span>val_add,<span class="st0">&quot;$attacker_reinforcement_stage&quot;</span>,<span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
      common_battle_check_victory_condition,
      common_battle_victory_display,
      common_battle_tab_press,
&#160;
      <span class="br0">&#40;</span><span class="nu0">1</span>, <span class="nu0">4</span>, ti_once, <span class="br0">&#91;</span><span class="br0">&#40;</span>main_hero_fallen<span class="br0">&#41;</span><span class="br0">&#93;</span>,
          <span class="br0">&#91;</span>
              <span class="br0">&#40;</span>assign, <span class="st0">&quot;$pin_player_fallen&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
              <span class="br0">&#40;</span>str_store_string, s5, <span class="st0">&quot;str_retreat&quot;</span><span class="br0">&#41;</span>,
              <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_simulate_retreat&quot;</span>, <span class="nu0">10</span>, <span class="nu0">20</span><span class="br0">&#41;</span>,
              <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_battle_result&quot;</span>, -<span class="nu0">1</span><span class="br0">&#41;</span>,
              <span class="br0">&#40;</span>set_mission_result,-<span class="nu0">1</span><span class="br0">&#41;</span>,
              <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_count_mission_casualties_from_agents&quot;</span><span class="br0">&#41;</span>,
              <span class="br0">&#40;</span>finish_mission,<span class="nu0">0</span><span class="br0">&#41;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>,
<span class="co1">#Wulf end</span>
      <span class="br0">&#93;</span><span class="br0">&#41;</span>,</pre></div></div>
<p>As this kit includes Sea Trade we will have to implement these merchants in the script_party_calculate_loot, which is called from the game menu total_victory.
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1">   <span class="co1">#script_party_calculate_loot:</span>
    <span class="co1"># INPUT:</span>
    <span class="co1"># param1: Party-id</span>
    <span class="co1"># Returns num looted items in reg(0)</span>
    <span class="br0">&#40;</span><span class="st0">&quot;party_calculate_loot&quot;</span>,
      <span class="br0">&#91;</span>
        <span class="br0">&#40;</span>store_script_param_1, <span class="st0">&quot;:enemy_party&quot;</span><span class="br0">&#41;</span>, <span class="co1">#Enemy Party_id</span>
&#160;
        <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_calculate_main_party_shares&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>assign, <span class="st0">&quot;:num_player_party_shares&quot;</span>, reg0<span class="br0">&#41;</span>,
        <span class="co1">#(assign, &quot;:num_ally_shares&quot;, reg1),</span>
        <span class="co1">#(store_add, &quot;:num_shares&quot;,  &quot;:num_player_party_shares&quot;, &quot;:num_ally_shares&quot;),</span>
&#160;
        <span class="co1">#Calculate player loot probability</span>
        <span class="co1">#(assign, &quot;:loot_probability&quot;, 100),</span>
        <span class="co1">#(val_mul, &quot;:loot_probability&quot;, 10),</span>
        <span class="co1">#(val_div, &quot;:loot_probability&quot;, &quot;:num_shares&quot;),</span>
&#160;
        <span class="br0">&#40;</span>try_for_range, <span class="st0">&quot;:i_loot&quot;</span>, <span class="nu0">0</span>, num_party_loot_slots<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>store_add, <span class="st0">&quot;:cur_loot_slot&quot;</span>, <span class="st0">&quot;:i_loot&quot;</span>, slot_party_looted_item_1<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:item_no&quot;</span>, <span class="st0">&quot;$g_enemy_party&quot;</span>, <span class="st0">&quot;:cur_loot_slot&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>gt, <span class="st0">&quot;:item_no&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;$g_enemy_party&quot;</span>, <span class="st0">&quot;:cur_loot_slot&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>val_sub, <span class="st0">&quot;:cur_loot_slot&quot;</span>, slot_party_looted_item_1<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>val_add, <span class="st0">&quot;:cur_loot_slot&quot;</span>, slot_party_looted_item_1_modifier<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:item_modifier&quot;</span>, <span class="st0">&quot;$g_enemy_party&quot;</span>, <span class="st0">&quot;:cur_loot_slot&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>troop_add_item, <span class="st0">&quot;trp_temp_troop&quot;</span>, <span class="st0">&quot;:item_no&quot;</span>, <span class="st0">&quot;:item_modifier&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;$g_enemy_party&quot;</span>, slot_party_next_looted_item_slot, <span class="nu0">0</span><span class="br0">&#41;</span>,
&#160;
        <span class="br0">&#40;</span>assign, <span class="st0">&quot;:num_looted_items&quot;</span>,<span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>this_or_next|party_slot_eq, <span class="st0">&quot;$g_enemy_party&quot;</span>, slot_party_type, spt_kingdom_caravan<span class="br0">&#41;</span>,
		  <span class="br0">&#40;</span>this_or_next|party_slot_eq, <span class="st0">&quot;$g_enemy_party&quot;</span>, slot_party_type, spt_merchant_caravan<span class="br0">&#41;</span>, <span class="co1">#Floris Seafaring / Seatrade</span>
          <span class="br0">&#40;</span>this_or_next|party_slot_eq, <span class="st0">&quot;$g_enemy_party&quot;</span>, slot_party_type, spt_bandit_lair<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>party_slot_eq, <span class="st0">&quot;$g_enemy_party&quot;</span>, slot_party_type, spt_village_farmer<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>store_mul, <span class="st0">&quot;:plunder_amount&quot;</span>, player_loot_share, <span class="nu0">30</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>val_mul, <span class="st0">&quot;:plunder_amount&quot;</span>, <span class="st0">&quot;$g_strength_contribution_of_player&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>val_div, <span class="st0">&quot;:plunder_amount&quot;</span>, <span class="nu0">100</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>val_div, <span class="st0">&quot;:plunder_amount&quot;</span>, <span class="st0">&quot;:num_player_party_shares&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>this_or_next|party_slot_eq, <span class="st0">&quot;$g_enemy_party&quot;</span>, slot_party_type, spt_merchant_caravan<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>party_slot_eq, <span class="st0">&quot;$g_enemy_party&quot;</span>, slot_party_type, spt_kingdom_caravan<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>reset_item_probabilities, <span class="nu0">100</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>assign, <span class="st0">&quot;:range_min&quot;</span>, trade_goods_begin<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>assign, <span class="st0">&quot;:range_max&quot;</span>, trade_goods_end<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>party_slot_eq, <span class="st0">&quot;$g_enemy_party&quot;</span>, slot_party_type, spt_bandit_lair<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>val_div, <span class="st0">&quot;:plunder_amount&quot;</span>, <span class="nu0">2</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>reset_item_probabilities, <span class="nu0">1</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>assign, <span class="st0">&quot;:range_min&quot;</span>, food_begin<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>assign, <span class="st0">&quot;:range_max&quot;</span>, food_end<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>val_div, <span class="st0">&quot;:plunder_amount&quot;</span>, <span class="nu0">5</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>reset_item_probabilities, <span class="nu0">1</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>assign, <span class="st0">&quot;:range_min&quot;</span>, food_begin<span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>assign, <span class="st0">&quot;:range_max&quot;</span>, food_end<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>store_sub, <span class="st0">&quot;:item_to_price_slot&quot;</span>, slot_town_trade_good_prices_begin, trade_goods_begin<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>try_for_range, <span class="st0">&quot;:cur_goods&quot;</span>, <span class="st0">&quot;:range_min&quot;</span>, <span class="st0">&quot;:range_max&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
              <span class="br0">&#40;</span>neg|party_slot_eq, <span class="st0">&quot;$g_enemy_party&quot;</span>, slot_party_type, spt_bandit_lair<span class="br0">&#41;</span>,
              <span class="br0">&#40;</span>store_add, <span class="st0">&quot;:cur_price_slot&quot;</span>, <span class="st0">&quot;:cur_goods&quot;</span>, <span class="st0">&quot;:item_to_price_slot&quot;</span><span class="br0">&#41;</span>,
              <span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:cur_price&quot;</span>, <span class="st0">&quot;$g_enemy_party&quot;</span>, <span class="st0">&quot;:cur_price_slot&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
              <span class="br0">&#40;</span>assign, <span class="st0">&quot;:cur_price&quot;</span>, maximum_price_factor<span class="br0">&#41;</span>,
              <span class="br0">&#40;</span>val_add, <span class="st0">&quot;:cur_price&quot;</span>, average_price_factor<span class="br0">&#41;</span>,
              <span class="br0">&#40;</span>val_div, <span class="st0">&quot;:cur_price&quot;</span>, <span class="nu0">3</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,</pre></div></div>
<p>We probably still need to work on this a bit more (see the above trigger for raiders), but the basics are done.<br />
</p><p>__________________________________________<br />
The next big question we have to answer is: <b>What happens to the player, if he loses a battle and is captured?</b><br />
This is handled in game_menus:<br />
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1">  <span class="br0">&#40;</span>
    <span class="st0">&quot;captivity_wilderness_taken_prisoner&quot;</span>,mnf_scale_picture, <span class="co1">#Seafaring added</span>
    <span class="st0">&quot;Your enemies take you prisoner.&quot;</span>,
    <span class="st0">&quot;none&quot;</span>,
    <span class="br0">&#91;</span>	<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_current_terrain, <span class="st0">&quot;:terrain&quot;</span>, <span class="st0">&quot;$capturer_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>neq, <span class="st0">&quot;:terrain&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>set_background_mesh, <span class="st0">&quot;mesh_pic_prisoner_wilderness&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
     <span class="br0">&#93;</span>,
    <span class="br0">&#91;</span>
      <span class="br0">&#40;</span><span class="st0">&quot;continue&quot;</span>,<span class="br0">&#91;</span><span class="br0">&#93;</span>,<span class="st0">&quot;Continue...&quot;</span>,
       <span class="br0">&#91;</span>
         <span class="br0">&#40;</span>try_for_range, <span class="st0">&quot;:npc&quot;</span>, companions_begin, companions_end<span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>main_party_has_troop, <span class="st0">&quot;:npc&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>store_random_in_range, <span class="st0">&quot;:rand&quot;</span>, <span class="nu0">0</span>, <span class="nu0">100</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>lt, <span class="st0">&quot;:rand&quot;</span>, <span class="nu0">30</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>remove_member_from_party, <span class="st0">&quot;:npc&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>troop_set_slot, <span class="st0">&quot;:npc&quot;</span>, slot_troop_occupation, <span class="nu0">0</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>troop_set_slot, <span class="st0">&quot;:npc&quot;</span>, slot_troop_playerparty_history, pp_history_scattered<span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>assign, <span class="st0">&quot;$last_lost_companion&quot;</span>, <span class="st0">&quot;:npc&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>store_faction_of_party, <span class="st0">&quot;:victorious_faction&quot;</span>, <span class="st0">&quot;$g_encountered_party&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>troop_set_slot, <span class="st0">&quot;:npc&quot;</span>, slot_troop_playerparty_history_string, <span class="st0">&quot;:victorious_faction&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>troop_set_health, <span class="st0">&quot;:npc&quot;</span>, <span class="nu0">100</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>store_random_in_range, <span class="st0">&quot;:rand_town&quot;</span>, towns_begin, towns_end<span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>troop_set_slot, <span class="st0">&quot;:npc&quot;</span>, slot_troop_cur_center, <span class="st0">&quot;:rand_town&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>assign, <span class="st0">&quot;:nearest_town_dist&quot;</span>, <span class="nu0">1000</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>try_for_range, <span class="st0">&quot;:town_no&quot;</span>, towns_begin, towns_end<span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>store_faction_of_party, <span class="st0">&quot;:town_fac&quot;</span>, <span class="st0">&quot;:town_no&quot;</span><span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>store_relation, <span class="st0">&quot;:reln&quot;</span>, <span class="st0">&quot;:town_fac&quot;</span>, <span class="st0">&quot;fac_player_faction&quot;</span><span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>ge, <span class="st0">&quot;:reln&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>store_distance_to_party_from_party, <span class="st0">&quot;:dist&quot;</span>, <span class="st0">&quot;:town_no&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>lt, <span class="st0">&quot;:dist&quot;</span>, <span class="st0">&quot;:nearest_town_dist&quot;</span><span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>assign, <span class="st0">&quot;:nearest_town_dist&quot;</span>, <span class="st0">&quot;:dist&quot;</span><span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>troop_set_slot, <span class="st0">&quot;:npc&quot;</span>, slot_troop_cur_center, <span class="st0">&quot;:town_no&quot;</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
&#160;
		 <span class="br0">&#40;</span>try_for_parties, <span class="st0">&quot;:party_no&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_slot_eq, <span class="st0">&quot;:party_no&quot;</span>, slot_ship_center, ship_player_sailing<span class="br0">&#41;</span>, <span class="co1">#Removes the ship that was used by the player, when he lost a battle at sea.</span>
			<span class="br0">&#40;</span>remove_party, <span class="st0">&quot;:party_no&quot;</span><span class="br0">&#41;</span>,
		 <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
&#160;
         <span class="br0">&#40;</span>set_camera_follow_party, <span class="st0">&quot;$capturer_party&quot;</span><span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_is_captive&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>store_random_in_range, <span class="st0">&quot;:random_hours&quot;</span>, <span class="nu0">18</span>, <span class="nu0">30</span><span class="br0">&#41;</span>,         
         <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_event_player_captured_as_prisoner&quot;</span><span class="br0">&#41;</span>,
		 <span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_stay_captive_for_hours&quot;</span>, <span class="st0">&quot;:random_hours&quot;</span><span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>assign,<span class="st0">&quot;$auto_menu&quot;</span>,<span class="st0">&quot;mnu_captivity_wilderness_check&quot;</span><span class="br0">&#41;</span>,  <span class="co1">#Floris Escape Sea</span>
         <span class="br0">&#40;</span>change_screen_return<span class="br0">&#41;</span>,
         <span class="br0">&#93;</span><span class="br0">&#41;</span>,
      <span class="br0">&#93;</span>
  <span class="br0">&#41;</span>,
&#160;
&#160;
  <span class="br0">&#40;</span>
    <span class="st0">&quot;captivity_wilderness_check&quot;</span>,<span class="nu0">0</span>,
    <span class="st0">&quot;stub&quot;</span>,
    <span class="st0">&quot;none&quot;</span>,
    <span class="br0">&#91;</span>	<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_current_terrain, <span class="st0">&quot;:terrain&quot;</span>, <span class="st0">&quot;$capturer_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>eq, <span class="st0">&quot;:terrain&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>assign, reg1, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>party_get_position, pos1, <span class="st0">&quot;$capturer_party&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>map_get_land_position_around_position, pos2, pos1, <span class="nu0">5</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>position_get_x, <span class="st0">&quot;:coo_x&quot;</span>, pos2<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>position_get_y, <span class="st0">&quot;:coo_y&quot;</span>, pos2<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>le, <span class="st0">&quot;:coo_x&quot;</span>, -<span class="nu0">134</span><span class="br0">&#41;</span>,   <span class="co1">#Making sure the player is not freed on the northwestern isle </span>
					<span class="br0">&#40;</span>ge, <span class="st0">&quot;:coo_y&quot;</span>, <span class="nu0">116</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>assign, reg1, <span class="nu0">1</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>le, <span class="st0">&quot;:coo_x&quot;</span>, -<span class="nu0">100</span><span class="br0">&#41;</span>,   <span class="co1">#Making sure the player is not freed on the southwestern isle</span>
					<span class="br0">&#40;</span>le, <span class="st0">&quot;:coo_y&quot;</span>, <span class="nu0">103</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>assign, reg1, <span class="nu0">1</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>eq, reg1, <span class="nu0">0</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>jump_to_menu, <span class="st0">&quot;mnu_captivity_end_sea_escape&quot;</span><span class="br0">&#41;</span>, <span class="co1">#Starts seafaring flee menu</span>
			<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_stay_captive_for_hours&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>assign,<span class="st0">&quot;$auto_menu&quot;</span>,<span class="st0">&quot;mnu_captivity_wilderness_check&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>change_screen_return<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>jump_to_menu,<span class="st0">&quot;mnu_captivity_end_wilderness_escape&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span><span class="br0">&#93;</span>,  
    <span class="br0">&#91;</span><span class="br0">&#93;</span>
  <span class="br0">&#41;</span>,
&#160;
   <span class="br0">&#40;</span>
    <span class="st0">&quot;captivity_end_sea_escape&quot;</span>, mnf_scale_picture,
    <span class="st0">&quot;After painful days of being dragged about as a prisoner, you find a chance and escape from your captors!&quot;</span>, <span class="co1">#Flee</span>
    <span class="st0">&quot;none&quot;</span>,
    <span class="br0">&#91;</span>
        <span class="br0">&#40;</span>play_cue_track, <span class="st0">&quot;track_empty_village&quot;</span><span class="br0">&#41;</span>,
    <span class="br0">&#93;</span>,
    <span class="br0">&#91;</span>
      <span class="br0">&#40;</span><span class="st0">&quot;continue&quot;</span>,<span class="br0">&#91;</span><span class="br0">&#93;</span>,<span class="st0">&quot;Continue...&quot;</span>,
       <span class="br0">&#91;</span>
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_is_captive&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_normal<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_flags, <span class="st0">&quot;p_main_party&quot;</span>, pf_is_ship, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>party_is_active, <span class="st0">&quot;$capturer_party&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>party_set_position, <span class="st0">&quot;p_main_party&quot;</span>, pos2<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_set_parties_around_player_ignore_player&quot;</span>, <span class="nu0">2</span>, <span class="nu0">4</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_normal<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>set_camera_follow_party, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>rest_for_hours, <span class="nu0">0</span>, <span class="nu0">0</span>, <span class="nu0">0</span><span class="br0">&#41;</span>, <span class="co1">#stop resting</span>
           <span class="co1">##diplomacy begin</span>
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_move_fast&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
           <span class="co1">##diplomacy end</span>
			<span class="br0">&#40;</span>change_screen_return<span class="br0">&#41;</span>,
        <span class="br0">&#93;</span><span class="br0">&#41;</span>,
    <span class="br0">&#93;</span>
  <span class="br0">&#41;</span>,</pre></div></div>
<p>Its been a while since i wrote this part, so i hope i included all of it:<br />
</p>
<ul><li> Added check for a mesh that didnt fit with seafaring
</li><li> Remove the ship party from the game, when the player is defeated
</li><li> Made sure the player isnt released on any isles w/o a way back to the main land 
</li><li> The raider party has to be no further away then 5 from land. (Not sure what kind of measurement unit the game uses.)<br />
</li></ul>
<p><br />
Credits for this part go to:
</p>
<ul><li> Ruthven
</li><li> Caba
</li><li> Duh
</li></ul>
<p>__________________________________________<br />
</p><p><b><big>Seafaring</big></b><br />
<br />
To give you an overview:<br />
<img src="http://img192.imageshack.us/img192/4936/scannen0001pb.jpg" alt="scannen0001pb.jpg" /><br />
</p><p><br />
Lets start by adding the necessary constants:
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1">slot_town_has_ship = <span class="nu0">450</span>
&#160;
slot_ship_center = <span class="nu0">451</span>
&#160;
slot_ship_choice = <span class="nu0">452</span>
&#160;
slot_ship_time = <span class="nu0">453</span>
&#160;
ship_wild_no_guard = <span class="nu0">100</span>
ship_wild_guarded = <span class="nu0">150</span>
ship_player_sailing = <span class="nu0">200</span></pre></div></div>
<p>and continue with adding a port menu, its submenus and presentation to the town_menu (see Floris 2.5 source [once its released] for exact location):
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1"><span class="co1">#Floris Port Menu</span>
&#160;
<span class="br0">&#40;</span>
   <span class="st0">&quot;port&quot;</span>,<span class="nu0">0</span>,
    <span class="st0">&quot;You visit the port of {s1}.<span class="es0">\</span>
 While you look around you feel the strong wind from the ocean pulling on your cloth.<span class="es0">\</span>
 Many ships are anchored here and you notice the crews are already loading them with native goods, while a group of men is still discharging their cargos.<span class="es0">\</span>
 One of them seems to be in charge of the harbor, so you walk up to them and ask him for help.<span class="es0">\</span>
 He looks at you and says: What do you want lad? Dont ya see that i am busy?&quot;</span>,
    <span class="st0">&quot;none&quot;</span>,
    <span class="br0">&#91;</span>
	<span class="co1">#(set_background_mesh,&quot;mesh_pic_port1_floris&quot;), only use this if you have the according mesh/this is a Floris specific artwork</span>
    <span class="br0">&#40;</span>str_store_party_name,s1,<span class="st0">&quot;$current_town&quot;</span><span class="br0">&#41;</span>,
	<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>eq, <span class="st0">&quot;$crew_screen_state&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>change_screen_exchange_members, <span class="nu0">0</span>, <span class="st0">&quot;$ship&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>assign, <span class="st0">&quot;$crew_screen_state&quot;</span>, <span class="nu0">2</span><span class="br0">&#41;</span>,
	<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,	
		<span class="br0">&#40;</span>eq, <span class="st0">&quot;$crew_screen_state&quot;</span>, <span class="nu0">2</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>assign, <span class="st0">&quot;$crew_screen_state&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>start_presentation, <span class="st0">&quot;prsnt_manage_ships&quot;</span><span class="br0">&#41;</span>,
	<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>eq, <span class="st0">&quot;$crew_screen_state&quot;</span>, <span class="nu0">3</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>jump_to_menu, <span class="st0">&quot;mnu_ship_notes&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>assign, <span class="st0">&quot;$crew_screen_state&quot;</span>, <span class="nu0">2</span><span class="br0">&#41;</span>,
	<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
    <span class="br0">&#93;</span>,
    <span class="br0">&#91;</span>
	<span class="co1">#Floris buy a ship</span>
&#160;
	<span class="br0">&#40;</span><span class="st0">&quot;Buy_a_ship&quot;</span>,
	<span class="br0">&#91;</span><span class="br0">&#93;</span>,
	<span class="st0">&quot;Purchase a ship (50000 denars)&quot;</span>,
    <span class="br0">&#91;</span>
	<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:num_ships&quot;</span>, <span class="st0">&quot;$current_town&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>le, <span class="st0">&quot;:num_ships&quot;</span>, <span class="nu0">4</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>store_troop_gold,<span class="st0">&quot;:money&quot;</span>,<span class="st0">&quot;trp_player&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>ge,<span class="st0">&quot;:money&quot;</span>,<span class="nu0">50000</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>troop_remove_gold,<span class="st0">&quot;trp_player&quot;</span>,<span class="nu0">50000</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>val_add, <span class="st0">&quot;:num_ships&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,		
		<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;$current_town&quot;</span>, slot_town_has_ship, <span class="st0">&quot;:num_ships&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>set_spawn_radius, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>spawn_around_party, <span class="st0">&quot;$current_town&quot;</span>, <span class="st0">&quot;pt_ship&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;:new_ship&quot;</span>, reg0<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:new_ship&quot;</span>, slot_party_type, spt_ship<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:new_ship&quot;</span>, slot_ship_center, <span class="st0">&quot;$current_town&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>assign, reg6, <span class="st0">&quot;:new_ship&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>display_message,<span class="st0">&quot;@You now own a ship and can disembark from this town.&quot;</span><span class="br0">&#41;</span>,
	<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_slot_ge, <span class="st0">&quot;$current_town&quot;</span>, slot_town_has_ship, <span class="nu0">5</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>display_message, <span class="st0">&quot;@There is no room for any further ships in this harbor.&quot;</span><span class="br0">&#41;</span>,
	<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,		
		<span class="br0">&#40;</span>display_message,<span class="st0">&quot;@You don't have enough money to buy a ship.&quot;</span><span class="br0">&#41;</span>,
	<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
	<span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
<span class="co1">#Wulf + Floris begin</span>
	<span class="br0">&#40;</span><span class="st0">&quot;sail_from_port&quot;</span>,
	<span class="br0">&#91;</span><span class="br0">&#93;</span>, <span class="st0">&quot;Set sail with your ship.(Min. crew 30, Max 90)&quot;</span>,
	<span class="br0">&#91;</span>
	<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_slot_eq, <span class="st0">&quot;$current_town&quot;</span>, slot_town_has_ship, <span class="nu0">1</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>assign, <span class="st0">&quot;:break&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_for_parties, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
		    <span class="br0">&#40;</span>eq, <span class="st0">&quot;:break&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
		    <span class="br0">&#40;</span>party_slot_eq, <span class="st0">&quot;:ship_no&quot;</span>, slot_party_type, spt_ship<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_slot_eq, <span class="st0">&quot;:ship_no&quot;</span>, slot_ship_center, <span class="st0">&quot;$current_town&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_num_companions, reg6, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_num_companions, reg7, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>val_add, reg7, reg6<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>is_between, reg7, <span class="nu0">30</span>, <span class="nu0">91</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:ship_no&quot;</span>, slot_ship_center, ship_player_sailing<span class="br0">&#41;</span>, <span class="co1">#Represents the player</span>
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party&quot;</span>, slot_town_has_ship, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>, <span class="co1">#Records that the Player Party has this ship</span>
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;:break&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,	
        <span class="br0">&#40;</span>eq, <span class="st0">&quot;:break&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,			
		<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;$current_town&quot;</span>, slot_town_has_ship, <span class="nu0">0</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_ship<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_set_flags, <span class="st0">&quot;p_main_party&quot;</span>, pf_is_ship, <span class="nu0">1</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_get_position, pos1, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:dist&quot;</span>, <span class="st0">&quot;$current_town&quot;</span>, slot_town_is_coastal<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>val_add, <span class="st0">&quot;:dist&quot;</span>, <span class="nu0">2</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>map_get_water_position_around_position, pos2, pos1, <span class="st0">&quot;:dist&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_set_position, <span class="st0">&quot;p_main_party&quot;</span>, pos2<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_main_ship_party&quot;</span>, -<span class="nu0">1</span><span class="br0">&#41;</span>,  <span class="co1">#CABA - might also store the ship party ID here??</span>
		<span class="br0">&#40;</span>change_screen_return<span class="br0">&#41;</span>,
	<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_slot_ge, <span class="st0">&quot;$current_town&quot;</span>, slot_town_has_ship, <span class="nu0">2</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>jump_to_menu, <span class="st0">&quot;mnu_choose_ship&quot;</span><span class="br0">&#41;</span>, <span class="co1">#CABA--move this to a presentation?</span>
	<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>display_message,<span class="st0">&quot;@You don't own a ship or your your crew exceeds the boundaries.&quot;</span><span class="br0">&#41;</span>,
	<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
    <span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
	<span class="br0">&#40;</span><span class="st0">&quot;manage_ships&quot;</span>,
	<span class="br0">&#91;</span><span class="br0">&#93;</span>,
	<span class="st0">&quot;Manage ships.&quot;</span>,
	<span class="br0">&#91;</span>	<span class="br0">&#40;</span>assign, reg6, -<span class="nu0">1</span><span class="br0">&#41;</span>,
	    <span class="br0">&#40;</span>assign, reg8, -<span class="nu0">1</span><span class="br0">&#41;</span>,
	    <span class="br0">&#40;</span>str_clear, s11<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>str_clear, s12<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>str_clear, s14<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>start_presentation, <span class="st0">&quot;prsnt_manage_ships&quot;</span><span class="br0">&#41;</span>,
	<span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
	<span class="br0">&#40;</span><span class="st0">&quot;View_notes&quot;</span>,
	<span class="br0">&#91;</span><span class="br0">&#93;</span>,
	<span class="st0">&quot;View the ship registry.&quot;</span>,
	<span class="br0">&#91;</span><span class="br0">&#40;</span>jump_to_menu, <span class="st0">&quot;mnu_ship_notes&quot;</span><span class="br0">&#41;</span>,
	<span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
    <span class="br0">&#40;</span><span class="st0">&quot;back_to_town_menu&quot;</span>,
	<span class="br0">&#91;</span><span class="br0">&#93;</span>,
	<span class="st0">&quot;Head back.&quot;</span>,
    <span class="br0">&#91;</span><span class="br0">&#40;</span>jump_to_menu,<span class="st0">&quot;mnu_town&quot;</span><span class="br0">&#41;</span>,
    <span class="br0">&#93;</span><span class="br0">&#41;</span>,
	<span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
<span class="co1">#Floris ship notes</span>
&#160;
<span class="br0">&#40;</span>
	<span class="st0">&quot;Ship_notes&quot;</span>,<span class="nu0">0</span>,
    <span class="st0">&quot;The royal trade guild keeps track of all ships in harbor towns. Viewing their registry will tell you where your ships are.^{s3}&quot;</span>,
	<span class="st0">&quot;none&quot;</span>,
	<span class="br0">&#91;</span>	<span class="br0">&#40;</span>str_clear, s3<span class="br0">&#41;</span>,
	    <span class="br0">&#40;</span>try_for_range, <span class="st0">&quot;:town_no&quot;</span>, towns_begin, towns_end<span class="br0">&#41;</span>,
		    <span class="br0">&#40;</span>party_slot_ge, <span class="st0">&quot;:town_no&quot;</span>, slot_town_is_coastal, <span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_slot, reg1, <span class="st0">&quot;:town_no&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>str_store_party_name, s2, <span class="st0">&quot;:town_no&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>str_store_string, s3, <span class="st0">&quot;@{s3}^You have {reg1} ships in {s2}.&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
	<span class="br0">&#93;</span>,
	<span class="br0">&#91;</span>
	   <span class="br0">&#40;</span><span class="st0">&quot;back_to_town_menu&quot;</span>,<span class="br0">&#91;</span><span class="br0">&#93;</span>,<span class="st0">&quot;Head back.&quot;</span>,
       <span class="br0">&#91;</span>
       <span class="br0">&#40;</span>jump_to_menu,<span class="st0">&quot;mnu_port&quot;</span><span class="br0">&#41;</span>,
       <span class="br0">&#93;</span><span class="br0">&#41;</span>,
	<span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
<span class="br0">&#40;</span>
	<span class="st0">&quot;choose_ship&quot;</span>,<span class="nu0">0</span>,
    <span class="st0">&quot;The following list contains all the ships anchored in this town. Select one to set sail, but make sure your crew meets the requirements.&quot;</span>,
&#160;
	<span class="st0">&quot;none&quot;</span>,
	<span class="br0">&#91;</span>	<span class="br0">&#40;</span>assign, reg1, <span class="nu0">0</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>assign, reg2, <span class="nu0">0</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>assign, reg3, <span class="nu0">0</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>assign, reg4, <span class="nu0">0</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>assign, reg5, <span class="nu0">0</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_for_parties, <span class="st0">&quot;:ship_no&quot;</span>,<span class="br0">&#41;</span>,
		    <span class="br0">&#40;</span>party_slot_eq, <span class="st0">&quot;:ship_no&quot;</span>, slot_party_type, spt_ship<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_slot_eq, <span class="st0">&quot;:ship_no&quot;</span>, slot_ship_center, <span class="st0">&quot;$current_town&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>eq, reg1, <span class="nu0">0</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>assign, reg1, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>eq, reg2, <span class="nu0">0</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>assign, reg2, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>eq, reg3, <span class="nu0">0</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>assign, reg3, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>eq, reg4, <span class="nu0">0</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>assign, reg4, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>eq, reg5, <span class="nu0">0</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>assign, reg5, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,	
	<span class="br0">&#93;</span>,
	<span class="br0">&#91;</span>
		<span class="br0">&#40;</span><span class="st0">&quot;ship_1&quot;</span>,<span class="br0">&#91;</span>
		    <span class="br0">&#40;</span>neq, reg1, <span class="nu0">0</span><span class="br0">&#41;</span>,
		    <span class="br0">&#40;</span>str_store_party_name, s1, reg1<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>str_store_string, s1, <span class="st0">&quot;@Choose {s1}&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#93;</span>,<span class="st0">&quot;{s1}&quot;</span>,
		<span class="br0">&#91;</span>
		<span class="br0">&#40;</span>assign, <span class="st0">&quot;:ship_no&quot;</span>, reg1<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_num_companions, reg6, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>is_between, reg6, <span class="nu0">30</span>, <span class="nu0">91</span><span class="br0">&#41;</span>,				
			<span class="br0">&#40;</span>party_get_num_companions, reg7, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>val_add, reg7, reg6<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>is_between, reg7, <span class="nu0">30</span>, <span class="nu0">91</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:num_ships&quot;</span>, <span class="st0">&quot;$current_town&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>val_sub, <span class="st0">&quot;:num_ships&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;$current_town&quot;</span>, slot_town_has_ship, <span class="st0">&quot;:num_ships&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:ship_no&quot;</span>, slot_ship_center, ship_player_sailing<span class="br0">&#41;</span>, <span class="co1">#Player uses ship</span>
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party&quot;</span>, slot_town_has_ship, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>, <span class="co1">#Player tracking</span>
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_ship<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_flags, <span class="st0">&quot;p_main_party&quot;</span>, pf_is_ship, <span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_position, pos1, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>map_get_water_position_around_position, pos2, pos1, <span class="nu0">6</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_position, <span class="st0">&quot;p_main_party&quot;</span>, pos2<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_main_ship_party&quot;</span>, -<span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>change_screen_return<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>display_message,<span class="st0">&quot;@Your crew is either too small or too large.&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,	
		<span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
		<span class="br0">&#40;</span><span class="st0">&quot;ship_2&quot;</span>,<span class="br0">&#91;</span>
		    <span class="br0">&#40;</span>neq, reg2, <span class="nu0">0</span><span class="br0">&#41;</span>,
		    <span class="br0">&#40;</span>str_store_party_name, s1, reg2<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>str_store_string, s1, <span class="st0">&quot;@Choose {s1}&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#93;</span>,<span class="st0">&quot;{s1}&quot;</span>,
		<span class="br0">&#91;</span>
		<span class="br0">&#40;</span>assign, <span class="st0">&quot;:ship_no&quot;</span>, reg2<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_num_companions, reg6, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>is_between, reg6, <span class="nu0">30</span>, <span class="nu0">91</span><span class="br0">&#41;</span>,				
			<span class="br0">&#40;</span>party_get_num_companions, reg7, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>val_add, reg7, reg6<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>is_between, reg7, <span class="nu0">30</span>, <span class="nu0">91</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:num_ships&quot;</span>, <span class="st0">&quot;$current_town&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>val_sub, <span class="st0">&quot;:num_ships&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;$current_town&quot;</span>, slot_town_has_ship, <span class="st0">&quot;:num_ships&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:ship_no&quot;</span>, slot_ship_center, ship_player_sailing<span class="br0">&#41;</span>, <span class="co1">#Player uses ship</span>
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party&quot;</span>, slot_town_has_ship, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>, <span class="co1">#Player tracking</span>
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_ship<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_flags, <span class="st0">&quot;p_main_party&quot;</span>, pf_is_ship, <span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_position, pos1, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>map_get_water_position_around_position, pos2, pos1, <span class="nu0">6</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_position, <span class="st0">&quot;p_main_party&quot;</span>, pos2<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_main_ship_party&quot;</span>, -<span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>change_screen_return<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>display_message,<span class="st0">&quot;@Your crew is either too small or too large.&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,		
		<span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
		<span class="br0">&#40;</span><span class="st0">&quot;ship_3&quot;</span>,<span class="br0">&#91;</span>
		    <span class="br0">&#40;</span>neq, reg3, <span class="nu0">0</span><span class="br0">&#41;</span>,
		    <span class="br0">&#40;</span>str_store_party_name, s1, reg3<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>str_store_string, s1, <span class="st0">&quot;@Choose {s1}&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#93;</span>,<span class="st0">&quot;{s1}&quot;</span>,
		<span class="br0">&#91;</span>
		<span class="br0">&#40;</span>assign, <span class="st0">&quot;:ship_no&quot;</span>, reg3<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_num_companions, reg6, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>is_between, reg6, <span class="nu0">30</span>, <span class="nu0">91</span><span class="br0">&#41;</span>,				
			<span class="br0">&#40;</span>party_get_num_companions, reg7, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>val_add, reg7, reg6<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>is_between, reg7, <span class="nu0">30</span>, <span class="nu0">91</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:num_ships&quot;</span>, <span class="st0">&quot;$current_town&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>val_sub, <span class="st0">&quot;:num_ships&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;$current_town&quot;</span>, slot_town_has_ship, <span class="st0">&quot;:num_ships&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:ship_no&quot;</span>, slot_ship_center, ship_player_sailing<span class="br0">&#41;</span>, <span class="co1">#Player uses ship</span>
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party&quot;</span>, slot_town_has_ship, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>, <span class="co1">#Player tracking</span>
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_ship<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_flags, <span class="st0">&quot;p_main_party&quot;</span>, pf_is_ship, <span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_position, pos1, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>map_get_water_position_around_position, pos2, pos1, <span class="nu0">6</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_position, <span class="st0">&quot;p_main_party&quot;</span>, pos2<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_main_ship_party&quot;</span>, -<span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>change_screen_return<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>display_message,<span class="st0">&quot;@Your crew is either too small or too large.&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,	
		<span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
		<span class="br0">&#40;</span><span class="st0">&quot;ship_4&quot;</span>,<span class="br0">&#91;</span>
		    <span class="br0">&#40;</span>neq, reg4, <span class="nu0">0</span><span class="br0">&#41;</span>,
		    <span class="br0">&#40;</span>str_store_party_name, s1, reg4<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>str_store_string, s1, <span class="st0">&quot;@Choose {s1}&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#93;</span>,<span class="st0">&quot;{s1}&quot;</span>,
		<span class="br0">&#91;</span>
		<span class="br0">&#40;</span>assign, <span class="st0">&quot;:ship_no&quot;</span>, reg4<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_num_companions, reg6, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>is_between, reg6, <span class="nu0">30</span>, <span class="nu0">91</span><span class="br0">&#41;</span>,				
			<span class="br0">&#40;</span>party_get_num_companions, reg7, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>val_add, reg7, reg6<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>is_between, reg7, <span class="nu0">30</span>, <span class="nu0">91</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:num_ships&quot;</span>, <span class="st0">&quot;$current_town&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>val_sub, <span class="st0">&quot;:num_ships&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;$current_town&quot;</span>, slot_town_has_ship, <span class="st0">&quot;:num_ships&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:ship_no&quot;</span>, slot_ship_center, ship_player_sailing<span class="br0">&#41;</span>, <span class="co1">#Player uses ship</span>
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party&quot;</span>, slot_town_has_ship, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>, <span class="co1">#Player tracking</span>
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_ship<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_flags, <span class="st0">&quot;p_main_party&quot;</span>, pf_is_ship, <span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_position, pos1, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>map_get_water_position_around_position, pos2, pos1, <span class="nu0">6</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_position, <span class="st0">&quot;p_main_party&quot;</span>, pos2<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_main_ship_party&quot;</span>, -<span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>change_screen_return<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>display_message,<span class="st0">&quot;@Your crew is either too small or too large.&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,	
		<span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
		<span class="br0">&#40;</span><span class="st0">&quot;ship_5&quot;</span>,<span class="br0">&#91;</span>
		    <span class="br0">&#40;</span>neq, reg5, <span class="nu0">0</span><span class="br0">&#41;</span>,
		    <span class="br0">&#40;</span>str_store_party_name, s1, reg5<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>str_store_string, s1, <span class="st0">&quot;@Choose {s1}&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#93;</span>,<span class="st0">&quot;{s1}&quot;</span>,
		<span class="br0">&#91;</span>
		<span class="br0">&#40;</span>assign, <span class="st0">&quot;:ship_no&quot;</span>, reg5<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_num_companions, reg6, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>is_between, reg6, <span class="nu0">30</span>, <span class="nu0">91</span><span class="br0">&#41;</span>,				
			<span class="br0">&#40;</span>party_get_num_companions, reg7, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>val_add, reg7, reg6<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>is_between, reg7, <span class="nu0">30</span>, <span class="nu0">91</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:num_ships&quot;</span>, <span class="st0">&quot;$current_town&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>val_sub, <span class="st0">&quot;:num_ships&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;$current_town&quot;</span>, slot_town_has_ship, <span class="st0">&quot;:num_ships&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:ship_no&quot;</span>, slot_ship_center, ship_player_sailing<span class="br0">&#41;</span>, <span class="co1">#Player uses ship</span>
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party&quot;</span>, slot_town_has_ship, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>, <span class="co1">#Player tracking</span>
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_ship<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_flags, <span class="st0">&quot;p_main_party&quot;</span>, pf_is_ship, <span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_position, pos1, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>map_get_water_position_around_position, pos2, pos1, <span class="nu0">6</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_position, <span class="st0">&quot;p_main_party&quot;</span>, pos2<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_main_ship_party&quot;</span>, -<span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>change_screen_return<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>display_message,<span class="st0">&quot;@Your crew is either too small or too large.&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,		
		<span class="br0">&#93;</span><span class="br0">&#41;</span>,	
&#160;
	   <span class="br0">&#40;</span><span class="st0">&quot;back_to_town_menu&quot;</span>,<span class="br0">&#91;</span><span class="br0">&#93;</span>,<span class="st0">&quot;Head back.&quot;</span>,
       <span class="br0">&#91;</span>
       <span class="br0">&#40;</span>jump_to_menu,<span class="st0">&quot;mnu_port&quot;</span><span class="br0">&#41;</span>,
       <span class="br0">&#93;</span><span class="br0">&#41;</span>,
	<span class="br0">&#93;</span><span class="br0">&#41;</span>,	
&#160;
&#160;
<span class="co1">#Floris End</span></pre></div></div>
<p>And the according presenation in presentations.py:
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1"><span class="co1">##Floris Sea Trade - Name your ship</span>
&#160;
<span class="br0">&#40;</span><span class="st0">&quot;manage_ships&quot;</span>, <span class="nu0">0</span>, mesh_load_window, <span class="br0">&#91;</span> <span class="co1">#Ultra Important#</span>
    <span class="br0">&#40;</span>ti_on_presentation_load,
      <span class="br0">&#91;</span>
        <span class="br0">&#40;</span>presentation_set_duration, <span class="nu0">999999</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>set_fixed_point_multiplier, <span class="nu0">1000</span><span class="br0">&#41;</span>,
&#160;
		<span class="br0">&#40;</span>str_clear, s0<span class="br0">&#41;</span>, <span class="co1">#just in case</span>
		<span class="br0">&#40;</span>try_for_range, <span class="st0">&quot;:i&quot;</span>, <span class="nu0">0</span>, <span class="nu0">100</span><span class="br0">&#41;</span>, <span class="co1">#be sure the temp slots are empty</span>
		    <span class="br0">&#40;</span>troop_set_slot, <span class="st0">&quot;trp_temp_array_a&quot;</span>, <span class="st0">&quot;:i&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>troop_set_slot, <span class="st0">&quot;trp_temp_array_b&quot;</span>, <span class="st0">&quot;:i&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
&#160;
		<span class="br0">&#40;</span>create_text_overlay, reg0, <span class="st0">&quot;@Manage Ship&quot;</span>, tf_center_justify<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_x, pos1, <span class="nu0">500</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_y, pos1, <span class="nu0">680</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>overlay_set_position, reg0, pos1<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>position_set_x, pos1, <span class="nu0">1500</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_y, pos1, <span class="nu0">1500</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>overlay_set_size, reg0, pos1<span class="br0">&#41;</span>,
&#160;
		<span class="br0">&#40;</span>str_store_string, s11, <span class="st0">&quot;@{s12}<span class="es0">\</span>
Cogs are large sailing ships with their bows and sterns built at a higher level than the rest of the ship in order to form a castle like structure,<span class="es0">\</span>
which is used to defend the ship from enemies using archers. The Cog was the first type of boat that used the new idea of a rudder mounted on the stern<span class="es0">\</span>
for steering purpose. However as this is still a rather new idea, many cogs are still equipped with steering oars, which were also known as side rudders.<span class="es0">\</span>
The early cogs, weren't very large and had open hulls which didnt offer much sailing capability.^^<span class="es0">\</span>
Nowadays the cogs are used for sailing through rough waters and their hull is made from clinker construction, which provides them with<span class="es0">\</span>
added strength and robustness. Their hulls also grew in size as they evolved into large cargo carriers.^^<span class="es0">\</span>
Cog are ships with flat bottoms. They have a ridge or keel that runs along the lower side of the ship. On both sides of the keel, there<span class="es0">\</span>
is lapstrake planking, firmly fixed by iron nails. The stern and stern posts are both straight in shape and attached to the keel plate<span class="es0">\</span>
by means of hooks. The plank of the keel is thicker than the lapstrake and planking at the sites and moreover, the stern mounted central<span class="es0">\</span>
rudder is an integral part of the cog construction. It is this design, that makes cogs more stable than any other type of ship.^^<span class="es0">\</span>
Generally built from oak wood, cogs have only a single long mast, which carries a massive square sail. The size of the sail depends <span class="es0">\</span>
on the size of the hull. This means that as the size of cog hull became bigger, the size of sails also increased. The only drawback of this construction<span class="es0">\</span>
was that it prevented sailing directly into the wind. However it facilitated the yacht so far, that it could be handled by a small crew,<span class="es0">\</span>
reducing the overall operational cost.&quot;</span><span class="br0">&#41;</span>,
&#160;
		<span class="br0">&#40;</span>create_text_overlay, reg0, s11, tf_double_space|tf_scrollable<span class="br0">&#41;</span>,  <span class="co1">##Describes the ship</span>
        <span class="br0">&#40;</span>position_set_x, pos1, <span class="nu0">400</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_y, pos1, <span class="nu0">80</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>overlay_set_position, reg0, pos1<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_x, pos1, <span class="nu0">550</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_y, pos1, <span class="nu0">500</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>overlay_set_area_size, reg0, pos1<span class="br0">&#41;</span>,
&#160;
&#160;
        <span class="br0">&#40;</span>create_text_overlay, reg0, <span class="st0">&quot;@Select ship:&quot;</span>, tf_center_justify<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_x, pos1, <span class="nu0">150</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_y, pos1, <span class="nu0">550</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>overlay_set_position, reg0, pos1<span class="br0">&#41;</span>,
&#160;
		<span class="br0">&#40;</span>position_set_x, pos1, <span class="nu0">160</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>position_set_y, pos1, <span class="nu0">510</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>create_combo_button_overlay, <span class="st0">&quot;$g_presentation_obj_11&quot;</span><span class="br0">&#41;</span>,	<span class="co1">#Combo Button for ships</span>
        <span class="br0">&#40;</span>overlay_set_position, <span class="st0">&quot;$g_presentation_obj_11&quot;</span>, pos1<span class="br0">&#41;</span>,
&#160;
		<span class="br0">&#40;</span>assign, <span class="st0">&quot;:slot&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_for_parties, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_slot_eq, <span class="st0">&quot;:ship_no&quot;</span>, slot_ship_center, <span class="st0">&quot;$current_town&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>str_store_party_name, s1, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>overlay_add_item, <span class="st0">&quot;$g_presentation_obj_11&quot;</span>, s1<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>overlay_set_val, <span class="st0">&quot;$g_presentation_obj_11&quot;</span>, reg6<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>troop_set_slot, <span class="st0">&quot;trp_temp_array_a&quot;</span>, <span class="st0">&quot;:slot&quot;</span>, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>, <span class="co1">#this way the troop slot # = overlay combo box index #</span>
			<span class="br0">&#40;</span>val_add, <span class="st0">&quot;:slot&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
&#160;
	    <span class="br0">&#40;</span>create_text_overlay, reg0, <span class="st0">&quot;@Name your ship:&quot;</span>, tf_center_justify<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_x, pos1, <span class="nu0">150</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_y, pos1, <span class="nu0">475</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>overlay_set_position, reg0, pos1<span class="br0">&#41;</span>,
&#160;
		<span class="br0">&#40;</span>create_simple_text_box_overlay, <span class="st0">&quot;$g_presentation_obj_name_kingdom_1&quot;</span><span class="br0">&#41;</span>, <span class="co1">#Text box</span>
        <span class="br0">&#40;</span>position_set_x, pos1, <span class="nu0">50</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_y, pos1, <span class="nu0">440</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>overlay_set_position, <span class="st0">&quot;$g_presentation_obj_name_kingdom_1&quot;</span>, pos1<span class="br0">&#41;</span>,	
&#160;
        <span class="br0">&#40;</span>create_button_overlay, <span class="st0">&quot;$g_presentation_obj_13&quot;</span>, <span class="st0">&quot;@Rename Ship.&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_x, pos1, <span class="nu0">75</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_y, pos1, <span class="nu0">400</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>overlay_set_position, <span class="st0">&quot;$g_presentation_obj_13&quot;</span>, pos1<span class="br0">&#41;</span>,
&#160;
&#160;
		<span class="br0">&#40;</span>create_text_overlay, reg0, <span class="st0">&quot;@Send ship to port:&quot;</span>, tf_center_justify<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_x, pos1, <span class="nu0">150</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_y, pos1, <span class="nu0">250</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>overlay_set_position, reg0, pos1<span class="br0">&#41;</span>,
&#160;
		<span class="br0">&#40;</span>position_set_x, pos1, <span class="nu0">160</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>position_set_y, pos1, <span class="nu0">210</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>create_combo_button_overlay, <span class="st0">&quot;$g_presentation_obj_12&quot;</span><span class="br0">&#41;</span>,	<span class="co1">#Combo Button for ships</span>
        <span class="br0">&#40;</span>overlay_set_position, <span class="st0">&quot;$g_presentation_obj_12&quot;</span>, pos1<span class="br0">&#41;</span>,
&#160;
		<span class="br0">&#40;</span>assign, <span class="st0">&quot;:slot&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_for_range, <span class="st0">&quot;:town_no&quot;</span>, towns_begin, towns_end<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>neq, <span class="st0">&quot;:town_no&quot;</span>, <span class="st0">&quot;$current_town&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_slot_ge, <span class="st0">&quot;:town_no&quot;</span>, slot_town_is_coastal, <span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>store_faction_of_party, <span class="st0">&quot;:faction_1&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>store_faction_of_party, <span class="st0">&quot;:faction_2&quot;</span>, <span class="st0">&quot;:town_no&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>store_relation, <span class="st0">&quot;:relation&quot;</span>, <span class="st0">&quot;:faction_1&quot;</span>, <span class="st0">&quot;:faction_2&quot;</span><span class="br0">&#41;</span>, <span class="co1">#Cant send to enemy ports</span>
			<span class="br0">&#40;</span>ge, <span class="st0">&quot;:relation&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>str_store_party_name, s1, <span class="st0">&quot;:town_no&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>overlay_add_item, <span class="st0">&quot;$g_presentation_obj_12&quot;</span>, s1<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>troop_set_slot, <span class="st0">&quot;trp_temp_array_b&quot;</span>, <span class="st0">&quot;:slot&quot;</span>, <span class="st0">&quot;:town_no&quot;</span><span class="br0">&#41;</span>, <span class="co1">#this way the troop slot # = overlay combo box index #</span>
			<span class="br0">&#40;</span>val_add, <span class="st0">&quot;:slot&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,   	
&#160;
		<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>, 
         <span class="br0">&#40;</span>neq, reg6, -<span class="nu0">1</span><span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>overlay_set_val, <span class="st0">&quot;$g_presentation_obj_11&quot;</span>, reg6<span class="br0">&#41;</span>,
		 <span class="br0">&#40;</span>troop_get_slot, <span class="st0">&quot;:ship_no&quot;</span>, <span class="st0">&quot;trp_temp_array_a&quot;</span>, reg6<span class="br0">&#41;</span>,
		 <span class="br0">&#40;</span>str_store_party_name, s13, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>overlay_set_text, <span class="st0">&quot;$g_presentation_obj_name_kingdom_1&quot;</span>, s13<span class="br0">&#41;</span>,	
        <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,	
		<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>neq, reg8, -<span class="nu0">1</span><span class="br0">&#41;</span>,
         <span class="br0">&#40;</span>overlay_set_val, <span class="st0">&quot;$g_presentation_obj_12&quot;</span>, reg8<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,	
<span class="co1">##TO MAKE THIS WORK, add:</span>
<span class="co1"># (assign, reg6, -1),</span>
<span class="co1"># (assign, reg8, -1),</span>
<span class="co1">##right before the presentation call in the menu		</span>
&#160;
&#160;
		<span class="br0">&#40;</span>create_button_overlay, <span class="st0">&quot;$g_presentation_obj_14&quot;</span>, <span class="st0">&quot;@Verify.&quot;</span><span class="br0">&#41;</span>, <span class="co1">##Duh - renamed</span>
        <span class="br0">&#40;</span>position_set_x, pos1, <span class="nu0">75</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_y, pos1, <span class="nu0">175</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>overlay_set_position, <span class="st0">&quot;$g_presentation_obj_14&quot;</span>, pos1<span class="br0">&#41;</span>,
&#160;
		<span class="br0">&#40;</span>create_button_overlay, <span class="st0">&quot;$g_presentation_obj_2&quot;</span>, <span class="st0">&quot;@Manage the crew.&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_x, pos1, <span class="nu0">75</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_y, pos1, <span class="nu0">365</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>overlay_set_position, <span class="st0">&quot;$g_presentation_obj_2&quot;</span>, pos1<span class="br0">&#41;</span>,
&#160;
		<span class="br0">&#40;</span>create_button_overlay, <span class="st0">&quot;$g_presentation_obj_15&quot;</span>, <span class="st0">&quot;@View the ship registry.&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_x, pos1, <span class="nu0">75</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_y, pos1, <span class="nu0">330</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>overlay_set_position, <span class="st0">&quot;$g_presentation_obj_15&quot;</span>, pos1<span class="br0">&#41;</span>,		
&#160;
&#160;
		<span class="br0">&#40;</span>create_game_button_overlay, <span class="st0">&quot;$g_presentation_obj_custom_battle_designer_19&quot;</span>, <span class="st0">&quot;@Done&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_x, pos1, <span class="nu0">880</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_y, pos1, <span class="nu0">25</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>overlay_set_position, <span class="st0">&quot;$g_presentation_obj_custom_battle_designer_19&quot;</span>, pos1<span class="br0">&#41;</span>,
        <span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
	<span class="br0">&#40;</span>ti_on_presentation_event_state_change,
      <span class="br0">&#91;</span>
        <span class="br0">&#40;</span>store_trigger_param_1, <span class="st0">&quot;:object&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>store_trigger_param_2, <span class="st0">&quot;:value&quot;</span><span class="br0">&#41;</span>,
&#160;
        <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>eq, <span class="st0">&quot;:object&quot;</span>, <span class="st0">&quot;$g_presentation_obj_11&quot;</span><span class="br0">&#41;</span>, <span class="co1">#Combo Box - Ship Select</span>
			<span class="br0">&#40;</span>assign, reg6, <span class="st0">&quot;:value&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>troop_get_slot, <span class="st0">&quot;:ship_no&quot;</span>, <span class="st0">&quot;trp_temp_array_a&quot;</span>, reg6<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>str_store_party_name, s13, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_num_companions, reg7, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>str_store_string, s12, <span class="st0">&quot;@This is your ship '{s13}'. The crew is currently made up of {reg7} men.^^&quot;</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>overlay_set_text, <span class="st0">&quot;$g_presentation_obj_name_kingdom_1&quot;</span>, s13<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>start_presentation, <span class="st0">&quot;prsnt_manage_ships&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>eq, <span class="st0">&quot;:object&quot;</span>, <span class="st0">&quot;$g_presentation_obj_name_kingdom_1&quot;</span><span class="br0">&#41;</span>, <span class="co1">#Text Box - Ship Name</span>
			<span class="br0">&#40;</span>str_store_string, s14, s0<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
		    <span class="br0">&#40;</span>eq, <span class="st0">&quot;:object&quot;</span>, <span class="st0">&quot;$g_presentation_obj_13&quot;</span><span class="br0">&#41;</span>, <span class="co1"># Rename Ship</span>
			<span class="br0">&#40;</span>neq, reg6, -<span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>troop_get_slot, <span class="st0">&quot;:ship_no&quot;</span>, <span class="st0">&quot;trp_temp_array_a&quot;</span>, reg6<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_name, <span class="st0">&quot;:ship_no&quot;</span>, s14<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>str_store_party_name, s13, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_num_companions, reg7, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>str_store_string, s12, <span class="st0">&quot;@This is your ship '{s13}'. The crew is currently made up of {reg7} men.^^&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>start_presentation, <span class="st0">&quot;prsnt_manage_ships&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>eq, <span class="st0">&quot;:object&quot;</span>, <span class="st0">&quot;$g_presentation_obj_2&quot;</span><span class="br0">&#41;</span>, <span class="co1">#Manage crew</span>
			<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:num_ships_current&quot;</span>, <span class="st0">&quot;$current_town&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>ge, <span class="st0">&quot;:num_ships_current&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,	
				<span class="br0">&#40;</span>troop_get_slot, <span class="st0">&quot;:ship_no&quot;</span>, <span class="st0">&quot;trp_temp_array_a&quot;</span>, reg6<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:loc_no&quot;</span>, <span class="st0">&quot;:ship_no&quot;</span>, slot_ship_center<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>eq, <span class="st0">&quot;:loc_no&quot;</span>, <span class="st0">&quot;$current_town&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>assign, <span class="st0">&quot;$ship&quot;</span>, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>assign, <span class="st0">&quot;$crew_screen_state&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>presentation_set_duration, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>display_message, <span class="st0">&quot;@Make sure you selected a ship&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>eq, <span class="st0">&quot;:object&quot;</span>, <span class="st0">&quot;$g_presentation_obj_15&quot;</span><span class="br0">&#41;</span>, <span class="co1">#Registry</span>
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;$crew_screen_state&quot;</span>, <span class="nu0">3</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>presentation_set_duration, <span class="nu0">0</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>eq, <span class="st0">&quot;:object&quot;</span>, <span class="st0">&quot;$g_presentation_obj_12&quot;</span><span class="br0">&#41;</span>, <span class="co1">#Combo Box - Port to Send</span>
			<span class="br0">&#40;</span>assign, reg8, <span class="st0">&quot;:value&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>eq, <span class="st0">&quot;:object&quot;</span>, <span class="st0">&quot;$g_presentation_obj_14&quot;</span><span class="br0">&#41;</span>, <span class="co1"># Send Ship</span>
			<span class="br0">&#40;</span>neq, reg6, -<span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>neq, reg8, -<span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>troop_get_slot, <span class="st0">&quot;:town_no&quot;</span>, <span class="st0">&quot;trp_temp_array_b&quot;</span>, reg8<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>troop_get_slot, <span class="st0">&quot;:ship_no&quot;</span>, <span class="st0">&quot;trp_temp_array_a&quot;</span>, reg6<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>party_get_num_companions, reg7, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
				<span class="co1">#(ge, reg7, 30),</span>
				<span class="co1">#(le, reg7, 90),</span>
				<span class="br0">&#40;</span>is_between, reg7, <span class="nu0">30</span>, <span class="nu0">91</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:num_ships_current&quot;</span>, <span class="st0">&quot;$current_town&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>ge, <span class="st0">&quot;:num_ships_current&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,												<span class="co1">#Making sure there is a ship to send</span>
				<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:num_ships_target&quot;</span>, <span class="st0">&quot;:town_no&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>lt, <span class="st0">&quot;:num_ships_target&quot;</span>, <span class="nu0">5</span><span class="br0">&#41;</span>,												<span class="co1">#Making sure the target town has space for another ship</span>
				<span class="br0">&#40;</span>val_add, <span class="st0">&quot;:num_ships_target&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,	
				<span class="br0">&#40;</span>val_sub, <span class="st0">&quot;:num_ships_current&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;$current_town&quot;</span>, slot_town_has_ship, <span class="st0">&quot;:num_ships_current&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:town_no&quot;</span>, slot_town_has_ship, <span class="st0">&quot;:num_ships_target&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:ship_no&quot;</span>, slot_ship_center, <span class="st0">&quot;:town_no&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>str_store_party_name, s15, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>str_store_party_name, s16, <span class="st0">&quot;:town_no&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>start_presentation, <span class="st0">&quot;prsnt_manage_ships&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>str_clear, s12<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>display_message, <span class="st0">&quot;@Your ship {s15} succesfully set sail for {s16}.&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>display_message, <span class="st0">&quot;@Make sure a ship is selected, it has a sufficient crew and there is room for another ship in the target town.&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,			
		<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
		    <span class="br0">&#40;</span>eq, <span class="st0">&quot;:object&quot;</span>, <span class="st0">&quot;$g_presentation_obj_custom_battle_designer_19&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>presentation_set_duration, <span class="nu0">0</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,       
&#160;
		<span class="br0">&#93;</span><span class="br0">&#41;</span>,
      <span class="br0">&#93;</span><span class="br0">&#41;</span>,</pre></div></div>
<p>That should provide you with the following things ingame:<br />
<img src="http://img192.imageshack.us/img192/6010/mb6hp.jpg" alt="mb6hp.jpg" />
<img src="http://img11.imageshack.us/img11/1295/mb22o.jpg" alt="mb22o.jpg" />
<img src="http://img232.imageshack.us/img232/4789/mb19.jpg" alt="mb19.jpg" /><br />
</p><p>But we want to do more - especially on the world map (this is still in game_menus):<br />
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1"> <span class="br0">&#40;</span>
    <span class="st0">&quot;disembark&quot;</span>,<span class="nu0">0</span>,
    <span class="st0">&quot;Do you wish to disembark?^^<span class="es0">\</span>
 Do not to land on cliffs, unless you wish to get stuck.&quot;</span>,
    <span class="st0">&quot;none&quot;</span>,
    <span class="br0">&#91;</span><span class="br0">&#93;</span>,
    <span class="br0">&#91;</span>
      <span class="br0">&#40;</span><span class="st0">&quot;disembark_yes&quot;</span>, 
	  <span class="br0">&#91;</span>    <span class="co1">#Pos0 is set as the disembark position by the engine</span>
			<span class="br0">&#40;</span>position_get_x, <span class="st0">&quot;:x&quot;</span>, pos0<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>position_get_y, <span class="st0">&quot;:y&quot;</span>, pos0<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>store_sub, <span class="st0">&quot;:min_x&quot;</span>, <span class="st0">&quot;:x&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>, <span class="co1">#Radius of 5 map units...not the radius units from before, I don't think</span>
			<span class="br0">&#40;</span>store_add, <span class="st0">&quot;:max_x&quot;</span>, <span class="st0">&quot;:x&quot;</span>, <span class="nu0">2</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>store_sub, <span class="st0">&quot;:min_y&quot;</span>, <span class="st0">&quot;:y&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>store_add, <span class="st0">&quot;:max_y&quot;</span>, <span class="st0">&quot;:y&quot;</span>, <span class="nu0">2</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;:no_cliffs&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>try_for_range, <span class="st0">&quot;:x&quot;</span>, <span class="st0">&quot;:min_x&quot;</span>, <span class="st0">&quot;:max_x&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>try_for_range, <span class="st0">&quot;:y&quot;</span>, <span class="st0">&quot;:min_y&quot;</span>, <span class="st0">&quot;:max_y&quot;</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>position_set_x, pos1, <span class="st0">&quot;:x&quot;</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>position_set_y, pos1, <span class="st0">&quot;:y&quot;</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>party_set_position, <span class="st0">&quot;p_temp_party&quot;</span>, pos1<span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>party_get_position, pos1, <span class="st0">&quot;p_temp_party&quot;</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>position_get_z, <span class="st0">&quot;:z&quot;</span>, pos1<span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>gt, <span class="st0">&quot;:z&quot;</span>, <span class="nu0">2</span><span class="br0">&#41;</span>, <span class="co1">#There be cliffs</span>
					<span class="br0">&#40;</span>assign, <span class="st0">&quot;:no_cliffs&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>assign, <span class="st0">&quot;:max_y&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>assign, <span class="st0">&quot;:max_x&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>, <span class="co1">#Ys</span>
			<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>, <span class="co1">#Xs</span>
			<span class="br0">&#40;</span>init_position, pos1<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_position, <span class="st0">&quot;p_temp_party&quot;</span>, pos1<span class="br0">&#41;</span>, <span class="co1">#Reset Temp Party Position</span>
			<span class="br0">&#40;</span>eq, <span class="st0">&quot;:no_cliffs&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,	  
	  <span class="br0">&#93;</span>, <span class="st0">&quot;Land the ship and leave it here for now.&quot;</span>,
       <span class="br0">&#91;</span>
		<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:ship_no&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
	    <span class="br0">&#40;</span>store_party_size, <span class="st0">&quot;:party_size&quot;</span>, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
&#160;
		<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>ge, <span class="st0">&quot;:party_size&quot;</span>, <span class="nu0">15</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_normal<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_flags, <span class="st0">&quot;p_main_party&quot;</span>, pf_is_ship, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_position, pos1, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_position, <span class="st0">&quot;p_main_party&quot;</span>, pos0<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_relocate_near_party, <span class="st0">&quot;:ship_no&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:ship_no&quot;</span>, slot_ship_center, ship_wild_guarded<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>enable_party, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_icon, <span class="st0">&quot;:ship_no&quot;</span>, <span class="st0">&quot;icon_ship_on_land&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>change_screen_return<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>lt, <span class="st0">&quot;:party_size&quot;</span>, <span class="nu0">15</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_normal<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_flags, <span class="st0">&quot;p_main_party&quot;</span>, pf_is_ship, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_position, pos1, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_position, <span class="st0">&quot;p_main_party&quot;</span>, pos0<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_relocate_near_party, <span class="st0">&quot;:ship_no&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:ship_no&quot;</span>, slot_ship_center, ship_wild_no_guard<span class="br0">&#41;</span>, <span class="co1">#Wilderness</span>
			<span class="br0">&#40;</span>store_current_hours, <span class="st0">&quot;:time&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>val_add, <span class="st0">&quot;:time&quot;</span>, <span class="nu0">96</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:ship_no&quot;</span>, slot_ship_time, <span class="st0">&quot;:time&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>enable_party, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_icon, <span class="st0">&quot;:ship_no&quot;</span>, <span class="st0">&quot;icon_ship_on_land&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>change_screen_return<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>display_message, <span class="st0">&quot;@You should leave 15 men behind to guard your ship, otherwise it might get stolen.&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party&quot;</span>, slot_town_has_ship, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
		<span class="br0">&#40;</span><span class="st0">&quot;disembark_yes_2&quot;</span>,
		<span class="br0">&#91;</span>
		<span class="br0">&#93;</span>,
		<span class="st0">&quot;Dock at the port.&quot;</span>,
&#160;
		<span class="br0">&#91;</span>	
			<span class="br0">&#40;</span>assign, reg1, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>try_for_range, <span class="st0">&quot;:town_no&quot;</span>, towns_begin, towns_end<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>party_slot_ge, <span class="st0">&quot;:town_no&quot;</span>, slot_town_is_coastal, <span class="nu0">1</span><span class="br0">&#41;</span>, 
				<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:radius&quot;</span>, <span class="st0">&quot;:town_no&quot;</span>, slot_town_is_coastal<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>store_distance_to_party_from_party, <span class="st0">&quot;:dist&quot;</span>, <span class="st0">&quot;:town_no&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>val_add, <span class="st0">&quot;:radius&quot;</span>, <span class="nu0">2</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>le, <span class="st0">&quot;:dist&quot;</span>, <span class="st0">&quot;:radius&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_normal<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>party_set_flags, <span class="st0">&quot;p_main_party&quot;</span>, pf_is_ship, <span class="nu0">0</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>party_relocate_near_party, <span class="st0">&quot;p_main_party&quot;</span>, <span class="st0">&quot;:town_no&quot;</span>, <span class="nu0">0.5</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:ship_no&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:ship_no&quot;</span>, slot_ship_center, <span class="st0">&quot;:town_no&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>disable_party, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:num_ships&quot;</span>, <span class="st0">&quot;:town_no&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>val_add, <span class="st0">&quot;:num_ships&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:town_no&quot;</span>, slot_town_has_ship, <span class="st0">&quot;:num_ships&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>assign, reg1, <span class="nu0">1</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>change_screen_return<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>eq, reg1, <span class="nu0">0</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>display_message, <span class="st0">&quot;@There is no port in the surrounding area.&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
		<span class="br0">&#93;</span><span class="br0">&#41;</span>,		
&#160;
&#160;
		<span class="br0">&#40;</span><span class="st0">&quot;manage_crew&quot;</span>, <span class="br0">&#91;</span><span class="br0">&#93;</span>, <span class="st0">&quot;Manage the crew.&quot;</span>,
       <span class="br0">&#91;</span><span class="co1"># (assign, &quot;:ship_to_use&quot;, -1),</span>
		<span class="co1"># (try_for_parties, &quot;:ship_no&quot;),</span>
			<span class="co1"># (party_slot_eq, &quot;:ship_no&quot;, slot_ship_center, 250),</span>
			<span class="co1"># (assign, &quot;:ship_to_use&quot;, &quot;:ship_no&quot;),</span>
		<span class="co1"># (try_end),</span>
		<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:ship_to_use&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
		<span class="co1"># (gt, &quot;:ship_to_use&quot;, -1),</span>
		<span class="co1">#(assign, reg6, &quot;:ship_to_use&quot;),</span>
		<span class="co1">#(display_message,&quot;@You now own a ship and can disembark from this town.&quot;),</span>
		<span class="br0">&#40;</span>set_encountered_party, <span class="st0">&quot;:ship_to_use&quot;</span><span class="br0">&#41;</span>,
		<span class="co1">#(change_screen_exchange_with_party, &quot;:ship_to_use&quot;),</span>
		<span class="co1">#(change_screen_give_members, &quot;:ship_to_use&quot;), </span>
		<span class="br0">&#40;</span>change_screen_exchange_members,<span class="nu0">0</span><span class="br0">&#41;</span>,	
        <span class="co1">#(party_clear, &quot;p_temp_party&quot;),</span>
        <span class="co1">#(call_script, &quot;script_party_copy&quot;, &quot;p_temp_party&quot;, &quot;:ship_to_use&quot;),		</span>
		<span class="co1">#(change_screen_exchange_with_party, &quot;p_temp_party&quot;),</span>
		<span class="co1">#(assign, &quot;$g_next_menu&quot;, &quot;mnu_disembark&quot;),</span>
		<span class="co1">#(jump_to_menu, &quot;mnu_manage_crew_done&quot;),</span>
		<span class="co1">#(call_script, &quot;script_party_add_party&quot;, &quot;:ship_to_use&quot;, &quot;p_temp_party&quot;),</span>
	   <span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
	<span class="co1">#### Old Code for disembarking</span>
       <span class="co1">#   (le, &quot;$g_main_ship_party&quot;, 0),</span>
       <span class="co1">#   (set_spawn_radius, 0),</span>
       <span class="co1">#   (spawn_around_party, &quot;p_main_party&quot;, &quot;pt_none&quot;),</span>
       <span class="co1">#   (assign, &quot;$g_main_ship_party&quot;, reg0),          </span>
       <span class="co1">#   (party_set_flags, &quot;$g_main_ship_party&quot;, pf_is_static|pf_always_visible|pf_hide_defenders|pf_is_ship, 1),</span>
       <span class="co1">#   (str_store_troop_name, s1, &quot;trp_player&quot;),</span>
       <span class="co1">#   (party_set_name, &quot;$g_main_ship_party&quot;, &quot;@{s1}'s Ship&quot;),</span>
       <span class="co1">#   (party_set_icon, &quot;$g_main_ship_party&quot;, &quot;icon_ship&quot;),</span>
       <span class="co1">#   (party_set_slot, &quot;$g_main_ship_party&quot;, slot_party_type, spt_ship),</span>
       <span class="co1"># (try_end),</span>
       <span class="co1"># (enable_party, &quot;$g_main_ship_party&quot;),</span>
       <span class="co1"># (party_set_position, &quot;$g_main_ship_party&quot;, pos0),</span>
       <span class="co1"># (party_set_icon, &quot;$g_main_ship_party&quot;, &quot;icon_ship_on_land&quot;),</span>
       <span class="co1"># (assign, &quot;$g_main_ship_party&quot;, -1),		</span>
&#160;
		<span class="br0">&#40;</span><span class="st0">&quot;disembark_yes_3&quot;</span>,
		<span class="br0">&#91;</span>	
			    <span class="co1">#Pos0 is set as the disembark position by the engine</span>
			<span class="br0">&#40;</span>position_get_x, <span class="st0">&quot;:x&quot;</span>, pos0<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>position_get_y, <span class="st0">&quot;:y&quot;</span>, pos0<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>store_sub, <span class="st0">&quot;:min_x&quot;</span>, <span class="st0">&quot;:x&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>, <span class="co1">#Radius of 5 map units...not the radius units from before, I don't think</span>
			<span class="br0">&#40;</span>store_add, <span class="st0">&quot;:max_x&quot;</span>, <span class="st0">&quot;:x&quot;</span>, <span class="nu0">2</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>store_sub, <span class="st0">&quot;:min_y&quot;</span>, <span class="st0">&quot;:y&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>store_add, <span class="st0">&quot;:max_y&quot;</span>, <span class="st0">&quot;:y&quot;</span>, <span class="nu0">2</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;:no_cliffs&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>try_for_range, <span class="st0">&quot;:x&quot;</span>, <span class="st0">&quot;:min_x&quot;</span>, <span class="st0">&quot;:max_x&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>try_for_range, <span class="st0">&quot;:y&quot;</span>, <span class="st0">&quot;:min_y&quot;</span>, <span class="st0">&quot;:max_y&quot;</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>position_set_x, pos1, <span class="st0">&quot;:x&quot;</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>position_set_y, pos1, <span class="st0">&quot;:y&quot;</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>party_set_position, <span class="st0">&quot;p_temp_party&quot;</span>, pos1<span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>party_get_position, pos1, <span class="st0">&quot;p_temp_party&quot;</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>position_get_z, <span class="st0">&quot;:z&quot;</span>, pos1<span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>gt, <span class="st0">&quot;:z&quot;</span>, <span class="nu0">2</span><span class="br0">&#41;</span>, <span class="co1">#There be cliffs</span>
					<span class="br0">&#40;</span>assign, <span class="st0">&quot;:no_cliffs&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>assign, <span class="st0">&quot;:max_y&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>assign, <span class="st0">&quot;:max_x&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>, <span class="co1">#Ys</span>
			<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>, <span class="co1">#Xs</span>
			<span class="br0">&#40;</span>init_position, pos1<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_position, <span class="st0">&quot;p_temp_party&quot;</span>, pos1<span class="br0">&#41;</span>, <span class="co1">#Reset Temp Party Position</span>
			<span class="br0">&#40;</span>eq, <span class="st0">&quot;:no_cliffs&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
&#160;
			<span class="co1">#(party_get_position, pos1, &quot;p_main_party&quot;),</span>
			<span class="co1">#(map_get_land_position_around_position, pos2, pos1, 1),</span>
			<span class="co1">#(party_set_position, &quot;p_main_party&quot;, pos2),</span>
			<span class="co1">#(party_get_current_terrain, &quot;:terrain&quot;, &quot;p_main_party&quot;),</span>
			<span class="co1">#(neq, &quot;:terrain&quot;, 1),</span>
			<span class="co1">#(assign, reg20, &quot;:terrain&quot;),</span>
			<span class="co1">#(display_message, &quot;@Terrain is {reg20}&quot;),</span>
			<span class="co1">#(party_set_position, &quot;p_main_party&quot;, pos1),</span>
		<span class="br0">&#93;</span>,
		<span class="st0">&quot;Yes, but send the ship to a port.&quot;</span>,
&#160;
		<span class="br0">&#91;</span>	
		    <span class="co1"># (try_for_parties, &quot;:ship_no&quot;),</span>
				<span class="co1"># (party_slot_eq, &quot;:ship_no&quot;, slot_ship_center, 250),</span>
				<span class="co1"># (store_party_size, &quot;:party_size&quot;, &quot;:ship_no&quot;),</span>
			<span class="co1"># (try_end),</span>
			<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
			    <span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:ship_no&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>store_party_size, <span class="st0">&quot;:party_size&quot;</span>, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>ge, <span class="st0">&quot;:party_size&quot;</span>, <span class="nu0">30</span><span class="br0">&#41;</span>,		
				<span class="br0">&#40;</span>jump_to_menu, <span class="st0">&quot;mnu_send_ship_to_town&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>display_message, <span class="st0">&quot;@You need at least a 30 men crew to send the ship to a town&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
		<span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
&#160;
	<span class="br0">&#40;</span><span class="st0">&quot;disembark_no&quot;</span>, <span class="br0">&#91;</span><span class="br0">&#93;</span>, <span class="st0">&quot;No.&quot;</span>,
       <span class="br0">&#91;</span>	<span class="br0">&#40;</span>party_get_position, pos1, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,	
			<span class="br0">&#40;</span>map_get_water_position_around_position, pos2, pos1, <span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_position, <span class="st0">&quot;p_main_party&quot;</span>, pos2<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>rest_for_hours_interactive, <span class="nu0">1</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>change_screen_return<span class="br0">&#41;</span>,
        <span class="br0">&#93;</span><span class="br0">&#41;</span>,
    <span class="br0">&#93;</span>
  <span class="br0">&#41;</span>,
&#160;
  <span class="co1"># (&quot;manage_crew_done&quot;,0,</span>
  <span class="co1">#  &quot;{!}&quot;,</span>
  <span class="co1">#  &quot;none&quot;,</span>
  <span class="co1">#  [],</span>
  <span class="co1">#  [(&quot;continue&quot;, [], &quot;Continue.&quot;, [</span>
  <span class="co1">#      (assign, &quot;:ship_to_use&quot;, -1),</span>
	<span class="co1">#	(try_for_parties, &quot;:ship_no&quot;),</span>
	<span class="co1">#		(party_slot_eq, &quot;:ship_no&quot;, slot_ship_center, 250),</span>
	<span class="co1">#		(assign, &quot;:ship_to_use&quot;, &quot;:ship_no&quot;),</span>
	<span class="co1">#	(try_end),</span>
	<span class="co1">#	(gt, &quot;:ship_to_use&quot;, -1),	</span>
	<span class="co1">#	(party_clear, &quot;:ship_to_use&quot;),</span>
    <span class="co1">#    (call_script, &quot;script_party_copy&quot;, &quot;:ship_to_use&quot;, &quot;p_temp_party&quot;),	</span>
	<span class="co1">#	(jump_to_menu, &quot;$g_next_menu&quot;)]),</span>
	<span class="co1">#]),</span>
&#160;
    <span class="co1">#Floris Send ship to town</span>
&#160;
 <span class="br0">&#40;</span>
	<span class="st0">&quot;Send_ship_to_town&quot;</span>,<span class="nu0">0</span>,
    <span class="st0">&quot;Send the ship to&quot;</span>,
    <span class="st0">&quot;none&quot;</span>,
	<span class="br0">&#91;</span>	
	<span class="br0">&#93;</span>,
	<span class="br0">&#91;</span>
		<span class="br0">&#40;</span><span class="st0">&quot;p_town_1&quot;</span>,
		<span class="br0">&#91;</span>
			<span class="br0">&#40;</span>store_faction_of_party, <span class="st0">&quot;:faction_1&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>store_faction_of_party, <span class="st0">&quot;:faction_2&quot;</span>, <span class="st0">&quot;p_town_1&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>store_relation, <span class="st0">&quot;:relation&quot;</span>, <span class="st0">&quot;:faction_1&quot;</span>, <span class="st0">&quot;:faction_2&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>ge, <span class="st0">&quot;:relation&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>str_store_party_name, s1, <span class="st0">&quot;p_town_1&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#93;</span>,
		<span class="st0">&quot;{s1}&quot;</span>,
		<span class="br0">&#91;</span>
		<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:num_ships&quot;</span>, <span class="st0">&quot;p_town_1&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>val_add, <span class="st0">&quot;:num_ships&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_town_1&quot;</span>, slot_town_has_ship, <span class="st0">&quot;:num_ships&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_normal<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>party_set_flags, <span class="st0">&quot;p_main_party&quot;</span>, pf_is_ship, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>party_get_position, pos1, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>party_set_position, <span class="st0">&quot;p_main_party&quot;</span>, pos0<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:ship_no&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:ship_no&quot;</span>, slot_ship_center, <span class="st0">&quot;p_town_1&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party&quot;</span>, slot_town_has_ship, <span class="nu0">0</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>disable_party, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
		<span class="co1"># (try_for_parties, &quot;:ship_no&quot;),</span>
			<span class="co1"># (party_slot_eq, &quot;:ship_no&quot;, slot_ship_center, 250),</span>
			<span class="co1"># (party_set_slot, &quot;:ship_no&quot;, slot_ship_center, &quot;p_town_1&quot;),</span>
			<span class="co1"># (disable_party, &quot;:ship_no&quot;),</span>
		<span class="co1"># (try_end),</span>
        <span class="br0">&#40;</span>change_screen_return<span class="br0">&#41;</span>,
		<span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
		<span class="br0">&#40;</span><span class="st0">&quot;p_town_2&quot;</span>,
		<span class="br0">&#91;</span>
			<span class="br0">&#40;</span>store_faction_of_party, <span class="st0">&quot;:faction_1&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>store_faction_of_party, <span class="st0">&quot;:faction_2&quot;</span>, <span class="st0">&quot;p_town_2&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>store_relation, <span class="st0">&quot;:relation&quot;</span>, <span class="st0">&quot;:faction_1&quot;</span>, <span class="st0">&quot;:faction_2&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>ge, <span class="st0">&quot;:relation&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>str_store_party_name, s1, <span class="st0">&quot;p_town_2&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#93;</span>,
		<span class="st0">&quot;{s1}&quot;</span>,
		<span class="br0">&#91;</span>
		<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:num_ships&quot;</span>, <span class="st0">&quot;p_town_2&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>val_add, <span class="st0">&quot;:num_ships&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_town_2&quot;</span>, slot_town_has_ship, <span class="st0">&quot;:num_ships&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_normal<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>party_set_flags, <span class="st0">&quot;p_main_party&quot;</span>, pf_is_ship, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>party_get_position, pos1, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>party_set_position, <span class="st0">&quot;p_main_party&quot;</span>, pos0<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:ship_no&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:ship_no&quot;</span>, slot_ship_center, <span class="st0">&quot;p_town_2&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party&quot;</span>, slot_town_has_ship, <span class="nu0">0</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>disable_party, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
		<span class="co1"># (try_for_parties, &quot;:ship_no&quot;),</span>
			<span class="co1"># (party_slot_eq, &quot;:ship_no&quot;, slot_ship_center, 250),</span>
			<span class="co1"># (party_set_slot, &quot;:ship_no&quot;, slot_ship_center, &quot;p_town_2&quot;),</span>
			<span class="co1"># (disable_party, &quot;:ship_no&quot;),</span>
		<span class="co1"># (try_end),</span>
        <span class="br0">&#40;</span>change_screen_return<span class="br0">&#41;</span>,
		<span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
		<span class="br0">&#40;</span><span class="st0">&quot;p_town_6&quot;</span>,
		<span class="br0">&#91;</span>
			<span class="br0">&#40;</span>store_faction_of_party, <span class="st0">&quot;:faction_1&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>store_faction_of_party, <span class="st0">&quot;:faction_2&quot;</span>, <span class="st0">&quot;p_town_6&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>store_relation, <span class="st0">&quot;:relation&quot;</span>, <span class="st0">&quot;:faction_1&quot;</span>, <span class="st0">&quot;:faction_2&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>ge, <span class="st0">&quot;:relation&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>str_store_party_name, s1, <span class="st0">&quot;p_town_6&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#93;</span>,
		<span class="st0">&quot;{s1}&quot;</span>,
		<span class="br0">&#91;</span>
		<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:num_ships&quot;</span>, <span class="st0">&quot;p_town_6&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>val_add, <span class="st0">&quot;:num_ships&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_town_6&quot;</span>, slot_town_has_ship, <span class="st0">&quot;:num_ships&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_normal<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>party_set_flags, <span class="st0">&quot;p_main_party&quot;</span>, pf_is_ship, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>party_get_position, pos1, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>party_set_position, <span class="st0">&quot;p_main_party&quot;</span>, pos0<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:ship_no&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:ship_no&quot;</span>, slot_ship_center, <span class="st0">&quot;p_town_6&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party&quot;</span>, slot_town_has_ship, <span class="nu0">0</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>disable_party, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
		<span class="co1"># (try_for_parties, &quot;:ship_no&quot;),</span>
			<span class="co1"># (party_slot_eq, &quot;:ship_no&quot;, slot_ship_center, 250),</span>
			<span class="co1"># (party_set_slot, &quot;:ship_no&quot;, slot_ship_center, &quot;p_town_6&quot;),</span>
			<span class="co1"># (disable_party, &quot;:ship_no&quot;),</span>
		<span class="co1"># (try_end),</span>
		<span class="br0">&#40;</span>change_screen_return<span class="br0">&#41;</span>,
		<span class="br0">&#93;</span><span class="br0">&#41;</span>,		
&#160;
		<span class="br0">&#40;</span><span class="st0">&quot;p_town_12&quot;</span>,
		<span class="br0">&#91;</span>
			<span class="br0">&#40;</span>store_faction_of_party, <span class="st0">&quot;:faction_1&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>store_faction_of_party, <span class="st0">&quot;:faction_2&quot;</span>, <span class="st0">&quot;p_town_12&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>store_relation, <span class="st0">&quot;:relation&quot;</span>, <span class="st0">&quot;:faction_1&quot;</span>, <span class="st0">&quot;:faction_2&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>ge, <span class="st0">&quot;:relation&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>str_store_party_name, s1, <span class="st0">&quot;p_town_12&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#93;</span>,
		<span class="st0">&quot;{s1}&quot;</span>,
		<span class="br0">&#91;</span>
		<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:num_ships&quot;</span>, <span class="st0">&quot;p_town_12&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>val_add, <span class="st0">&quot;:num_ships&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_town_12&quot;</span>, slot_town_has_ship, <span class="st0">&quot;:num_ships&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_normal<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>party_set_flags, <span class="st0">&quot;p_main_party&quot;</span>, pf_is_ship, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>party_get_position, pos1, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>party_set_position, <span class="st0">&quot;p_main_party&quot;</span>, pos0<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:ship_no&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:ship_no&quot;</span>, slot_ship_center, <span class="st0">&quot;p_town_12&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party&quot;</span>, slot_town_has_ship, <span class="nu0">0</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>disable_party, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
		<span class="co1"># (try_for_parties, &quot;:ship_no&quot;),</span>
			<span class="co1"># (party_slot_eq, &quot;:ship_no&quot;, slot_ship_center, 250),</span>
			<span class="co1"># (party_set_slot, &quot;:ship_no&quot;, slot_ship_center, &quot;p_town_12&quot;),</span>
			<span class="co1"># (disable_party, &quot;:ship_no&quot;),</span>
		<span class="co1"># (try_end),</span>
		<span class="br0">&#40;</span>change_screen_return<span class="br0">&#41;</span>,
		<span class="br0">&#93;</span><span class="br0">&#41;</span>,				
&#160;
		<span class="br0">&#40;</span><span class="st0">&quot;p_town_13&quot;</span>,
		<span class="br0">&#91;</span>
			<span class="br0">&#40;</span>store_faction_of_party, <span class="st0">&quot;:faction_1&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>store_faction_of_party, <span class="st0">&quot;:faction_2&quot;</span>, <span class="st0">&quot;p_town_13&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>store_relation, <span class="st0">&quot;:relation&quot;</span>, <span class="st0">&quot;:faction_1&quot;</span>, <span class="st0">&quot;:faction_2&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>ge, <span class="st0">&quot;:relation&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>str_store_party_name, s1, <span class="st0">&quot;p_town_13&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#93;</span>,
		<span class="st0">&quot;{s1}&quot;</span>,
		<span class="br0">&#91;</span>
		<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:num_ships&quot;</span>, <span class="st0">&quot;p_town_13&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>val_add, <span class="st0">&quot;:num_ships&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_town_13&quot;</span>, slot_town_has_ship, <span class="st0">&quot;:num_ships&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_normal<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>party_set_flags, <span class="st0">&quot;p_main_party&quot;</span>, pf_is_ship, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>party_get_position, pos1, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>party_set_position, <span class="st0">&quot;p_main_party&quot;</span>, pos0<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:ship_no&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:ship_no&quot;</span>, slot_ship_center, <span class="st0">&quot;p_town_13&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party&quot;</span>, slot_town_has_ship, <span class="nu0">0</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>disable_party, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
		<span class="co1"># (try_for_parties, &quot;:ship_no&quot;),</span>
			<span class="co1"># (party_slot_eq, &quot;:ship_no&quot;, slot_ship_center, 250),</span>
			<span class="co1"># (party_set_slot, &quot;:ship_no&quot;, slot_ship_center, &quot;p_town_13&quot;),</span>
			<span class="co1"># (disable_party, &quot;:ship_no&quot;),</span>
		<span class="co1"># (try_end),</span>
		<span class="br0">&#40;</span>change_screen_return<span class="br0">&#41;</span>,
		<span class="br0">&#93;</span><span class="br0">&#41;</span>,		
&#160;
		<span class="br0">&#40;</span><span class="st0">&quot;p_town_15&quot;</span>,
		<span class="br0">&#91;</span>
			<span class="br0">&#40;</span>store_faction_of_party, <span class="st0">&quot;:faction_1&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>store_faction_of_party, <span class="st0">&quot;:faction_2&quot;</span>, <span class="st0">&quot;p_town_15&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>store_relation, <span class="st0">&quot;:relation&quot;</span>, <span class="st0">&quot;:faction_1&quot;</span>, <span class="st0">&quot;:faction_2&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>ge, <span class="st0">&quot;:relation&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>str_store_party_name, s1, <span class="st0">&quot;p_town_15&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#93;</span>,
		<span class="st0">&quot;{s1}&quot;</span>,
		<span class="br0">&#91;</span>
		<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:num_ships&quot;</span>, <span class="st0">&quot;p_town_15&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>val_add, <span class="st0">&quot;:num_ships&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_town_15&quot;</span>, slot_town_has_ship, <span class="st0">&quot;:num_ships&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_normal<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>party_set_flags, <span class="st0">&quot;p_main_party&quot;</span>, pf_is_ship, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>party_get_position, pos1, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>party_set_position, <span class="st0">&quot;p_main_party&quot;</span>, pos0<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:ship_no&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:ship_no&quot;</span>, slot_ship_center, <span class="st0">&quot;p_town_15&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party&quot;</span>, slot_town_has_ship, <span class="nu0">0</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>disable_party, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
		<span class="co1"># (try_for_parties, &quot;:ship_no&quot;),</span>
			<span class="co1"># (party_slot_eq, &quot;:ship_no&quot;, slot_ship_center, 250),</span>
			<span class="co1"># (party_set_slot, &quot;:ship_no&quot;, slot_ship_center, &quot;p_town_15&quot;),</span>
			<span class="co1"># (disable_party, &quot;:ship_no&quot;),</span>
		<span class="co1"># (try_end),</span>
		<span class="br0">&#40;</span>change_screen_return<span class="br0">&#41;</span>,
		<span class="br0">&#93;</span><span class="br0">&#41;</span>,		
&#160;
		<span class="br0">&#40;</span><span class="st0">&quot;p_town_19&quot;</span>,
		<span class="br0">&#91;</span>
			<span class="br0">&#40;</span>store_faction_of_party, <span class="st0">&quot;:faction_1&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>store_faction_of_party, <span class="st0">&quot;:faction_2&quot;</span>, <span class="st0">&quot;p_town_19&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>store_relation, <span class="st0">&quot;:relation&quot;</span>, <span class="st0">&quot;:faction_1&quot;</span>, <span class="st0">&quot;:faction_2&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>ge, <span class="st0">&quot;:relation&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>str_store_party_name, s1, <span class="st0">&quot;p_town_19&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#93;</span>,
		<span class="st0">&quot;{s1}&quot;</span>,
		<span class="br0">&#91;</span>
		<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:num_ships&quot;</span>, <span class="st0">&quot;p_town_19&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>val_add, <span class="st0">&quot;:num_ships&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_town_19&quot;</span>, slot_town_has_ship, <span class="st0">&quot;:num_ships&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_normal<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>party_set_flags, <span class="st0">&quot;p_main_party&quot;</span>, pf_is_ship, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>party_get_position, pos1, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>party_set_position, <span class="st0">&quot;p_main_party&quot;</span>, pos0<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:ship_no&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span>, slot_town_has_ship<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;:ship_no&quot;</span>, slot_ship_center, <span class="st0">&quot;p_town_19&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party&quot;</span>, slot_town_has_ship, <span class="nu0">0</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>disable_party, <span class="st0">&quot;:ship_no&quot;</span><span class="br0">&#41;</span>,
		<span class="co1"># (try_for_parties, &quot;:ship_no&quot;),</span>
			<span class="co1"># (party_slot_eq, &quot;:ship_no&quot;, slot_ship_center, 250),</span>
			<span class="co1"># (party_set_slot, &quot;:ship_no&quot;, slot_ship_center, &quot;p_town_19&quot;),</span>
			<span class="co1"># (disable_party, &quot;:ship_no&quot;),</span>
		<span class="co1"># (try_end),</span>
		<span class="br0">&#40;</span>change_screen_return<span class="br0">&#41;</span>,
		<span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
		<span class="br0">&#40;</span><span class="st0">&quot;abort&quot;</span>,
		<span class="br0">&#91;</span><span class="br0">&#93;</span>,
		<span class="st0">&quot;Return to the ship&quot;</span>,
		<span class="br0">&#91;</span><span class="br0">&#40;</span>change_screen_return<span class="br0">&#41;</span>,
        <span class="br0">&#93;</span><span class="br0">&#41;</span>,
	<span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
&#160;
  <span class="br0">&#40;</span>
    <span class="st0">&quot;ship_reembark&quot;</span>,<span class="nu0">0</span>,
    <span class="st0">&quot;Do you wish to embark?&quot;</span>,
    <span class="st0">&quot;none&quot;</span>,
    <span class="br0">&#91;</span><span class="br0">&#93;</span>,
    <span class="br0">&#91;</span>
      <span class="br0">&#40;</span><span class="st0">&quot;reembark_yes&quot;</span>, <span class="br0">&#91;</span><span class="br0">&#93;</span>, <span class="st0">&quot;Yes.(Min crew 30, Max 90)&quot;</span>,
       <span class="br0">&#91;</span><span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_num_companions, reg6, <span class="st0">&quot;$g_encountered_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_num_companions, reg7, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>val_add, reg7, reg6<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>is_between, reg7, <span class="nu0">30</span>, <span class="nu0">91</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_ship<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_flags, <span class="st0">&quot;p_main_party&quot;</span>, pf_is_ship, <span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_position, pos1, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>map_get_water_position_around_position, pos2, pos1, <span class="nu0">7</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_position, <span class="st0">&quot;p_main_party&quot;</span>, pos2<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;$g_encountered_party&quot;</span>, slot_ship_center, ship_player_sailing<span class="br0">&#41;</span>, <span class="co1">#Player uses ship</span>
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party&quot;</span>, slot_town_has_ship, <span class="st0">&quot;$g_encountered_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>disable_party, <span class="st0">&quot;$g_encountered_party&quot;</span><span class="br0">&#41;</span>,			
			<span class="br0">&#40;</span>change_screen_return<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>display_message,<span class="st0">&quot;@Your crew exceeds the boundaries.&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,		
        <span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
		<span class="br0">&#40;</span><span class="st0">&quot;manage_crew&quot;</span>, <span class="br0">&#91;</span><span class="br0">&#93;</span>, <span class="st0">&quot;Manage the crew.&quot;</span>,
       <span class="br0">&#91;</span>	<span class="br0">&#40;</span>change_screen_exchange_members,<span class="nu0">0</span><span class="br0">&#41;</span>,	
	   <span class="br0">&#93;</span><span class="br0">&#41;</span>,
&#160;
&#160;
      <span class="br0">&#40;</span><span class="st0">&quot;reembark_no&quot;</span>, <span class="br0">&#91;</span><span class="br0">&#93;</span>, <span class="st0">&quot;No.&quot;</span>,
       <span class="br0">&#91;</span><span class="br0">&#40;</span>change_screen_return<span class="br0">&#41;</span>,
        <span class="br0">&#93;</span><span class="br0">&#41;</span>,
    <span class="br0">&#93;</span>
  <span class="br0">&#41;</span>,
<span class="co1">#Floris End</span></pre></div></div>
<p>This requires an addition to simple_triggers.py:
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1">	<span class="br0">&#40;</span><span class="nu0">24</span>, <span class="co1">#Floris Seafaring Wilderness Check</span>
	<span class="br0">&#91;</span>
		<span class="br0">&#40;</span>try_for_parties, <span class="st0">&quot;:party_no&quot;</span><span class="br0">&#41;</span>,
		    <span class="br0">&#40;</span>party_slot_eq, <span class="st0">&quot;:party_no&quot;</span>, slot_party_type, spt_ship<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_slot_eq, <span class="st0">&quot;:party_no&quot;</span>, slot_ship_center, ship_wild_no_guard<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:timer&quot;</span>, <span class="st0">&quot;:party_no&quot;</span>, slot_ship_time<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>store_current_hours, <span class="st0">&quot;:cur_time&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>ge, <span class="st0">&quot;:cur_time&quot;</span>, <span class="st0">&quot;:timer&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>store_random_in_range, <span class="st0">&quot;:luck&quot;</span>, <span class="nu0">0</span>, <span class="nu0">10</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>ge, <span class="st0">&quot;:luck&quot;</span>, <span class="nu0">5</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>str_store_party_name, s1, <span class="st0">&quot;:party_no&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>display_message, <span class="st0">&quot;@You have a bad feeling about your ship {s1}.&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>remove_party, <span class="st0">&quot;:party_no&quot;</span><span class="br0">&#41;</span>,			
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
		<span class="br0">&#93;</span><span class="br0">&#41;</span>,</pre></div></div>
<p>It removes your ship (i.e. steals), if you did not assign the necessary amount of troops to guard it.<br />
</p><p>Another Screenshot:<br />
</p><p><img src="http://img823.imageshack.us/img823/7285/mb21q.jpg" alt="mb21q.jpg" /><br />
The options to "land" and "send the ship to a town" will not show up if the player tries to do it at a steep cliff (based on the height difference of the positions), because otherwise the player might get stuck there and break his game. Its still possible to do, but this was the closest we could get to fixing this.<br />
</p><p>Troops need to be paid wages so we better include all the crews the player assigns to his ships (beware this fuses into the diplomacy presentation):
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1">      <span class="co1">##diplomacy begin</span>
      <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>this_or_next|gt, <span class="st0">&quot;$g_player_minister&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>this_or_next|troop_slot_ge, <span class="st0">&quot;trp_player&quot;</span>, slot_troop_spouse, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>this_or_next|gt, <span class="st0">&quot;$g_player_chamberlain&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>gt, <span class="st0">&quot;$g_player_constable&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>val_add, <span class="st0">&quot;:num_lines&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>, <span class="co1"># staff salary</span>
      <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
&#160;
      <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>gt, <span class="st0">&quot;$g_player_chamberlain&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>val_add, <span class="st0">&quot;:num_lines&quot;</span>, <span class="nu0">2</span><span class="br0">&#41;</span>, <span class="co1">#earlier cash, new cash</span>
      <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
      <span class="co1">##diplomacy end   </span>
	  <span class="co1">#FLORIS BEGIN</span>
      <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>faction_slot_eq, <span class="st0">&quot;fac_player_supporters_faction&quot;</span>, slot_faction_state, sfs_active<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>faction_slot_eq, <span class="st0">&quot;fac_player_supporters_faction&quot;</span>, slot_faction_leader, <span class="st0">&quot;trp_player&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>val_add, <span class="st0">&quot;:num_lines&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
      <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_for_parties, <span class="st0">&quot;:party_no&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_slot_ge,<span class="st0">&quot;:party_no&quot;</span>, slot_ship_center, <span class="nu0">1</span><span class="br0">&#41;</span>, <span class="co1">#Ships are identified by 4 states, towns/player/wilderness/wilderness w/o guard</span>
			<span class="br0">&#40;</span>assign, reg20, <span class="nu0">2</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>eq, reg20,<span class="nu0">2</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>val_add, <span class="st0">&quot;:num_lines&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
      <span class="co1">#FLORIS END  </span>
      <span class="br0">&#40;</span>val_add, <span class="st0">&quot;:num_lines&quot;</span>, <span class="nu0">3</span><span class="br0">&#41;</span>,
      <span class="br0">&#40;</span>store_mul, <span class="st0">&quot;:cur_y&quot;</span>, <span class="nu0">27</span>, <span class="st0">&quot;:num_lines&quot;</span><span class="br0">&#41;</span>,
      <span class="br0">&#40;</span>assign, <span class="st0">&quot;:net_change&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>, <span class="co1">#this is the amount added</span>
      <span class="br0">&#40;</span>try_for_range, <span class="st0">&quot;:center_no&quot;</span>, centers_begin, centers_end<span class="br0">&#41;</span>,		
		<span class="co1">#Enterprise</span></pre></div></div><br />
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1">          <span class="br0">&#40;</span>str_store_string, s0, <span class="st0">&quot;str_s0s_party&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,				
        <span class="br0">&#40;</span>create_text_overlay, reg1, <span class="st0">&quot;str_wages_for_s0&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_x, pos1, <span class="nu0">900</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_y, pos1, <span class="nu0">900</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>overlay_set_size, reg1, pos1<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_x, pos1, <span class="nu0">25</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_y, pos1, <span class="st0">&quot;:cur_y&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>overlay_set_position, reg1, pos1<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>lt, <span class="st0">&quot;:total_wage&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>assign, reg0, <span class="st0">&quot;:total_wage&quot;</span><span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>create_text_overlay, reg1, <span class="st0">&quot;@{!}{reg0}&quot;</span>, tf_right_align|tf_single_line<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>overlay_set_color, reg1, 0xFF0000<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
          <span class="br0">&#40;</span>create_text_overlay, reg1, <span class="st0">&quot;@None&quot;</span>, tf_right_align|tf_single_line<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_x, pos1, <span class="nu0">900</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_y, pos1, <span class="nu0">900</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>overlay_set_size, reg1, pos1<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_x, pos1, <span class="nu0">500</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>position_set_y, pos1, <span class="st0">&quot;:cur_y&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>overlay_set_position, reg1, pos1<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>val_sub, <span class="st0">&quot;:cur_y&quot;</span>, <span class="nu0">27</span><span class="br0">&#41;</span>,
      <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
&#160;
	  <span class="co1">#Floris Addendum / Crew Wages / Seafaring</span>
		<span class="br0">&#40;</span>assign, <span class="st0">&quot;:crew_wage&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,	
		<span class="br0">&#40;</span>assign, reg20, <span class="nu0">0</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_for_parties, <span class="st0">&quot;:party_no&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_slot_ge,<span class="st0">&quot;:party_no&quot;</span>, slot_ship_center, <span class="nu0">1</span><span class="br0">&#41;</span>, <span class="co1">#Ships are identified by 4 states, towns/player/wilderness/wilderness w/o guard</span>
			<span class="br0">&#40;</span>party_get_num_companion_stacks, <span class="st0">&quot;:num_stacks&quot;</span>, <span class="st0">&quot;:party_no&quot;</span><span class="br0">&#41;</span>, <span class="co1">#Calculating Wages</span>
			<span class="br0">&#40;</span>try_for_range, <span class="st0">&quot;:i_stack&quot;</span>, <span class="nu0">0</span>, <span class="st0">&quot;:num_stacks&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>party_stack_get_troop_id, <span class="st0">&quot;:stack_troop&quot;</span>, <span class="st0">&quot;:party_no&quot;</span>, <span class="st0">&quot;:i_stack&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>party_stack_get_size, <span class="st0">&quot;:stack_size&quot;</span>, <span class="st0">&quot;:party_no&quot;</span>, <span class="st0">&quot;:i_stack&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>call_script, <span class="st0">&quot;script_game_get_troop_wage&quot;</span>, <span class="st0">&quot;:stack_troop&quot;</span>, <span class="st0">&quot;:party_no&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>assign, <span class="st0">&quot;:cur_wage&quot;</span>, reg0<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>val_mul, <span class="st0">&quot;:cur_wage&quot;</span>, <span class="st0">&quot;:stack_size&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>val_mul, <span class="st0">&quot;:cur_wage&quot;</span>, -<span class="nu0">1</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>val_add, <span class="st0">&quot;:crew_wage&quot;</span>, <span class="st0">&quot;:cur_wage&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>assign, reg20, <span class="nu0">1</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>eq, reg20, <span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>assign, reg0, <span class="st0">&quot;:crew_wage&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>val_add, <span class="st0">&quot;:net_change&quot;</span>, <span class="st0">&quot;:crew_wage&quot;</span><span class="br0">&#41;</span>,			
			<span class="br0">&#40;</span>create_text_overlay, reg1, <span class="st0">&quot;@Wages for your Shipcrew/s:&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>position_set_x, pos1, <span class="nu0">900</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>position_set_y, pos1, <span class="nu0">900</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>overlay_set_size, reg1, pos1<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>position_set_x, pos1, <span class="nu0">25</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>position_set_y, pos1, <span class="st0">&quot;:cur_y&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>overlay_set_position, reg1, pos1<span class="br0">&#41;</span>,
&#160;
			<span class="br0">&#40;</span>create_text_overlay, reg1, <span class="st0">&quot;@{!}{reg0}&quot;</span>, tf_right_align|tf_single_line<span class="br0">&#41;</span>, <span class="co1">#Display Wages</span>
			<span class="br0">&#40;</span>overlay_set_color, reg1, 0xFF0000<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>position_set_x, pos1, <span class="nu0">900</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>position_set_y, pos1, <span class="nu0">900</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>overlay_set_size, reg1, pos1<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>position_set_x, pos1, <span class="nu0">500</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>position_set_y, pos1, <span class="st0">&quot;:cur_y&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>overlay_set_position, reg1, pos1<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>val_sub, <span class="st0">&quot;:cur_y&quot;</span>, <span class="nu0">27</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
&#160;
	<span class="co1">#Floris End</span>
&#160;
&#160;
&#160;
      <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>gt, <span class="st0">&quot;$g_player_debt_to_party_members&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>val_sub, <span class="st0">&quot;:net_change&quot;</span>, <span class="st0">&quot;$g_player_debt_to_party_members&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#40;</span>create_text_overlay, reg1, <span class="st0">&quot;str_earlier_debts&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,</pre></div></div><br />
<p><br />
</p><p>To finish off - a few minor menu fixes and additions (be aware this is based on FEMP, you might not have the same code, but you will need to alter "Resume Travelling" and "Wait here for some time"):
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1">     <span class="br0">&#40;</span><span class="st0">&quot;camp_wait_here&quot;</span>,<span class="br0">&#91;</span><span class="br0">&#93;</span>,<span class="st0">&quot;Wait here for some time.&quot;</span>,
       <span class="br0">&#91;</span>
           <span class="br0">&#40;</span>assign,<span class="st0">&quot;$g_camp_mode&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_infinite_camping&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
           <span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_camping<span class="br0">&#41;</span>,
<span class="co1">#		   (party_set_slot,&quot;p_main_party&quot;,slot_party_entrenched,0), #TEMPERED ADDED LINE FOR NO ENTRENCHMENT</span>
<span class="co1">#		   (assign,&quot;$current_camp_party&quot;,-1), #TEMPERED ADDED LINE FOR NO ENTRENCHMENT</span>
&#160;
           <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>party_is_active, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>party_get_current_terrain, <span class="st0">&quot;:cur_terrain&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
               <span class="br0">&#40;</span>eq, <span class="st0">&quot;:cur_terrain&quot;</span>, rt_desert<span class="br0">&#41;</span>,
               <span class="br0">&#40;</span>unlock_achievement, ACHIEVEMENT_SARRANIDIAN_NIGHTS<span class="br0">&#41;</span>,		<span class="co1">#Floris Seafaring Addendum</span>
			 <span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>eq, <span class="st0">&quot;:cur_terrain&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>, <span class="co1">#Sea</span>
				<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_ship<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>party_set_flags, <span class="st0">&quot;p_main_party&quot;</span>, pf_is_ship, <span class="nu0">1</span><span class="br0">&#41;</span>,
             <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,  
           <span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,  
           <span class="br0">&#40;</span>rest_for_hours_interactive, <span class="nu0">24</span> <span class="sy0">*</span> <span class="nu0">365</span>, <span class="nu0">5</span>, <span class="nu0">1</span><span class="br0">&#41;</span>, <span class="co1">#rest while attackable                     </span>
            <span class="br0">&#40;</span>change_screen_map<span class="br0">&#41;</span>,
        <span class="br0">&#93;</span>
       <span class="br0">&#41;</span>,
&#160;
	   <span class="br0">&#40;</span><span class="st0">&quot;camp_fishing&quot;</span>, <span class="co1">#Floris Fishing</span>
	   <span class="br0">&#91;</span>	<span class="br0">&#40;</span>party_get_current_terrain, <span class="st0">&quot;:terrain&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>eq, <span class="st0">&quot;:terrain&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
	   <span class="br0">&#93;</span>,
	   <span class="st0">&quot;Try to catch some fish.&quot;</span>,
	   <span class="br0">&#91;</span>
			<span class="br0">&#40;</span>store_current_hours, <span class="st0">&quot;:time&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>val_add, <span class="st0">&quot;:time&quot;</span>, <span class="nu0">24</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party&quot;</span>, slot_ship_time, <span class="st0">&quot;:time&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>assign,<span class="st0">&quot;$g_camp_mode&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_infinite_camping&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>rest_for_hours_interactive, <span class="nu0">24</span> <span class="sy0">*</span> <span class="nu0">365</span>, <span class="nu0">5</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_ship<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>change_screen_map<span class="br0">&#41;</span>,
		<span class="br0">&#93;</span><span class="br0">&#41;</span>,	
&#160;
&#160;
<span class="co1">#Tempered inspect camp</span>
      <span class="br0">&#40;</span><span class="st0">&quot;camp_inspect&quot;</span>,
	  <span class="br0">&#91;</span>	<span class="br0">&#40;</span>party_get_current_terrain, <span class="st0">&quot;:terrain&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>neq, <span class="st0">&quot;:terrain&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
	  <span class="br0">&#93;</span>,<span class="st0">&quot;Inspect your camp.&quot;</span>,
       <span class="br0">&#91;</span>
			<span class="br0">&#40;</span>call_script,<span class="st0">&quot;script_visit_camp&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#93;</span>
       <span class="br0">&#41;</span>,	   
<span class="co1">#TEMPERED  CHANGES BEGIN  ADDED ENTRENCHMENT MENU OPTION                                	   </span>
      <span class="br0">&#40;</span><span class="st0">&quot;camp_entrench&quot;</span>,<span class="br0">&#91;</span> 	<span class="br0">&#40;</span>party_get_current_terrain, <span class="st0">&quot;:terrain&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
							<span class="br0">&#40;</span>neq, <span class="st0">&quot;:terrain&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
							<span class="br0">&#40;</span>party_slot_eq,<span class="st0">&quot;p_main_party&quot;</span>,slot_party_entrenched,<span class="nu0">0</span><span class="br0">&#41;</span>,
							<span class="br0">&#40;</span>assign,<span class="st0">&quot;:continue&quot;</span>,<span class="nu0">0</span><span class="br0">&#41;</span>,
							<span class="br0">&#40;</span>try_for_parties,<span class="st0">&quot;:camp_site&quot;</span><span class="br0">&#41;</span>,
								<span class="br0">&#40;</span>eq,<span class="st0">&quot;:continue&quot;</span>,<span class="nu0">0</span><span class="br0">&#41;</span>,
								<span class="br0">&#40;</span>party_slot_eq,<span class="st0">&quot;:camp_site&quot;</span>,slot_party_type,spt_entrenchment<span class="br0">&#41;</span>,
								<span class="br0">&#40;</span>store_distance_to_party_from_party, <span class="st0">&quot;:distance&quot;</span>, <span class="st0">&quot;:camp_site&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
								<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
									<span class="br0">&#40;</span>le,<span class="st0">&quot;:distance&quot;</span>,<span class="nu0">1</span><span class="br0">&#41;</span>,
									<span class="br0">&#40;</span>str_store_string,s1,<span class="st0">&quot;@Return to your fortifications.&quot;</span><span class="br0">&#41;</span>,
									<span class="br0">&#40;</span>assign,<span class="st0">&quot;:continue&quot;</span>,<span class="nu0">1</span><span class="br0">&#41;</span>,
									<span class="br0">&#40;</span>assign,<span class="st0">&quot;$current_camp_party&quot;</span>,<span class="st0">&quot;:camp_site&quot;</span><span class="br0">&#41;</span>,
								<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
							<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,		
							<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
								<span class="br0">&#40;</span>eq,<span class="st0">&quot;:continue&quot;</span>,<span class="nu0">0</span><span class="br0">&#41;</span>,
								<span class="br0">&#40;</span>call_script,<span class="st0">&quot;script_party_entrench_time&quot;</span><span class="br0">&#41;</span>,
								<span class="br0">&#40;</span>str_store_string,s1,<span class="st0">&quot;@Spend {reg5} hours entrenching your camp site.&quot;</span><span class="br0">&#41;</span>,
								<span class="br0">&#40;</span>assign,<span class="st0">&quot;$current_camp_party&quot;</span>,-<span class="nu0">1</span><span class="br0">&#41;</span>,
							<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,													
						<span class="br0">&#93;</span>,<span class="st0">&quot;{s1}&quot;</span>,
       <span class="br0">&#91;</span>	
			<span class="br0">&#40;</span>assign,<span class="st0">&quot;:continue&quot;</span>,<span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>store_current_hours,<span class="st0">&quot;:cur_hour&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>player_has_item,<span class="st0">&quot;itm_tools&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>assign,<span class="st0">&quot;:continue&quot;</span>,<span class="nu0">1</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>eq,<span class="st0">&quot;:continue&quot;</span>,<span class="nu0">1</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>lt,<span class="st0">&quot;$current_camp_party&quot;</span>,<span class="nu0">0</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>call_script,<span class="st0">&quot;script_party_entrench_time&quot;</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>store_add,<span class="st0">&quot;$entrench_time&quot;</span>,<span class="st0">&quot;:cur_hour&quot;</span>,reg5<span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>call_script,<span class="st0">&quot;script_change_player_party_morale&quot;</span>,-<span class="nu0">10</span><span class="br0">&#41;</span>,					
					<span class="br0">&#40;</span>party_set_slot,<span class="st0">&quot;p_main_party&quot;</span>,slot_party_entrenched,-<span class="nu0">1</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>assign,<span class="st0">&quot;$g_camp_mode&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_infinite_camping&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_camping<span class="br0">&#41;</span>,												
					<span class="br0">&#40;</span>rest_for_hours_interactive, <span class="nu0">24</span> <span class="sy0">*</span> <span class="nu0">7</span>, <span class="nu0">5</span>, <span class="nu0">1</span><span class="br0">&#41;</span>, <span class="co1">#rest while attackable</span>
					<span class="br0">&#40;</span>change_screen_return<span class="br0">&#41;</span>,					
				<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>gt,<span class="st0">&quot;$current_camp_party&quot;</span>,<span class="nu0">0</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>party_set_slot,<span class="st0">&quot;p_main_party&quot;</span>,slot_party_entrenched,<span class="nu0">1</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>display_message,<span class="st0">&quot;@_You have returned to a fortified position.&quot;</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>party_set_slot,<span class="st0">&quot;$current_camp_party&quot;</span>,slot_village_state,<span class="nu0">1</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>party_clear_particle_systems, <span class="st0">&quot;$current_camp_party&quot;</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>assign,<span class="st0">&quot;$entrench_time&quot;</span>,<span class="nu0">0</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>assign,<span class="st0">&quot;$g_camp_mode&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_infinite_camping&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_camping<span class="br0">&#41;</span>,												
					<span class="br0">&#40;</span>jump_to_menu,<span class="st0">&quot;mnu_camp&quot;</span><span class="br0">&#41;</span>,					
				<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>eq,<span class="st0">&quot;:continue&quot;</span>,<span class="nu0">0</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>display_message,<span class="st0">&quot;@_You must have tools in inventory to entrench your camp site.&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>jump_to_menu,<span class="st0">&quot;mnu_camp&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
        <span class="br0">&#93;</span>
       <span class="br0">&#41;</span>,
&#160;
<span class="co1">#	   (&quot;game_options&quot;,[],&quot;Adjust mod settings.&quot;,</span>
<span class="co1">#       [</span>
<span class="co1">#			(jump_to_menu,&quot;mnu_options&quot;),</span>
<span class="co1">#        ]</span>
<span class="co1">#       ),</span>
<span class="co1">#TEMPERED  CHANGES END</span>
&#160;
      <span class="br0">&#40;</span><span class="st0">&quot;camp_cheat&quot;</span>,
       <span class="br0">&#91;</span><span class="br0">&#40;</span>ge, <span class="st0">&quot;$cheat_mode&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>
        <span class="br0">&#93;</span>, <span class="st0">&quot;CHEAT MENU!&quot;</span>,
       <span class="br0">&#91;</span><span class="br0">&#40;</span>jump_to_menu, <span class="st0">&quot;mnu_camp_cheat&quot;</span><span class="br0">&#41;</span>,
        <span class="br0">&#93;</span>,
       <span class="br0">&#41;</span>,
      <span class="br0">&#40;</span><span class="st0">&quot;resume_travelling&quot;</span>,<span class="br0">&#91;</span><span class="br0">&#93;</span>,<span class="st0">&quot;Resume travelling.&quot;</span>,
       <span class="br0">&#91;</span>
			<span class="br0">&#40;</span>party_get_current_terrain, <span class="st0">&quot;:terrain&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>, <span class="co1">#Floris Addendum / Seafaring</span>
			<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>neq, <span class="st0">&quot;:terrain&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_normal<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>assign,<span class="st0">&quot;$g_camp_mode&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_ship<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>assign,<span class="st0">&quot;$g_camp_mode&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>change_screen_map<span class="br0">&#41;</span>,
        <span class="br0">&#93;</span>
       <span class="br0">&#41;</span>,
      <span class="br0">&#93;</span>
  <span class="br0">&#41;</span>,</pre></div></div>
<p>For the fishing option (which is based on the foraging skill) we need to go back into simple_triggers and add:
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="python source-python"><pre class="de1">	<span class="br0">&#40;</span><span class="nu0">1</span>, <span class="co1">#Floris fishing</span>
	<span class="br0">&#91;</span>	
		<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_current_terrain, <span class="st0">&quot;:terrain&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>eq, <span class="st0">&quot;:terrain&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>neq, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_ship<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>assign, <span class="st0">&quot;$g_player_icon_state&quot;</span>, pis_ship<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
&#160;
		<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>party_get_slot, <span class="st0">&quot;:timer&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span>, slot_ship_time<span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>store_current_hours, <span class="st0">&quot;:cur_time&quot;</span><span class="br0">&#41;</span>,			
			<span class="br0">&#40;</span>eq, <span class="st0">&quot;:cur_time&quot;</span>, <span class="st0">&quot;:timer&quot;</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>party_get_current_terrain, <span class="st0">&quot;:terrain&quot;</span>, <span class="st0">&quot;p_main_party&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>eq, <span class="st0">&quot;:terrain&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>store_skill_level, <span class="st0">&quot;:skill&quot;</span>, skl_foraging,<span class="st0">&quot;trp_player&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>val_mul, <span class="st0">&quot;:skill&quot;</span>, <span class="nu0">10</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>store_random_in_range, <span class="st0">&quot;:luck&quot;</span>, <span class="nu0">0</span>, <span class="nu0">100</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>ge, <span class="st0">&quot;:skill&quot;</span>, <span class="st0">&quot;:luck&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>store_free_inventory_capacity, <span class="st0">&quot;:i_space&quot;</span>, <span class="st0">&quot;trp_player&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>try_begin<span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>ge, <span class="st0">&quot;:i_space&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>display_message, <span class="st0">&quot;@You caught some fish.&quot;</span><span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>troop_add_item, <span class="st0">&quot;trp_player&quot;</span>, <span class="st0">&quot;itm_smoked_fish&quot;</span><span class="br0">&#41;</span>,
					<span class="co1">#(troop_add_merchandise, &quot;trp_player&quot;, &quot;itm_smoked_fish&quot;, 1),</span>
				<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
					<span class="br0">&#40;</span>display_message, <span class="st0">&quot;@Due to insufficient space, you had to throw the fish back into the ocean&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,				
				<span class="br0">&#40;</span>assign,<span class="st0">&quot;$g_camp_mode&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>rest_for_hours_interactive, <span class="nu0">0</span>, <span class="nu0">5</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party&quot;</span>, slot_ship_time, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>else_try<span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>display_message, <span class="st0">&quot;@All you caught were some seaweeds.&quot;</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>assign,<span class="st0">&quot;$g_camp_mode&quot;</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>rest_for_hours_interactive, <span class="nu0">0</span>, <span class="nu0">5</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,
				<span class="br0">&#40;</span>party_set_slot, <span class="st0">&quot;p_main_party&quot;</span>, slot_ship_time, <span class="nu0">0</span><span class="br0">&#41;</span>,
			<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
		<span class="br0">&#40;</span>try_end<span class="br0">&#41;</span>,
	<span class="br0">&#93;</span><span class="br0">&#41;</span>,</pre></div></div>
<p>...and we are done. Good job reading through all this&#160;;)<br />
<br />
<br />
<b><big>Plans for the future:</big></b>
</p>
<ul><li> Fix what is left to fix (for example the loot)
</li><li> Add Royal Traders into the merchant dialog so that Players attacking them get a relationship penalty with the faction (or create a similar dialog for them)
</li><li> Add cargo to ships (the basic code is already done thanks to caba'drins current project
</li><li> Ability to send ships on trade routes
</li><li> Either making your ships really sail the sea when you <b>send</b> them somewhere or introduce random (unpleasant) events to counter imba.
</li></ul>
<p><br />
</p><p><br />
<b>Credits for Seafaring:</b>
</p>
<ul><li> Cmp - helped us debug a major problem with assigning crews, Cheers
</li><li> Caba - streamlined all my code
</li><li> Duh - Writing a ton of the code, Concept
</li></ul>

<!-- 
NewPP limit report
Preprocessor node count: 150/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key benelux_mb_mod_wiki-wiki_:pcache:idhash:112-0!*!0!!en!* and timestamp 20200419222242 -->
<div class="printfooter">
Retrieved from "<a href="Seafaring">http://mbmodwiki.ollclan.eu/Seafaring</a>"</div>
				<!-- /bodytext -->
								<!-- catlinks -->
				<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks"><a href="Special%3ACategories.html" title="Special:Categories">Category</a>: <span dir='ltr'><a href="Category%3AScript" title="Category:Script">Script</a></span></div></div>				<!-- /catlinks -->
												<div class="visualClear"></div>
			</div>
			<!-- /bodyContent -->
		</div>
		<!-- /content -->
		<!-- header -->
		<div id="mw-head" class="noprint">
			
<!-- 0 -->
<div id="p-personal" class="">
	<h5>Personal tools</h5>
	<ul>
					<li  id="pt-anonuserpage"><a href="http://mbmodwiki.ollclan.eu/User:127.0.0.1" title="The user page for the IP address you are editing as [.]" accesskey="." class="new">127.0.0.1</a></li>
					<li  id="pt-anontalk"><a href="http://mbmodwiki.ollclan.eu/User_talk:127.0.0.1" title="Discussion about edits from this IP address [n]" accesskey="n" class="new">Talk for this IP address</a></li>
					<li  id="pt-anonlogin"><a href="index.php@title=Special%3AUserLogin&amp;returnto=Seafaring" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in / create account</a></li>
			</ul>
</div>

<!-- /0 -->
			<div id="left-navigation">
				
<!-- 0 -->
<div id="p-namespaces" class="vectorTabs">
	<h5>Namespaces</h5>
	<ul>
					<li  id="ca-nstab-main" class="selected"><span><a href="Seafaring"  title="View the content page [c]" accesskey="c">Page</a></span></li>
					<li  id="ca-talk" class="new"><span><a href="index.php@title=Talk%3ASeafaring&amp;action=edit&amp;redlink=1"  title="Discussion about the content page [t]" accesskey="t">Discussion</a></span></li>
			</ul>
</div>

<!-- /0 -->

<!-- 1 -->
<div id="p-variants" class="vectorMenu emptyPortlet">
		<h5><span>Variants</span><a href="Seafaring.html#"></a></h5>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>

<!-- /1 -->
			</div>
			<div id="right-navigation">
				
<!-- 0 -->
<div id="p-views" class="vectorTabs">
	<h5>Views</h5>
	<ul>
					<li id="ca-view" class="selected"><span><a href="Seafaring" >Read</a></span></li>
					<li id="ca-edit"><span><a href="index.php@title=Seafaring&amp;action=edit"  title="You can edit this page. Please use the preview button before saving [e]" accesskey="e">Edit</a></span></li>
					<li id="ca-history" class="collapsible "><span><a href="index.php@title=Seafaring&amp;action=history"  title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>
			</ul>
</div>

<!-- /0 -->

<!-- 1 -->
<div id="p-cactions" class="vectorMenu emptyPortlet">
	<h5><span>Actions</span><a href="Seafaring.html#"></a></h5>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>

<!-- /1 -->

<!-- 2 -->
<div id="p-search">
	<h5><label for="searchInput">Search</label></h5>
	<form action="http://mbmodwiki.ollclan.eu/index.php" id="searchform">
		<input type='hidden' name="title" value="Special:Search"/>
				<div id="simpleSearch">
						<input id="searchInput" name="search" type="text"  title="Search Mount&amp;Blade Modding Wiki [f]" accesskey="f"  value="" />
						<button id="searchButton" type='submit' name='button'  title="Search the pages for this text"><img src="https://mbmodwiki.github.io/skins/vector/images/search-ltr.png?301" alt="Search" /></button>
					</div>
			</form>
</div>

<!-- /2 -->
			</div>
		</div>
		<!-- /header -->
		<!-- panel -->
			<div id="mw-panel" class="noprint">
				<!-- logo -->
					<div id="p-logo"><a style="background-image: url(images/logo-jfinal-3_production.png);" href="Main_Page"  title="Visit the main page"></a></div>
				<!-- /logo -->
				
<!-- navigation -->
<div class="portal" id='p-navigation'>
	<h5>Navigation</h5>
	<div class="body">
				<ul>
					<li id="n-The-Forge"><a href="http://forums.taleworlds.com/index.php/board,64.0">The Forge</a></li>
					<li id="n-mainpage-description"><a href="Main_Page" title="Visit the main page [z]" accesskey="z">Main page</a></li>
					<li id="n-The-Basics"><a href="Category%3AModding_Concepts">The Basics</a></li>
					<li id="n-Begin-to-Mod"><a href="Official_Module_System_Documentation%3A_Part_1">Begin to Mod</a></li>
					<li id="n-recentchanges"><a href="Special%3ARecentChanges" title="The list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
					<li id="n-randompage"><a href="Classical_Italian/Roman_Items" title="Load a random page [x]" accesskey="x">Random page</a></li>
					<li id="n-help"><a href="Help%3AContents" title="The place to find out">Help</a></li>
				</ul>
			</div>
</div>

<!-- /navigation -->

<!-- SEARCH -->

<!-- /SEARCH -->

<!-- TOOLBOX -->
<div class="portal" id="p-tb">
	<h5>Toolbox</h5>
	<div class="body">
		<ul>
					<li id="t-whatlinkshere"><a href="Special%3AWhatLinksHere/Seafaring" title="List of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
						<li id="t-recentchangeslinked"><a href="Special%3ARecentChangesLinked/Seafaring" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
																																										<li id="t-specialpages"><a href="Special%3ASpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
									<li id="t-print"><a href="index.php@title=Seafaring&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
						<li id="t-permalink"><a href="index.php@title=Seafaring&amp;oldid=635" title="Permanent link to this revision of the page">Permanent link</a></li>
						</ul>
	</div>
</div>

<!-- /TOOLBOX -->

<!-- LANGUAGES -->

<!-- /LANGUAGES -->
			</div>
		<!-- /panel -->
		<!-- footer -->
		<div id="footer">
											<ul id="footer-info">
																	<li id="footer-info-lastmod"> This page was last modified on 9 January 2012, at 20:14.</li>
																							<li id="footer-info-viewcount">This page has been accessed 15 times.</li>
																							<li id="footer-info-copyright">Content is available under <a href="http://creativecommons.org/licenses/publicdomain/" class="external ">Public Domain</a>.</li>
															</ul>
															<ul id="footer-places">
																	<li id="footer-places-privacy"><a href="ModdingWiki%3APrivacy_policy" title="ModdingWiki:Privacy policy">Privacy policy</a></li>
																							<li id="footer-places-about"><a href="ModdingWiki%3AAbout" title="ModdingWiki:About">About Mount&amp;Blade Modding Wiki</a></li>
																							<li id="footer-places-disclaimer"><a href="ModdingWiki%3AGeneral_disclaimer" title="ModdingWiki:General disclaimer">Disclaimers</a></li>
															</ul>
											<ul id="footer-icons" class="noprint">
					<li id="footer-copyrightico">
						<a href="http://creativecommons.org/licenses/publicdomain/"><img src="images/public-domain.png" alt="Public Domain" width="88" height="31" /></a>
					</li>
					<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="https://mbmodwiki.github.io/skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
					</li>
				</ul>
						<div style="clear:both"></div>
		</div>
		<!-- /footer -->
		
<script src="load.php@debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;%252A"></script>
<script>if ( window.mediaWiki ) {
	mediaWiki.config.set({"wgCanonicalNamespace": "", "wgCanonicalSpecialPageName": false, "wgNamespaceNumber": 0, "wgPageName": "Seafaring", "wgTitle": "Seafaring", "wgAction": "view", "wgArticleId": 112, "wgIsArticle": true, "wgUserName": null, "wgUserGroups": ["*"], "wgCurRevisionId": 635, "wgCategories": ["Script"], "wgBreakFrames": false, "wgRestrictionEdit": [], "wgRestrictionMove": [], "wgWikiEditorEnabledModules": {"toolbar": false, "dialogs": true, "templateEditor": false, "templates": false, "addMediaWizard": false, "preview": false, "previewDialog": false, "publish": false, "toc": false}, "wgVectorEnabledModules": {"collapsiblenav": true, "collapsibletabs": true, "editwarning": false, "expandablesearch": true, "footercleanup": false, "simplesearch": true}});
}
</script>
<script>if ( window.mediaWiki ) {
	mediaWiki.loader.load(["mediawiki.util", "mediawiki.legacy.wikibits", "mediawiki.legacy.ajax", "ext.vector.collapsibleNav", "ext.vector.collapsibleTabs", "ext.vector.expandableSearch", "ext.vector.simpleSearch"]);
	mediaWiki.loader.go();
}
</script>

<script src="load.php@debug=false&amp;lang=en&amp;modules=site&amp;only=scripts&amp;skin=vector&amp;%252A"></script>
<script>if ( window.mediaWiki ) {
	mediaWiki.user.options.set({"ccmeonemails":0,"cols":80,"contextchars":50,"contextlines":5,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"highlightbroken":1,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":1,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"vector","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":0,
	"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"usebetatoolbar-cgd":1,"vector-simplesearch":1,"vector-collapsiblenav":1,"vector-collapsibletabs":1,"vector-editwarning":1,"vector-expandablesearch":1,"vector-footercleanup":1,"variant":"en","language":"en","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false});;mediaWiki.loader.state({"user.options":"ready"});
}
</script>		<!-- fixalpha -->
		<script type="text/javascript"> if ( window.isMSIE55 ) fixalpha(); </script>
		<!-- /fixalpha -->
		<!-- Served in 0.156 secs. -->			</body>
</html>
